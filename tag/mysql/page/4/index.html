<!DOCTYPE html>
<!-- HTML 5 --><html lang="en-US">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<link rel="pingback" href="/xmlrpc.php">
	
	<title>MySQL | Andrew Morgan on Databases | Page 4</title>

<meta name="robots" content="max-image-preview:large">
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="alternate" type="application/rss+xml" title="Andrew Morgan on Databases &raquo; Feed" href="/feed">
<link rel="alternate" type="application/rss+xml" title="Andrew Morgan on Databases &raquo; Comments Feed" href="/comments/feed">
<link rel="alternate" type="application/rss+xml" title="Andrew Morgan on Databases &raquo; MySQL Tag Feed" href="/tag/mysql/feed">
		<!-- This site uses the Google Analytics by MonsterInsights plugin v9.2.2 - Using Analytics tracking - https://www.monsterinsights.com/ -->
		<!-- Note: MonsterInsights is not currently configured on this site. The site owner needs to authenticate with Google Analytics in the MonsterInsights settings panel. -->
					<!-- No tracking code set -->
				<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
/*  */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.clusterdb.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=81fb77f64976ac32efe42aab69fdb5e4"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"üè≥Ô∏è‚Äç‚ößÔ∏è","üè≥Ô∏è‚Äã‚ößÔ∏è")?!1:!n(e,"üá∫üá≥","üá∫‚Äãüá≥")&&!n(e,"üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø","üè¥‚ÄãÛ†Åß‚ÄãÛ†Å¢‚ÄãÛ†Å•‚ÄãÛ†ÅÆ‚ÄãÛ†Åß‚ÄãÛ†Åø");case"emoji":return!n(e,"üê¶‚Äç‚¨õ","üê¶‚Äã‚¨õ")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/*  */
</script>
<style id="wp-emoji-styles-inline-css" type="text/css">img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}</style>
<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=81fb77f64976ac32efe42aab69fdb5e4" type="text/css" media="all">
<style id="classic-theme-styles-inline-css" type="text/css">/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}</style>
<style id="global-styles-inline-css" type="text/css">:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}</style>
<link rel="stylesheet" id="plyr-css-css" href="/wp-content/plugins/easy-video-player/lib/plyr.css?ver=81fb77f64976ac32efe42aab69fdb5e4" type="text/css" media="all">
<link rel="stylesheet" id="zeeSynergie_stylesheet-css" href="/wp-content/themes/zeesynergie/style.css?ver=81fb77f64976ac32efe42aab69fdb5e4" type="text/css" media="all">
<link rel="stylesheet" id="zeeSynergie_colorscheme-css" href="/wp-content/themes/zeesynergie/includes/css/colorschemes/blue.css?ver=81fb77f64976ac32efe42aab69fdb5e4" type="text/css" media="all">
<link rel="stylesheet" id="themezee_default_font-css" href="http://fonts.googleapis.com/css?family=Paytone+One&#038;ver=81fb77f64976ac32efe42aab69fdb5e4" type="text/css" media="all">
<script type="text/javascript" src="/wp-content/plugins/easy-video-player/lib/plyr.min.js?ver=81fb77f64976ac32efe42aab69fdb5e4" id="plyr-js-js"></script>
<script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" src="/wp-content/themes/zeesynergie/includes/js/jquery.cycle.all.min.js?ver=81fb77f64976ac32efe42aab69fdb5e4" id="zee_jquery-cycle-js"></script>
<link rel="https://api.w.org/" href="/wp-json/"><link rel="alternate" title="JSON" type="application/json" href="/wp-json/wp/v2/tags/147"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">

<style data-context="foundation-flickity-css">/*! Flickity v2.0.2
http://flickity.metafizzy.co
---------------------------------------------- */.flickity-enabled{position:relative}.flickity-enabled:focus{outline:0}.flickity-viewport{overflow:hidden;position:relative;height:100%}.flickity-slider{position:absolute;width:100%;height:100%}.flickity-enabled.is-draggable{-webkit-tap-highlight-color:transparent;tap-highlight-color:transparent;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.flickity-enabled.is-draggable .flickity-viewport{cursor:move;cursor:-webkit-grab;cursor:grab}.flickity-enabled.is-draggable .flickity-viewport.is-pointer-down{cursor:-webkit-grabbing;cursor:grabbing}.flickity-prev-next-button{position:absolute;top:50%;width:44px;height:44px;border:none;border-radius:50%;background:#fff;background:hsla(0,0%,100%,.75);cursor:pointer;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.flickity-prev-next-button:hover{background:#fff}.flickity-prev-next-button:focus{outline:0;box-shadow:0 0 0 5px #09f}.flickity-prev-next-button:active{opacity:.6}.flickity-prev-next-button.previous{left:10px}.flickity-prev-next-button.next{right:10px}.flickity-rtl .flickity-prev-next-button.previous{left:auto;right:10px}.flickity-rtl .flickity-prev-next-button.next{right:auto;left:10px}.flickity-prev-next-button:disabled{opacity:.3;cursor:auto}.flickity-prev-next-button svg{position:absolute;left:20%;top:20%;width:60%;height:60%}.flickity-prev-next-button .arrow{fill:#333}.flickity-page-dots{position:absolute;width:100%;bottom:-25px;padding:0;margin:0;list-style:none;text-align:center;line-height:1}.flickity-rtl .flickity-page-dots{direction:rtl}.flickity-page-dots .dot{display:inline-block;width:10px;height:10px;margin:0 8px;background:#333;border-radius:50%;opacity:.25;cursor:pointer}.flickity-page-dots .dot.is-selected{opacity:1}</style><style data-context="foundation-slideout-css">.slideout-menu{position:fixed;left:0;top:0;bottom:0;right:auto;z-index:0;width:256px;overflow-y:auto;-webkit-overflow-scrolling:touch;display:none}.slideout-menu.pushit-right{left:auto;right:0}.slideout-panel{position:relative;z-index:1;will-change:transform}.slideout-open,.slideout-open .slideout-panel,.slideout-open body{overflow:hidden}.slideout-open .slideout-menu{display:block}.pushit{display:none}</style><script type="text/javascript">//
					jQuery(document).ready(function($) {
						$('#nav ul').css({display: 'none'}); // Opera Fix
						$('#nav li').hover(function(){
							$(this).find('ul:first').css({visibility: 'visible',display: 'none'}).show().css({opacity:0}).animate({opacity:1},400);
						},function(){
							$(this).find('ul:first').css({visibility: 'hidden'});
						});
					});
				//</script><style type="text/css"></style><style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><style type="text/css" id="custom-background-css">body.custom-background { background-color: #89a5bf; }</style>
	<style>.ios7.web-app-mode.has-fixed header{ background-color: rgba(3,122,221,.88);}</style></head>

<body class="archive paged tag tag-mysql tag-147 custom-background paged-4 tag-paged-4">
<div id="wrapper">

	<div id="header">

		<div id="head">
			<div id="logo">
									<a href="/"><h1>Andrew Morgan on Databases</h1></a>
                                        <!-- <a href="/"><h1>MySQL Cluster, Replication, Fabric...</h1></a>  ZXZX -->					
							</div>
			<div id="socialmedia_icons">
				<a href="http://twitter.com/andrewmorgan"><img src="/wp-content/themes/zeesynergie/images/icons/twitter.png" alt="twitter"></a><a href="http://www.facebook.com/andrewjamesmorgan"><img src="/wp-content/themes/zeesynergie/images/icons/facebook.png" alt="facebook"></a><a href="https://plus.google.com/u/0/100605473697871424413/posts"><img src="/wp-content/themes/zeesynergie/images/icons/googleplus.png" alt="googleplus"></a><a href="http://www.linkedin.com/profile/view?id=16709956"><img src="/wp-content/themes/zeesynergie/images/icons/linkedin.png" alt="linkedin"></a><a href="http://www.flickr.com/photos/andrewjamesmorgan/"><img src="/wp-content/themes/zeesynergie/images/icons/flickr.png" alt="flickr"></a><a href="http://www.youtube.com/channel/UCodtDakJ4VdeSCzS3P3rIsw"><img src="/wp-content/themes/zeesynergie/images/icons/youtube.png" alt="youtube"></a>				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		
		<div id="navi_container">
			<div id="navi">
				<ul id="nav" class="menu"><li class="page_item page-item-1011"><a href="/about">About</a></li>
</ul>			</div>
		</div>
		<div class="clear"></div>
	</div>
	
	<div id="container">
	
			<div id="custom_header">
			<img src="/wp-content/uploads/2015/06/cropped-ClusterDB-logo-header.png">
		</div>
	
	<div id="wrap">
		<div id="content">
		
		<h2 class="arh">Tag Archive for MySQL</h2>
				
					<div id="post-3837" class="post-3837 post type-post status-publish format-standard hentry category-mysql-fabric tag-fabric tag-ha tag-high-availability tag-mysql tag-mysql-fabric-2 tag-sharding">
				
				<div class="postmeta">	<div class="postmeta_links">
		<a href="/author/andrew" title="Posts by andrew" rel="author">andrew</a> |
		<a href="/mysql-fabric/mysql-fabric-adding-high-availability-and-scaling-to-mysql">May 27, 2014</a>
			</div>
	<div class="postcomments">
		<a href="/mysql-fabric/mysql-fabric-adding-high-availability-and-scaling-to-mysql#comments">24 comments</a>	</div>
	<div class="clear"></div>
</div>

				<h2 class="post-title"><a href="/mysql-fabric/mysql-fabric-adding-high-availability-and-scaling-to-mysql" rel="bookmark">MySQL Fabric now Generally Available ‚Äì Automating High Availability and Sharding for MySQL</a></h2>
				
				<div class="entry">
										<p><a href="/wp-content/uploads/2014/03/fabric3.png"><img fetchpriority="high" decoding="async" class="aligncenter size-full wp-image-3800" src="/wp-content/uploads/2014/03/fabric3.png" alt="MySQL Fabric - High Availability and Scalability for MySQL" width="725" height="352" srcset="/wp-content/uploads/2014/03/fabric3.png 725w, /wp-content/uploads/2014/03/fabric3-300x145.png 300w" sizes="(max-width: 725px) 100vw, 725px"></a><br>
MySQL Fabric is a new framework that automates High Availability (HA) and/or sharding (scaling-out) for MySQL <strong>and it has just been declared Generally Available</strong>.</p>
<p>This post focuses on MySQL Fabric as a whole &#8211; both High Availability and scaling out (sharding). It starts with an introductions to HA and scaling out (by partitioning/sharding data) and how MySQL Fabric achieves it before going on to work through a full example of deploying HA with MySQL Fabric and then adding sharding on top.</p>
<p><a title="Download MySQL Fabric for automated MySQL sharding and High Availability" href="http://dev.mysql.com/downloads/fabric/" target="_blank">Download and try MySQL Fabric now!</a></p>
<p>This post focuses on MySQL Fabric as a whole &#8211; both High Availability and scaling out (sharding). It starts with introductions to HA and scaling out (by partitioning/sharding data) and how MySQL Fabric achieves it before going on to work through a full example of deploying HA with MySQL Fabric and then adding sharding on top.</p>
<h2><a class="anchor" href="#what-mysql-fabric-provides" name="what-mysql-fabric-provides"></a>What MySQL Fabric Provides</h2>
<p>MySQL Fabric is built around an extensible framework for managing farms of MySQL Servers. Currently two features have been implemented &#8211; High Availability and scaling out using data sharding. Either of these features can be used in isolation or in combination.</p>
<p>Both features are implemented in two layers:</p>
<ul>
<ul>
<li>The <em>mysqlfabric</em> process which processes any management requests &#8211; whether received through the <em>mysqlfabric</em> command-line-interface (the manual for which can be found at <a href="http://dev.mysql.com/doc/mysql-utilities/1.4/en/fabric.html">http://dev.mysql.com/doc/mysql-utilities/1.4/en/fabric.html</a>) or from another process via the supplied XML/RPC interface. When using the HA feature, this process can also be made responsible for monitoring the master server and initiating failover to promote a slave to be the new master should it fail. The state of the server farm is held in the state store (a MySQL database) and the <em>mysqlfabric</em> process is responsible for providing the state and routing information to the connectors.</li>
<li>MySQL Connectors are used by the application code to access the database(s), converting instructions from a specific programming language to the MySQL wire protocol, which is used to communicate with the MySQL Server processes. A &#8216;Fabric-aware&#8217; connector stores a cache of the routing information that it has received from the <em>mysqlfabric</em> process and then uses that information to send transactions or queries to the correct MySQL Server. Currently the three supported Fabric-aware MySQL connectors are for PHP, Python and Java (and in turn the Doctrine and Hibernate Object-Relational Mapping frameworks). This approach means that the latency and potential bottleneck of sending all requests via a proxy can be avoided.</li>
</ul>
</ul>
<h3><a class="anchor" href="#high-availability" name="high-availability"></a>High Availability</h3>
<p>High Availability (HA) refers to the ability for a system to provide continuous service &#8211; a system is available while that service can be utilized. The level of availability is often expressed in terms of the &#8220;number of nines&#8221; &#8211; for example, a HA level of 99.999% means that the service can be used for 99.999% of the time, in other words, on average, the service is only unavailable for 5.25 minutes per year (and that includes all scheduled as well as unscheduled down-time).</p>
<h4><a class="anchor" href="#different-points-of-high-availability" name="different-points-of-high-availability"></a>Different Points of High Availability</h4>
<p><a href="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-13.53.05.png"><img decoding="async" class="alignright size-medium wp-image-3815" src="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-13.53.05-300x217.png" alt="Layers in architecture where High Availability is needed" width="300" height="217" srcset="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-13.53.05-300x217.png 300w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-13.53.05.png 734w" sizes="(max-width: 300px) 100vw, 300px"></a></p>
<p>The figure shows the different layers in the system that need to be available for service to be provided.</p>
<p>At the bottom is the data that the service relies on. Obviously, if that data is lost then the service cannot function correctly and so it&#8217;s important to make sure that there is at least one extra copy of that data. This data can be duplicated at the storage layer itself but with MySQL, it&#8217;s most commonly replicated by the layer above &#8211; the MySQL Server using MySQL Replication. The MySQL Server provides access to the data &#8211; there is no point in the data being there if you can&#8217;t get at it! It&#8217;s a common misconception that having redundancy at these two levels is enough to have a HA system but you also need to look at the system from the top-down.</p>
<p>To have a HA service, there needs to be redundancy at the application layer; in itself this is very straight-forward, just load balance all of the service requests over a pool of application servers which are all running the same application logic. If the service were something as simple as a random number generator then this would be fine but most useful applications need to access data and as soon as you move beyond a single database server (for example because it needs to be HA) then a way is needed to connect the application server to the correct data source. In a HA system, the routing isn&#8217;t a static function, if one database server should fail (or be taken down for maintenance) the application should be directed instead to an alternate database. Some HA systems implement this routing function by introducing a proxy process between the application and the database servers; others use a virtual IP address which can be migrated to the correct server. When using MySQL Fabric, this routing function is implemented within the Fabric-aware MySQL connector library that&#8217;s used by the application server processes.</p>
<h4><a class="anchor" href="#what-mysql-fabric-adds-in-terms-of-high-availability" name="what-mysql-fabric-adds-in-terms-of-high-availability"></a>What MySQL Fabric Adds in Terms of High Availability</h4>
<p>MySQL Fabric has the concept of a HA group which is a pool of two or more MySQL Servers; at any point in time, one of those servers is the Primary (MySQL Replication master) and the others are Secondaries (MySQL Replication slaves). The role of a HA group is to ensure that access to the data held within that group is always available.</p>
<p>While MySQL Replication allows the data to be made safe by duplicating it, for a HA solution two extra components are needed and MySQL Fabric provides these:</p>
<ul>
<ul>
<ul>
<li><strong>Failure detection and promotion</strong> &#8211; the MySQL Fabric process monitors the Primary within the HA group and should that server fail then it selects one of the Secondaries and promotes it to be the Primary (with all of the other slaves in the HA group then receiving updates from the new master). Note that the connectors can inform MySQL Fabric when they observe a problem with the Primary and the MySQL Fabric process uses that information as part of its decision making process surrounding the state of the servers in the farm.</li>
<li><strong>Routing of database requests</strong> &#8211; When MySQL Fabric promotes the new Primary, it updates the state store and notifies the connectors so that they can refresh their caches with the updated routing information. In this way, the application does not need to be aware that the topology has changed and that writes need to be sent to a different destination.</li>
</ul>
</ul>
</ul>
<h3><a class="anchor" href="#scaling-out---sharding" name="scaling-out---sharding"></a>Scaling Out &#8211; Sharding</h3>
<p>When nearing the capacity or write performance limit of a single MySQL Server (or <a title="MySQL Fabric ‚Äì adding High Availability to MySQL" href="/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql">HA group</a>), MySQL Fabric can be used to scale-out the database servers by partitioning the data across multiple MySQL Server &#8220;groups&#8221;. Note that a group could contain a single MySQL Server or it could be a HA group.</p>
<p><a href="/wp-content/uploads/2014/06/Screen-Shot-2014-06-17-at-08.04.21.png"><img decoding="async" class="aligncenter wp-image-3915 size-medium" src="/wp-content/uploads/2014/06/Screen-Shot-2014-06-17-at-08.04.21-300x250.png" alt="MySQL Fabric Architecture" width="300" height="250" srcset="/wp-content/uploads/2014/06/Screen-Shot-2014-06-17-at-08.04.21-300x250.png 300w, /wp-content/uploads/2014/06/Screen-Shot-2014-06-17-at-08.04.21.png 819w" sizes="(max-width: 300px) 100vw, 300px"></a></p>
<p>The administrator defines how data should be partitioned/sharded between these servers; this is done by creating shard mappings. A shard mapping applies to a set of tables and for each table the administrator specifies which column from those tables should be used as a shard key (the shard key will subsequently be used by MySQL Fabric to calculate which shard a specific row from one of those tables should be part of). Because all of these tables use the same shard key and mapping, the use of the same column value in those tables will result in those rows being in the same shard &#8211; allowing a single transaction to access all of them. For example, if using the subscriber-id column from multiple tables then all of the data for a specific subscriber will be in the same shard. The administrator then defines how that shard key should be used to calculate the shard number:</p>
<ul>
<ul>
<ul>
<li><strong>HASH</strong>: A hash function is run on the shard key to generate the shard number. If values held in the column used as the sharding key don&#8217;t tend to have too many repeated values then this should result in an even partitioning of rows across the shards.</li>
<li><strong>RANGE</strong>: The administrator defines an explicit mapping between ranges of values for the sharding key and shards. This gives maximum control to the user of how data is partitioned and which rows should be co-located.</li>
</ul>
</ul>
</ul>
<p>When the application needs to access the sharded database, it sets a property for the connection that specifies the sharding key &#8211; the Fabric-aware connector will then apply the correct range or hash mapping and route the transaction to the correct shard.</p>
<p>If further shards/groups are needed then MySQL Fabric can split an existing shard into two and then update the state-store and the caches of routing data held by the connectors. Similarly, a shard can be moved from one HA group to another.</p>
<p>Note that a single transaction or query can only access a single shard and so it is important to select shard keys based on an understanding of the data and the application&#8217;s access patterns. It doesn&#8217;t always make sense to shard all tables as some may be relatively small and having their full contents available in each group can be beneficial given the rule about no cross-shard queries. These global tables are written to a &#8216;global group&#8217; and any additions or changes to data in those tables are automatically replicated to all of the other groups. Schema changes are also made to the global group and replicated to all of the others to ensure consistency.</p>
<p>To get the best mapping, it may also be necessary to modify the schema if there isn&#8217;t already a &#8216;natural choice&#8217; for the sharding keys.</p>
<h2><a class="anchor" href="#worked-example" name="worked-example"></a>Worked Example</h2>
<p>The example that this post steps through starts by setting up MySQL Fabric itself and then uses it to manage HA using a group of MySQL Servers. An example application will store data in this new configuration. After that, the example will introduce shards to the server farm in order to scale out capacity and read/write performance.</p>
<p>The following sections set up the sharded MySQL configuration shown here before running some (Python) code against &#8211; with queries and transactions routed to the correct MySQL Server.</p>
<h3><a class="anchor" href="#building-the-mysql-fabric-framework" name="building-the-mysql-fabric-framework"></a>Building the MySQL Fabric Framework</h3>
<p>Note that this section is repeated from the earlier two posts and so can be skipped if you&#8217;ve already worked through one of them.</p>
<p>The machines being used already have MySQL 5.6 installed (though in a custom location) and so the only software pre-requisite is to install the MySQL connector for Python from the <a title="MySQL Connector/Python download page" href="http://dev.mysql.com/downloads/connector/python/">connector download page</a> and MySQL Fabric (part of MySQL Utilities) from the <a title="MySQL Fabric download page" href="http://dev.mysql.com/downloads/fabric/">MySQL Fabric download page</a>:</p>
<pre>[root@fab1 mysql ~]# rpm -i mysql-connector-python-1.2.2-1.el6.noarch.rpm
[root@fab1 mysql ~]# rpm -i mysql-utilities-1.4.3-1.el6.noarch.rpm
</pre>
<p>MySQL Fabric needs access to a MySQL Database to store state and routing information for the farm of servers; if there isn&#8217;t already a running MySQL Server instance that can be used for this then it&#8217;s simple to set one up:</p>
<pre>[mysql@fab1 ~]$ mkdir myfab
[mysql@fab1 ~]$ cd myfab/
[mysql@fab1 myfab]$ mkdir data  
[mysql@fab1 myfab]$ cat my.cnf
[mysqld]
datadir=/home/mysql/myfab/data
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3306
report-host=fab1
report-port=3306
server-id=1
log-bin=fab-bin.log
</pre>
<pre>[mysql@fab1 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --datadir=/home/mysql/myfab/data/ 

2014-02-12 16:55:45 1298 [Note] Binlog end
2014-02-12 16:55:45 1298 [Note] InnoDB: FTS optimize thread exiting.
2014-02-12 16:55:45 1298 [Note] InnoDB: Starting shutdown...
2014-02-12 16:55:46 1298 [Note] InnoDB: Shutdown completed; log sequence number 1600607
2014-02-12 16:55:46 1298 [Note] /home/mysql/mysql//bin/mysqld: Shutdown complete

[mysql@fab1 ~]$ mysqld --defaults-file=/home/mysql/myfab/my.cnf &amp;
</pre>
<p>MySQL Fabric needs to be able to access this state store and so a dedicated user is created (note that the <code>fabric</code> database hasn&#8217;t yet been created &#8211; that will be done soon using the <code>mysqlfabric</code> command):</p>
<pre>[mysql@fab1 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON fabric.* \
    TO fabric@localhost";
</pre>
<p>All of the management requests that we make for MySQL Fabric will be issued via the <code>mysqlfabric</code> command. This command is documented in the <a title="MySQL Fabric - documentation for the mysqlfabric command" href="http://dev.mysql.com/doc/mysql-utilities/1.4/en/fabric-util.html">MySQL Fabric User Guide</a> but sub-commands can be viewed from the terminal using the <code>list-commands</code> option:</p>
<pre>[mysql@fab1 ~]$ mysqlfabric help commands
group activate              Activate failure detector for server(s) in a group.
group description           Update group's description.
group deactivate            Deactivate failure detector for server(s) in a
group.
group create                Create a group.
group remove                Remove a server from a group.
group add                   Add a server into group.
group health                Check if any server within a group has failed and report health information.
group lookup_servers        Return information on existing server(s) in a group.
group destroy               Remove a group.
group demote                Demote the current master if there is one.
group promote               Promote a server into master.
group lookup_groups         Return information on existing group(s).
dump fabric_nodes           Return a list of Fabric servers.
dump shard_index            Return information about the index for all mappings matching any of the patterns provided.
dump sharding_information   Return all the sharding information about the tables passed as patterns.
dump servers                Return information about servers.
dump shard_tables           Return information about all tables belonging to mappings matching any of the provided patterns.
dump shard_maps             Return information about all shard mappings matching any of the provided patterns.
manage teardown             Teardown Fabric Storage System.
manage stop                 Stop the Fabric server.
manage setup                Setup Fabric Storage System.
manage ping                 Check whether Fabric server is running or not.
manage start                Start the Fabric server.
manage logging_level        Set logging level.
server set_weight           Set a server's weight.
server lookup_uuid          Return server's uuid.
server set_mode             Set a server's mode.
server set_status           Set a server's status.
role list                   List roles and associated permissions
user add                    Add a new Fabric user.
user password               Change password of a Fabric user.
user list                   List users and their roles
user roles                  Change roles for a Fabric user  * protocol: Protocol of the user (for example 'xmlrpc') * roles: Comma separated list of roles, IDs or names (see `role list`)
user delete                 Delete a Fabric user.
threat report_error         Report a server error.
threat report_failure       Report with certantity that a server has failed or is unreachable.
sharding list_definitions   Lists all the shard mapping definitions.
sharding remove_definition  Remove the shard mapping definition represented by the Shard Mapping ID.
sharding move_shard         Move the shard represented by the shard_id to the destination group.
sharding disable_shard      Disable a shard.
sharding remove_table       Remove the shard mapping represented by the Shard Mapping object.
sharding split_shard        Split the shard represented by the shard_id into the destination group.
sharding create_definition  Define a shard mapping.
sharding add_shard          Add a shard.
sharding add_table          Add a table to a shard mapping.
sharding lookup_table       Fetch the shard specification mapping for the given table
sharding enable_shard       Enable a shard.
sharding remove_shard       Remove a Shard.
sharding list_tables        Returns all the shard mappings of a particular sharding_type.
sharding prune_shard        Given the table name prune the tables according to the defined sharding specification for the table.
sharding lookup_servers     Lookup a shard based on the give sharding key.
event trigger               Trigger an event.
event wait_for_procedures   Wait until procedures, which are identified through their uuid in a list and separated by comma, finish 
							their execution.
</pre>
<p>MySQL Fabric has its own configuration file (note that its location can vary depending on your platform and how MySQL Utilities were installed). The contents of this configuration file should be reviewed before starting the MySQL Fabric process (in this case, the <code>mysqldump_program</code> and <code>mysqlclient_program</code> settings needed to be changed as MySQL was installed in a user&#8217;s directory) and the MySQL Fabric management port was changed to <code>8080</code> and authentication for the management interface was disabled:</p>
<pre>[root@fab1 mysql]# cat /etc/mysql/fabric.cfg
[DEFAULT]
prefix =
sysconfdir = /etc
logdir = /var/log

[logging]
url = file:///var/log/fabric.log
level = INFO

[storage]
auth_plugin = mysql_native_password
database = fabric
user = fabric
address = localhost:3306
connection_delay = 1
connection_timeout = 6
password =
connection_attempts = 6

[failure_tracking]
notification_interval = 60
notification_clients = 50
detection_timeout = 1
detection_interval = 6
notifications = 300
detections = 3
failover_interval = 0
prune_time = 3600

[servers]
password =
user = fabric

[connector]
ttl = 1

[protocol.xmlrpc]
disable_authentication = no
ssl_cert =
realm = MySQL Fabric
ssl_key =
ssl_ca =
threads = 5
user = admin
address = localhost:32274
password = admin

[executor]
executors = 5

[sharding]
mysqldump_program = /home/mysql/mysql/bin/mysqldump
mysqlclient_program = /home/mysql/mysql/bin/mysql

</pre>
<p>The final step before starting the MySQL Fabric process is to create the MySQL Fabric schema within the state store:</p>
<pre>[root@fab1 mysql]# mysqlfabric manage setup --param=storage.user=fabric
[INFO] 1399476439.536728 - MainThread - Initializing persister: user \
	(fabric), server (localhost:3306), database (fabric).
[INFO] 1399476451.330008 - MainThread - Initial password for admin/xmlrpc \
	set
Password set for admin/xmlrpc from configuration file.
[INFO] 1399476451.333563 - MainThread - Password set for admin/xmlrpc \
	from configuration file.
</pre>
<p>An optional step is then to check for yourself that the schema is indeed there:</p>
<pre>[mysql@fab1 ~]$ mysql --protocol=tcp -u root
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 5
Server version: 5.6.16-log MySQL Community Server (GPL)

Copyright (c) 2000, 2014, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| fabric             |
| mysql              |
| performance_schema |
| test               |
+--------------------+
5 rows in set (0.00 sec)

mysql&gt; use fabric;show tables;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
+-------------------+
| Tables_in_fabric  |
+-------------------+
| checkpoints       |
| error_log         |
| group_replication |
| groups            |
| permissions       |
| role_permissions  |
| roles             |
| servers           |
| shard_maps        |
| shard_ranges      |
| shard_tables      |
| shards            |
| user_roles        |
| users             |
+-------------------+
14 rows in set (0.00 sec)

</pre>
<p>The MySQL Fabric process can now be started; in this case the process will run from the terminal from which it&#8217;s started but the <code>--daemonize</code> option can be used to make it run as a daemon.</p>
<pre>[mysql@fab1 ~]$ mysqlfabric manage start
[INFO] 1399476805.324729 - MainThread - Fabric node starting.
[INFO] 1399476805.327456 - MainThread - Initializing persister: user \
	(fabric), server (localhost:3306), database (fabric).
[INFO] 1399476805.335908 - MainThread - Initial password for admin/xmlrpc \
	set
Password set for admin/xmlrpc from configuration file.
[INFO] 1399476805.339028 - MainThread - Password set for admin/xmlrpc \
	from configuration file.
[INFO] 1399476805.339868 - MainThread - Loading Services.
[INFO] 1399476805.359542 - MainThread - Starting Executor.
[INFO] 1399476805.360668 - MainThread - Setting 5 executor(s).
[INFO] 1399476805.363478 - Executor-0 - Started.
[INFO] 1399476805.366553 - Executor-1 - Started.
[INFO] 1399476805.368680 - Executor-2 - Started.
[INFO] 1399476805.372392 - Executor-3 - Started.
[INFO] 1399476805.376179 - MainThread - Executor started.
[INFO] 1399476805.382025 - Executor-4 - Started.
[INFO] 1399476805.385570 - MainThread - Starting failure detector.
[INFO] 1399476805.389736 - XML-RPC-Server - XML-RPC protocol server \
	('127.0.0.1', 8080) started.
[INFO] 1399476805.390695 - XML-RPC-Server - Setting 5 XML-RPC session(s).
[INFO] 1399476805.393918 - XML-RPC-Session-0 - Started XML-RPC-Session.
[INFO] 1399476805.396812 - XML-RPC-Session-1 - Started XML-RPC-Session.
[INFO] 1399476805.399596 - XML-RPC-Session-2 - Started XML-RPC-Session.
[INFO] 1399476805.402650 - XML-RPC-Session-3 - Started XML-RPC-Session.
[INFO] 1399476805.405305 - XML-RPC-Session-4 - Started XML-RPC-Session.
</pre>
<p>If the process had been run as a daemon then it&#8217;s useful to be able to check if it&#8217;s actually running:</p>
<pre>[mysql@fab1 ~]$ mysqlfabric manage ping
Command :
{ success     = True
  return      = True
  activities  =
}
</pre>
<h3><a class="anchor" href="#adding-mysql-servers-to-create-a-ha-farm" name="adding-mysql-servers-to-create-a-ha-farm"></a>Adding MySQL Servers to Create a HA Farm</h3>
<p>At this point, MySQL Fabric is up and running but it has no MySQL Servers to manage. This figure shows the what the configuration will look like once MySQL Servers have been added to create a HA server farm.</p>
<p><a href="/wp-content/uploads/2014/03/Single_shard_HA_with_MySQL_Fabric.png"><img decoding="async" class="aligncenter size-full wp-image-3857" src="/wp-content/uploads/2014/03/Single_shard_HA_with_MySQL_Fabric.png" alt="Single shard HA with MySQL Fabric" height="550" srcset="/wp-content/uploads/2014/03/Single_shard_HA_with_MySQL_Fabric.png 420w, /wp-content/uploads/2014/03/Single_shard_HA_with_MySQL_Fabric-175x300.png 175w" sizes="(max-width: 420px) 100vw, 420px"></a></p>
<p>Three MySQL Servers will make up the managed HA group &#8211; each running on a different machine &#8211; these are the configuration files for each (there&#8217;s no detailed commentary as this is standard MySQL stuff):</p>
<pre></pre>
<pre>[mysql@fab2 myfab]$ cat my2.cnf
[mysqld]
datadir=/home/mysql/myfab/data2
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab2.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3306
report-host=fab2
report-port=3306
server-id=20
log-bin=fab2-bin.log

[mysql@fab3 myfab]$ cat my3.cnf
[mysqld]
datadir=/home/mysql/myfab/data3
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab3.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3306
report-host=fab3
report-port=3306
server-id=30
log-bin=fab3-bin.log

[mysql@fab4 myfab]$ cat my4.cnf
[mysqld]
datadir=/home/mysql/myfab/data4
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab4.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3306
report-host=fab4
report-port=3306
server-id=40
log-bin=fab3-bin.log
</pre>
<p>These MySQL Servers can then be bootstrapped and started:</p>
<pre>[mysql@fab2 myfab]$ mkdir data2
[mysql@fab3 myfab]$ mkdir data3
[mysql@fab4 myfab]$ mkdir data3

[mysql@fab2 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my2.cnf \
    --datadir=/home/mysql/myfab/data2/
[mysql@fab3 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my3.cnf \
    --datadir=/home/mysql/myfab/data3/
[mysql@fab4 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my4.cnf \
    --datadir=/home/mysql/myfab/data4/

[mysql@fab2 ~]$ mysqld --defaults-file=/home/mysql/myfab/my2.cnf &amp;
[mysql@fab3 ~]$ mysqld --defaults-file=/home/mysql/myfab/my3.cnf &amp;
[mysql@fab4 ~]$ mysqld --defaults-file=/home/mysql/myfab/my4.cnf &amp;

[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO fabric@'%'"
[mysql@fab3 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO fabric@'%'"
[mysql@fab4 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO fabric@'%'"
[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO root@'%'"
[mysql@fab3 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO root@'%'"
[mysql@fab4 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO root@'%'"
</pre>
<p>At this point, the MySQL Fabric process (and its associate state store) is up and running, as are the MySQL Servers that will become part of the HA group. MySQL Fabric is now able to access and manipulate those MySQL Servers and so they can now be added to a HA group called <code>group_id-1</code>.</p>
<pre>[mysql@fab1 myfab]$ mysqlfabric group create group_id-1
Procedure :
{ uuid        = 7e0c90ec-f81f-4ff6-80d3-ae4a8e533979,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 myfab]$ mysqlfabric group add group_id-1 \
    192.168.56.102:3306
Procedure :
{ uuid        = 073f421a-9559-4413-98fd-b839131ea026,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 myfab]$ mysqlfabric group add group_id-1 \
	192.168.56.103:3306
Procedure :
{ uuid        = b0f5b04a-27e6-46ce-adff-bf1c046829f7,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 myfab]$ mysqlfabric group add group_id-1 \
	192.168.56.104:3306
Procedure :
{ uuid        = 520d1a7d-1824-4678-bbe4-002d0bae5aaa,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
</pre>
<p>The mysqlfabric command can then be used to confirm the list of servers that are part of the HA group:</p>
<pre>[mysql@fab1 ~]$ mysqlfabric group lookup_groups
Command :
{ success     = True
  return      = [{'group_id': 'group_id-1', 'description': '', 'master_uuid': '', 'failure_detector': False}]
  activities  =
}

[mysql@fab1 ~]$ mysqlfabric group lookup_servers group_id-1
Command :
{ success     = True
  return      = [{'status': 'SECONDARY', 'server_uuid': \
  			'00f9831f-d602-11e3-b65e-0800271119cb', 'mode': 'READ_ONLY', \
  			'weight': 1.0, 'address': '192.168.56.104:3306'}, \
  		{'status': 'SECONDARY', 'server_uuid': \
  			'f6fe224e-d601-11e3-b65d-0800275185c2', 'mode': 'READ_ONLY', \
  			'weight': 1.0, 'address': '192.168.56.102:3306'}, 
  		{'status': 'SECONDARY', 'server_uuid': \
  			'fbb5c440-d601-11e3-b65d-0800278bafa8', 'mode': 'READ_ONLY', \
  			'weight': 1.0, 'address': '192.168.56.103:3306'}]
  activities  =
}
</pre>
<p>Note that all of the MySQL Servers are reported as being Secondaries (in other words, none of them is acting as the MySQL Replication master). The next step is to promote one of the servers to be the Primary; in this case the <code>uuid</code> of the server we want to promote is provided but that isn&#8217;t required &#8211; in which case MySQL Fabric will select one.</p>
<pre>[mysql@fab1 myfab]$ mysqlfabric group promote group_id-1 \
	--slave_id 00f9831f-d602-11e3-b65e-0800271119cb
Procedure :
{ uuid        = c875371b-890c-49ff-b0a5-6bbc38be7097,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 myfab]$ mysqlfabric group lookup_servers group_id-1
Command :
{ success     = True
  return      = [
	{'status': 'PRIMARY', 'server_uuid': '00f9831f-d602-11e3-b65e-0800271119cb', \
	  	'mode': 'READ_WRITE', 'weight': 1.0, 'address': '192.168.56.104:3306'}, \
  	{'status': 'SECONDARY', 'server_uuid': 'f6fe224e-d601-11e3-b65d-0800275185c2', \
  		'mode': 'READ_ONLY', 'weight': 1.0, 'address': '192.168.56.102:3306'}, \
	{'status': 'SECONDARY', 'server_uuid': 'fbb5c440-d601-11e3-b65d-0800278bafa8', \
		'mode': 'READ_ONLY', 'weight': 1.0, 'address': '192.168.56.103:3306'}]
  activities  =
}

</pre>
<p>Note that <code>fab4</code> is now showing as the Primary; any of the Secondary servers can also be queried to confirm that they are indeed MySQL replication slaves of the Primary.</p>
<pre>[mysql@fab1 ~]$ mysql -h 192.168.56.103 -P3306 -u root -e "show slave status\G"
*************************** 1. row ***************************
               Slave_IO_State: Waiting for master to send event
                  Master_Host: 192.168.56.104
                  Master_User: fabric
                  Master_Port: 3306
                Connect_Retry: 60
              Master_Log_File: fab3-bin.000003
          Read_Master_Log_Pos: 487
               Relay_Log_File: fab3-relay-bin.000002
                Relay_Log_Pos: 695
        Relay_Master_Log_File: fab3-bin.000003
             Slave_IO_Running: Yes
            Slave_SQL_Running: Yes
              Replicate_Do_DB:
          Replicate_Ignore_DB:
           Replicate_Do_Table:
       Replicate_Ignore_Table:
      Replicate_Wild_Do_Table:
  Replicate_Wild_Ignore_Table:
                   Last_Errno: 0
                   Last_Error:
                 Skip_Counter: 0
          Exec_Master_Log_Pos: 487
              Relay_Log_Space: 898
              Until_Condition: None
               Until_Log_File:
                Until_Log_Pos: 0
           Master_SSL_Allowed: No
           Master_SSL_CA_File:
           Master_SSL_CA_Path:
              Master_SSL_Cert:
            Master_SSL_Cipher:
               Master_SSL_Key:
        Seconds_Behind_Master: 0
Master_SSL_Verify_Server_Cert: No
                Last_IO_Errno: 0
                Last_IO_Error:
               Last_SQL_Errno: 0
               Last_SQL_Error:
  Replicate_Ignore_Server_Ids:
             Master_Server_Id: 40
                  Master_UUID: 00f9831f-d602-11e3-b65e-0800271119cb
             Master_Info_File: mysql.slave_master_info
                    SQL_Delay: 0
          SQL_Remaining_Delay: NULL
      Slave_SQL_Running_State: Slave has read all relay log; waiting for the slave I/O \
      							thread to update it
           Master_Retry_Count: 86400
                  Master_Bind:
      Last_IO_Error_Timestamp:
     Last_SQL_Error_Timestamp:
               Master_SSL_Crl:
           Master_SSL_Crlpath:
           Retrieved_Gtid_Set: 00f9831f-d602-11e3-b65e-0800271119cb:1-2
            Executed_Gtid_Set: 00f9831f-d602-11e3-b65e-0800271119cb:1-2,\
            					fbb5c440-d601-11e3-b65d-0800278bafa8:1-2
                Auto_Position: 1
</pre>
<p>At this stage, the MySQL replication relationship is configured and running but there isn&#8217;t yet High Availability as MySQL Fabric is not monitoring the state of the servers &#8211; the final configuration step fixes that:</p>
<pre>[mysql@fab1 ~]$ mysqlfabric group activate group_id-1
Procedure :
{ uuid        = 40a5e023-06ba-4e1e-93de-4d4195f87851,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
</pre>
<p>Everything is now set up to detect if the Primary (master) should fail and in the event that it does, promote one of the Secondaries to be the new Primary. If using one of the MySQL Fabric-aware connectors (initially PHP, Python and Java) then that failover can be transparent to the application.</p>
<h3><a class="anchor" href="#run-an-application-against-the-ha-farm" name="run-an-application-against-the-ha-farm"></a>Run an Application Against the HA Farm</h3>
<p>The code that follows shows how an application can accesses the new HA group &#8211; in this case, using the Python connector. First an application table is created:</p>
<pre>[mysql@fab1 myfab]$ cat setup_table_ha.py
import mysql.connector
from mysql.connector import fabric

conn = mysql.connector.connect(
    fabric={"host" : "localhost", "port" : 32274, "username": "admin", \
    	"password" : "admin"},
    user="root", database="test", password="",
    autocommit=True
)

conn.set_property(mode=fabric.MODE_READWRITE, group="group_id-1")
cur = conn.cursor()
cur.execute(
"CREATE TABLE IF NOT EXISTS subscribers ("
"   sub_no INT, "
"   first_name CHAR(40), "
"   last_name CHAR(40)"
")"
) 
</pre>
<p>Note the following about that code sample:</p>
<ul>
<ul>
<ul>
<li>The connector is provided with the address for the MySQL Fabric process <code>localhost:32274</code> rather than any of the MySQL Servers</li>
<li>The <code>mode</code> property for the connection is set to <code>fabric.MODE_READWRITE</code> which the connector will interpret as meaning that the transaction should be sent to the Primary (as that&#8217;s where all writes must be executed so that they can be replicated to the Secondaries)</li>
<li>The <code>group</code> property is set to <code>group_id-1</code> which is the name that was given to the single HA Group</li>
</ul>
</ul>
</ul>
<p>This code can now be executed and then a check made on one of the Secondaries that the table creation has indeed been replicated from the Primary.</p>
<pre>[mysql@fab1 myfab]$ python setup_table_ha.py
[mysql@fab1 myfab]$ mysql -h 192.168.56.103 -P3306 -u root \
    -e "use test;show tables"
+----------------+
| Tables_in_test |
+----------------+
| subscribers    |
+----------------+
</pre>
<p>The next step is to add some rows to the table:</p>
<pre>[mysql@fab1 myfab]$ cat add_subs_ha.py
import mysql.connector
from mysql.connector import fabric

def add_subscriber(conn, sub_no, first_name, last_name):
    conn.set_property(group="group_id-1", mode=fabric.MODE_READWRITE)
    cur = conn.cursor()
    cur.execute(
        "REPLACE INTO subscribers VALUES (%s, %s, %s)",
        (sub_no, first_name, last_name)
        )

conn = mysql.connector.connect(
    fabric={"host" : "localhost", "port" : 32274, "username": "admin", \
    	"password" : "admin"},
    user="root", database="test", password="",
    autocommit=True
    )

conn.set_property(group="group_id-1", mode=fabric.MODE_READWRITE)

add_subscriber(conn, 72, "Billy", "Fish")
add_subscriber(conn, 500, "Billy", "Joel")
add_subscriber(conn, 1500, "Arthur", "Askey")
add_subscriber(conn, 5000, "Billy", "Fish")
add_subscriber(conn, 15000, "Jimmy", "White")
add_subscriber(conn, 17542, "Bobby", "Ball")
</pre>
<pre>[mysql@fab1 myfab]$ python add_subs_ha.py
</pre>
<pre>[mysql@fab1 myfab]$ mysql -h 192.168.56.103 -P3306 -u root \
    -e "select * from test.subscribers"
+--------+------------+-----------+
| sub_no | first_name | last_name |
+--------+------------+-----------+
|     72 | Billy      | Fish      |
|    500 | Billy      | Joel      |
|   1500 | Arthur     | Askey     |
|   5000 | Billy      | Fish      |
|  15000 | Jimmy      | White     |
|  17542 | Bobby      | Ball      |
+--------+------------+-----------+
</pre>
<p>And then the data can be retrieved (note that the <code>mode</code> parameter for the connection is set to <code>fabric.MODE_READONLY</code> and so the connector knows that it can load balance the requests across any MySQL Servers in the HA Group).</p>
<pre>mysql@fab1 myfab]$ cat read_table_ha.py
import mysql.connector
from mysql.connector import fabric

def find_subscriber(conn, sub_no):
    conn.set_property(group="group_id-1", mode=fabric.MODE_READONLY)
    cur = conn.cursor()
    cur.execute(
        "SELECT first_name, last_name FROM subscribers "
        "WHERE sub_no = %s", (sub_no, )
        )
    for row in cur:
        print row

conn = mysql.connector.connect(
    fabric={"host" : "localhost", "port" : 32274, "username": "admin", \
    	"password" : "admin"},
    user="root", database="test", password="",
    autocommit=True
    )

find_subscriber(conn, 72)
find_subscriber(conn, 500)
find_subscriber(conn, 1500)
find_subscriber(conn, 5000)
find_subscriber(conn, 15000)
find_subscriber(conn, 17542)

</pre>
<pre>[mysql@fab1 myfab]$ python read_table_ha.py
(u'Billy', u'Fish')
(u'Billy', u'Joel')
(u'Arthur', u'Askey')
(u'Billy', u'Fish')
(u'Jimmy', u'White')
(u'Bobby', u'Ball')
</pre>
<p>Note that if the Secondary servers don&#8217;t all have the same performance then you can skew the ratio for how many reads are sent to each one using the <code>mysqlfabric server set_weight</code> command &#8211; specifying a value between 0 and 1 (default is 1 for all servers). Additionally, the <code>mysqlfabric server set_mode</code> command can be used to specify if the Primary should receive some of the reads (<code>READ_WRITE</code>) or only writes (<code>WRITE_ONLY</code>).</p>
<p>The next section describes how this configuration can be extended to add scalability by sharding the table data (and it can be skipped if that isn&#8217;t needed).</p>
<h3><a class="anchor" href="#adding-scale-out-with-sharding" name="adding-scale-out-with-sharding"></a>Adding Scale-Out with Sharding</h3>
<p>The example in this section builds upon the previous one by adding more servers in order to scale out the capacity and read/write performance of the database. The first step is to create a new group (which is named <code>global-group</code> in this example) &#8211; the Global Group is a special HA group that performs two critical functions:</p>
<ul>
<ul>
<ul>
<li>Any data schema changes are applied to the Global Group and from there they will be replicated to each of the other HA Groups</li>
<li>If there are tables that contain data that should be replicated to all HA groups (rather than sharded) then any inserts, updates or deletes will be made on the Global Group and then replicated to the others. Those tables are referred to as global tables.</li>
</ul>
</ul>
</ul>
<p>The following figure illustrates what the configuration will look like once the Global Group has been created.</p>
<p><a href="/wp-content/uploads/2014/03/MySQL-Fabric-HA-Group-with-Global-Group.png"><img decoding="async" class="aligncenter size-full wp-image-3858" src="/wp-content/uploads/2014/03/MySQL-Fabric-HA-Group-with-Global-Group.png" alt="MySQL Fabric - HA Group with Global Group" height="550" srcset="/wp-content/uploads/2014/03/MySQL-Fabric-HA-Group-with-Global-Group.png 408w, /wp-content/uploads/2014/03/MySQL-Fabric-HA-Group-with-Global-Group-171x300.png 171w" sizes="(max-width: 408px) 100vw, 408px"></a></p>
<p>The global group will contain three MySQL Servers running on the same host (in a product environment they would be split over multiple machines) and so the first step is to configure, bootstrap and start those servers.</p>
<pre>[mysql@fab2 myfab]$ cat my2.1.cnf
[mysqld]
datadir=/home/mysql/myfab/data2.1
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab2.1.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3316
report-host=fab2
report-port=3316
server-id=21
log-bin=fab2.1-bin.log

[mysql@fab2 myfab]$ cat my2.2.cnf
[mysqld]
datadir=/home/mysql/myfab/data2.2
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab2.2.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3317
report-host=fab2
report-port=3316
server-id=22
log-bin=fab2.2-bin.log

[mysql@fab2 myfab]$ cat my2.3.cnf
[mysqld]
datadir=/home/mysql/myfab/data2.3
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab2.3.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3318
report-host=fab2
report-port=3318
server-id=23
log-bin=fab2.3-bin.log
</pre>
<pre>[mysql@fab2 myfab]$ mkdir data2.1
[mysql@fab2 myfab]$ mkdir data2.2
[mysql@fab2 myfab]$ mkdir data2.3

[mysql@fab2 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my2.1.cnf \
    --datadir=/home/mysql/myfab/data2.1/
[mysql@fab2 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my2.2.cnf \
    --datadir=/home/mysql/myfab/data2.2/
mysql@fab2 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my2.3.cnf \
    --datadir=/home/mysql/myfab/data2.3/

[mysql@fab2 ~]$ mysqld --defaults-file=/home/mysql/myfab/my2.1.cnf &amp;
[mysql@fab2 ~]$ mysqld --defaults-file=/home/mysql/myfab/my2.2.cnf &amp;
[mysql@fab2 ~]$ mysqld --defaults-file=/home/mysql/myfab/my2.3.cnf &amp;

[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3316 -u root -e "GRANT ALL ON *.* \
    TO root@'%'"
[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3317 -u root -e "GRANT ALL ON *.* \
    TO root@'%'"
[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3318 -u root -e "GRANT ALL ON *.* \
    TO root@'%'"
[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3316 -u root -e "GRANT ALL ON *.* \
    TO fabric@'%'"
[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3317 -u root -e "GRANT ALL ON *.* \
    TO fabric@'%'"
[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3318 -u root -e "GRANT ALL ON *.* \
    TO fabric@'%'"
</pre>
<p>The Global Group is defined and populated with MySQL Servers and then a Primary is promoted in the following steps:</p>
<pre>[mysql@fab1]$ mysqlfabric group create global-group
Procedure :
{ uuid        = 5f07e324-ec0a-42b4-98d0-46112f607143,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}

[mysql@fab1 ~]$ mysqlfabric group add global-group \
    192.168.56.102:3316
Procedure :
{ uuid        = ccf699f5-ba2c-4400-a8a6-f951e10d4315,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group add global-group \
    192.168.56.102:3317
Procedure :
{ uuid        = 7c476dda-3985-442a-b94d-4b9e650e5dfe,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group add global-group \
    192.168.56.102:3318
Procedure :
{ uuid        = 476fadd4-ca4f-49b3-a633-25dbe0ffdd11,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}

[mysql@fab1 ~]$ mysqlfabric group promote global-group
Procedure :
{ uuid        = e818708e-6e5e-4b90-aff1-79b0b2492c75,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group lookup_servers global-group
Command :
{ success     = True
  return      = [
  	{'status': 'PRIMARY', 'server_uuid': '56a08135-d60b-11e3-b69a-0800275185c2',\
  		'mode': 'READ_WRITE', 'weight': 1.0, 'address': '192.168.56.102:3316'}, \
	{'status': 'SECONDARY', 'server_uuid': '5d5f5cf6-d60b-11e3-b69b-0800275185c2', \
		'mode': 'READ_ONLY', 'weight': 1.0, 'address': '192.168.56.102:3317'}, \
	{'status': 'SECONDARY', 'server_uuid': '630616f4-d60b-11e3-b69b-0800275185c2', \
		'mode': 'READ_ONLY', 'weight': 1.0, 'address': '192.168.56.102:3318'}]
  activities  =
}
</pre>
<p>As an application table has already been created within the original HA group, that will need to copied to the new Global Group:</p>
<pre>mysql@fab1 myfab]$ mysqldump -d -u root --single-transaction \
    -h 192.168.56.102 -P3306 --all-databases &gt; my-schema.sql
[mysql@fab1 myfab]$ mysql -h 192.168.56.102 -P3317 -u root \
    -e 'reset master'
[mysql@fab1 myfab]$ mysql -h 192.168.56.102 -P3317 -u root \
	&lt; my-schema.sql
[mysql@fab1 ~]$ mysql -h 192.168.56.102 -P3317 -u root -e \
	'show create table test.subscribers\G'
*************************** 1. row ***************************
       Table: subscribers
Create Table: CREATE TABLE `subscribers` (
  `sub_no` int(11) DEFAULT NULL,
  `first_name` char(40) DEFAULT NULL,
  `last_name` char(40) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1
</pre>
<p>A shard mapping is an entity that is used to define how certain tables should be sharded between a set of HA groups. It is possible to have multiple shard mappings but in this example, only one will be used. When defining the shard mapping, there are two key parameters:</p>
<ul>
<ul>
<ul>
<li>The type of mapping &#8211; can be either <code>HASH</code> or <code>RANGE</code></li>
<li>The global group that will be used</li>
</ul>
</ul>
</ul>
<p>The commands that follow define the mapping and identify the index number assigned to this mapping (in this example &#8211; <code>3</code>) &#8211; in fact that same index is recovered in two different ways: using the <code>mysqlfabric</code> command and then reading the data directly from the state store:</p>
<pre>[mysql@fab1 ~]$ mysqlfabric sharding create_definition HASH global-group
Procedure :
{ uuid        = 78ea7209-b073-4d03-9d8b-bda92cc76f32,
  finished    = True,
  success     = True,
  return      = 1,
  activities  =
}

[mysql@fab1 ~]$ mysqlfabric sharding list_definitions
Command :
{ success     = True
  return      = [[1, 'HASH', 'global-group']]
  activities  =
}

[mysql@fab1 ~]$ mysql -h 127.0.0.1 -P3306 -u root \
	-e 'SELECT * FROM fabric.shard_maps'
+------------------+-----------+--------------+
| shard_mapping_id | type_name | global_group |
+------------------+-----------+--------------+
|                1 | HASH      | global-group |
+------------------+-----------+--------------+
</pre>
<p>The next step is to define what columns from which tables should be used as the sharding key (the value on which the HASH function is executed or is compared with the defined RANGEs). In this example, only one table is being sharded (the <code>subscribers</code> table with the <code>sub_no</code> column being used as the sharding key) but the command can simply be re-executed for further tables. Note that the identifier for the shard mapping (1) is passed on the command-line:</p>
<pre>[mysql@fab1 ~]$ mysqlfabric sharding add_table 1 test.subscribers sub_no
Procedure :
{ uuid        = 446aadd1-ffa6-4d19-8d52-4683f3d7c998,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
</pre>
<p>At this point, the shard mapping has been defined but no shards have been created and so the next step is to create a single shard and that shard will be stored in the existing HA group (<code>group_id-1</code>):</p>
<pre>[mysql@fab1 ~]$ mysqlfabric sharding add_shard 1 group_id-1 --state=enabled
Procedure :
{ uuid        = 4efc038c-cd18-448d-be32-ca797c4c006f,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}

[mysql@fab1]$ mysql -h 127.0.0.1 -P3306 -u root \
    -e 'select * from fabric.shards'
+----------+------------+---------+
| shard_id | group_id   | state   |
+----------+------------+---------+
|        1 | group_id-1 | ENABLED |
+----------+------------+---------+
</pre>
<p>At this point, the database has technically been sharded but of course it offers no scalability as there is only a single shard. The steps that follow evolve that configuration into one containing two shards as shown in the following figure.</p>
<p><a href="/wp-content/uploads/2014/03/MySQL-Fabric-with-HA-and-sharding.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3859" src="/wp-content/uploads/2014/03/MySQL-Fabric-with-HA-and-sharding.png" alt="MySQL Fabric with HA and sharding" width="828" height="720" srcset="/wp-content/uploads/2014/03/MySQL-Fabric-with-HA-and-sharding.png 828w, /wp-content/uploads/2014/03/MySQL-Fabric-with-HA-and-sharding-300x260.png 300w" sizes="auto, (max-width: 828px) 100vw, 828px"></a></p>
<p>Another HA group (<code>group_id-2</code>) is created, from three newly created MySQL Servers then one of the servers is promoted to be the Primary:</p>
<pre>[mysql@fab5 myfab]$ cat my5.cnf
[mysqld]
datadir=/home/mysql/myfab/data5
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab5.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3306
report-host=fab5
report-port=3306
server-id=50
log-bin=fab5-bin.log

[mysql@fab6 myfab]$ cat my6.cnf
[mysqld]
datadir=/home/mysql/myfab/data6
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab6.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3306
report-host=fab6
report-port=3306
server-id=60
log-bin=fab6-bin.log

[mysql@fab7 myfab]$ cat my7.cnf
[mysqld]
datadir=/home/mysql/myfab/data7
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab7.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3306
report-host=fab7
report-port=3306
server-id=70
log-bin=fab7-bin.log
</pre>
<pre>[mysql@fab5 myfab]$ mkdir data5
[mysql@fab6 myfab]$ mkdir data6
[mysql@fab7 myfab]$ mkdir data7

[mysql@fab5 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my5.cnf \
    --datadir=/home/mysql/myfab/data5/
[mysql@fab6 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my6.cnf \
    --datadir=/home/mysql/myfab/data6/
[mysql@fab7 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my7.cnf \
    --datadir=/home/mysql/myfab/data7/

[mysql@fab5 ~]$ mysqld --defaults-file=/home/mysql/myfab/my5.cnf &amp;
[mysql@fab6 ~]$ mysqld --defaults-file=/home/mysql/myfab/my6.cnf &amp;
[mysql@fab7 ~]$ mysqld --defaults-file=/home/mysql/myfab/my7.cnf &amp;

[mysql@fab5 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO root@'%'"
[mysql@fab6 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO root@'%'"
[mysql@fab7 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO root@'%'"
[mysql@fab5 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO fabric@'%'"
[mysql@fab6 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO fabric@'%'"
[mysql@fab7 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO fabric@'%'"
</pre>
<pre>[mysql@fab1 ~]$ mysqlfabric group create group_id-2
Procedure :
{ uuid        = 4ec6237a-ca38-497c-b54d-73d1fa7bbe03,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}

[mysql@fab1 ~]$ mysqlfabric group add group_id-2 192.168.56.105:3306
Procedure :
{ uuid        = fe679280-81ed-436c-9b7f-3d6f46987492,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group add group_id-2 192.168.56.106:3306
Procedure :
{ uuid        = 6fcf7e0c-c092-4d81-9898-448abf2b113c,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group add group_id-2 192.168.56.107:3306
Procedure :
{ uuid        = 8e9d4fbb-58ef-470d-81eb-8d92813427ae,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group promote group_id-2
Procedure :
{ uuid        = 21569d7f-93a3-4bdc-b22b-2125e9b75fca,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
</pre>
<p>At this point, the new HA group exists but is missing the application schema and data. Before allocating a shard to the group, a <code>reset master</code> needs to be executed on the Primary for the group (this is required because changes have already been made on that server &#8211; if nothing else, to grant permissions for one or more users to connect remotely). The <code>mysqlfabric group lookup_server</code> command is used to first check which of the three servers is currently the Primary.</p>
<pre>[mysql@fab1 ~]$ mysqlfabric group lookup_servers group_id-2
Command :
{ success     = True
  return      = [
  	{'status': 'PRIMARY', 'server_uuid': '10b086b5-d617-11e3-b6e7-08002767aedd', \
  		'mode': 'READ_WRITE', 'weight': 1.0, 'address': '192.168.56.105:3306'}, \
	{'status': 'SECONDARY', 'server_uuid': '5dc81563-d617-11e3-b6e9-08002717142f', \
		'mode': 'READ_ONLY', 'weight': 1.0, 'address': '192.168.56.106:3306'}, \
	{'status': 'SECONDARY', 'server_uuid': '83cae7b2-d617-11e3-b6ea-08002763b127', 'mode': 'READ_ONLY', 'weight': 1.0, 'address': '192.168.56.107:3306'}]
  activities  =
}
		
[mysql@fab1 myfab]$ mysql -h 192.168.56.105 -P3306 -uroot -e 'reset master'
</pre>
<h3><a class="anchor" href="#splitting-the-shard" name="splitting-the-shard"></a>Splitting the Shard</h3>
<p>The next step is to split the existing shard, specifying the shard id (in this case <code>1</code>) and the name of the HA group where the new shard will be stored:</p>
<pre>[mysql@fab1]$ mysqlfabric sharding split_shard 1 group_id-2
Procedure :
{ uuid        = 4c559f6c-0b08-4a57-b095-364755636b7b,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
</pre>
<p>Before looking at the application code changes that are needed to cope with the sharded data, a simple test can be run to confirm that the table&#8217;s existing data has indeed been split between the two shards:</p>
<pre>[mysql@fab1]$ mysql -h 192.168.56.102 -P3306 -uroot \
    -e 'select * from test.subscribers'
+--------+------------+-----------+
| sub_no | first_name | last_name |
+--------+------------+-----------+
|    500 | Billy      | Joel      |
|   1500 | Arthur     | Askey     |
|   5000 | Billy      | Fish      |
|  17542 | Bobby      | Ball      |
+--------+------------+-----------+

[mysql@fab1]$ mysql -h 192.168.56.107 -P3306 -uroot \
    -e 'select * from test.subscribers'
+--------+------------+-----------+
| sub_no | first_name | last_name |
+--------+------------+-----------+
|     72 | Billy      | Fish      |
|  15000 | Jimmy      | White     |
+--------+------------+-----------+
</pre>
<p>The next example Python code adds some new rows to the <code>subscribers</code> table. Note that the <code>tables</code> property for the connection is set to <code>test.subscribers</code> and the <code>key</code> to the value of the <code>sub_no</code> column for that table &#8211; this is enough information for the Fabric-aware connector to choose the correct shard/HA group and then the fact that the <code>mode</code> property is set to <code>fabric.MODE_READWRITE</code> further tells the connector that the transaction should be sent to the Primary within that HA group.</p>
<pre> 
[mysql@fab1 myfab]$ cat add_subs_shards2.py
import mysql.connector
from mysql.connector import fabric

def add_subscriber(conn, sub_no, first_name, last_name):
    conn.set_property(tables=["test.subscribers"], key=sub_no, \
    	mode=fabric.MODE_READWRITE)
    cur = conn.cursor()
    cur.execute(
        "REPLACE INTO subscribers VALUES (%s, %s, %s)",
        (sub_no, first_name, last_name)
        )

conn = mysql.connector.connect(
    fabric={"host" : "localhost", "port" : 32274, "username": "admin", \
    	"password" : "admin"},
    user="root", database="test", password="",
    autocommit=True
)

conn.set_property(tables=["test.subscribers"], scope=fabric.SCOPE_LOCAL)

add_subscriber(conn, 22, "Billy", "Bob")
add_subscriber(conn, 8372, "Banana", "Man")
add_subscriber(conn, 93846, "Bill", "Ben")
add_subscriber(conn, 5006, "Andy", "Pandy")
add_subscriber(conn, 15050, "John", "Smith")
add_subscriber(conn, 83467, "Tommy", "Cannon")
[mysql@fab1 myfab]$ python add_subs_shards2.py

</pre>
<pre>[mysql@fab1 myfab]$ python add_subs_shards2.py
</pre>
<p>The <code>mysql</code> client can then be used to confirm that the new data has also been partitioned between the two shards/HA groups.</p>
<pre>[mysql@fab1 myfab]$ mysql -h 192.168.56.103 -P3306 -uroot \
    -e 'select * from test.subscribers'
+--------+------------+-----------+
| sub_no | first_name | last_name |
+--------+------------+-----------+
|    500 | Billy      | Joel      |
|   1500 | Arthur     | Askey     |
|   5000 | Billy      | Fish      |
|  17542 | Bobby      | Ball      |
|     22 | Billy      | Bob       |
|   8372 | Banana     | Man       |
|  93846 | Bill       | Ben       |
|  15050 | John       | Smith     |
+--------+------------+-----------+

[mysql@fab1 myfab]$ mysql -h 192.168.56.107 -P3306 -uroot \
    -e 'select * from test.subscribers'
+--------+------------+-----------+
| sub_no | first_name | last_name |
+--------+------------+-----------+
|     72 | Billy      | Fish      |
|  15000 | Jimmy      | White     |
|   5006 | Andy       | Pandy     |
|  83467 | Tommy      | Cannon    |
+--------+------------+-----------+
</pre>
<h3><a class="anchor" href="#example-application-code-includes-sharding" name="example-application-code-includes-sharding"></a>Example Application Code (Includes Sharding)</h3>
<p>The final example application code reads the row for each of the records that have been added, the key thing to note here is that the <code>mode</code> property for the connection has been set to <code>fabric.MODE_READONLY</code> so that the Fabric-aware Python connector knows that it can load balance requests over the Secondaries within the HA groups rather than sending everything to the Primary.</p>
<pre>[mysql@fab1 myfab]$ cat read_table_shards2.py
import mysql.connector
from mysql.connector import fabric

def find_subscriber(conn, sub_no):
    conn.set_property(tables=["test.subscribers"], key=sub_no, mode=fabric.MODE_READONLY)
    cur = conn.cursor()
    cur.execute(
        "SELECT first_name, last_name FROM subscribers "
        "WHERE sub_no = %s", (sub_no, )
        )
    for row in cur:
        print row

conn = mysql.connector.connect(
    fabric={"host" : "localhost", "port" : 32274, "username": "admin", "password" : "admin"},
    user="root", database="test", password="",
    autocommit=True
    )

find_subscriber(conn, 22)
find_subscriber(conn, 72)
find_subscriber(conn, 500)
find_subscriber(conn, 1500)
find_subscriber(conn, 8372)
find_subscriber(conn, 5000)
find_subscriber(conn, 5006)
find_subscriber(conn, 93846)
find_subscriber(conn, 15000)
find_subscriber(conn, 15050)
find_subscriber(conn, 17542)
find_subscriber(conn, 83467)
</pre>
<pre>[mysql@fab1 myfab]$ python read_table_shards2.py
(u'Billy', u'Bob')
(u'Billy', u'Fish')
(u'Billy', u'Joel')
(u'Arthur', u'Askey')
(u'Banana', u'Man')
(u'Billy', u'Fish')
(u'Andy', u'Pandy')
(u'Bill', u'Ben')
(u'Jimmy', u'White')
(u'John', u'Smith')
(u'Bobby', u'Ball')
(u'Tommy', u'Cannon')
</pre>
<h2><a class="anchor" href="#current-limitations" name="current-limitations"></a>Current Limitations</h2>
<p>The initial version of MySQL Fabric is designed to be simple, robust and able to scale to thousands of MySQL Servers. This approach means that this version has a number of limitations, which are described here:</p>
<ul>
<ul>
<ul>
<li>Sharding is not completely transparent to the application. While the application need not be aware of which server stores a set of rows and it doesn&#8217;t need to be concerned when that data is moved, it does need to provide the sharding key when accessing the database.</li>
<li>All transactions and queries need to be limited in scope to the rows held in a single shard, together with the global (non-sharded) tables. For example, Joins involving multiple shards are not supported.</li>
<li>Because the connectors perform the routing function, the extra latency involved in proxy-based solutions is avoided but it does mean that Fabric-aware connectors are required &#8211; at the time of writing these exist for PHP, Python and Java</li>
<li>The MySQL Fabric process itself is not fault-tolerant and must be restarted in the event of it failing. Note that this does not represent a single-point-of-failure for the server farm (HA and/or sharding) as the connectors are able to continue routing operations using their local caches while the MySQL Fabric process is unavailable.</li>
</ul>
</ul>
</ul>
<h2><a class="anchor" href="#mysql-fabric-architecture--extensibility" name="mysql-fabric-architecture--extensibility"></a>MySQL Fabric Architecture &amp; Extensibility</h2>
<p>MySQL Fabric has been architected for extensibility at a number of levels. For example, in the first release the only option for implementing HA is based on MySQL Replication but in future releases we hope to add further options (for example, MySQL Cluster). We also hope to see completely new applications around the managing of farms of MySQL Servers &#8211; both from Oracle and the wider MySQL community.</p>
<p>The following diagram illustrates how new applications and protocols can be added using the pluggable framework.</p>
<p><a href="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03.png"><img loading="lazy" decoding="async" style="max-width: 100%;" src="https://github-camo.global.ssl.fastly.net/2144549107fc4998082c17d76ce4152aa79b763f/687474703a2f2f7777772e636c757374657264622e636f6d2f77702d636f6e74656e742f75706c6f6164732f323031342f30332f53637265656e2d53686f742d323031342d30332d31382d61742d31352e33372e30332d31303234783530312e706e67" alt="MySQL Fabric - Extensible Architecture" width="480" height="234" data-canonical-src="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03-1024x501.png"></a></p>
<h2><a class="anchor" href="#next-steps" name="next-steps"></a>Next Steps</h2>
<p>We really hope that people try out MySQL Fabric and let us know how you get on; one way is to comment on this post, another is to post to the <a title="MySQL Forums :: Fabric, Sharding, HA, Utilities" href="http://forums.mysql.com/list.php?144">MySQL Fabric forum</a> or if you think you&#8217;ve found a bug then <a title="MySQL bugs database" href="http://bugs.mysql.com/">raise a bug report</a>.</p>
					<div class="clear"></div>
									</div>
		<br>
		<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
   		<a href="http://twitter.com/share" class="twitter-share-button" data-url="/mysql-fabric/mysql-fabric-adding-high-availability-and-scaling-to-mysql" data-via="wpbeginner" data-text="MySQL Fabric now Generally Available ‚Äì Automating High Availability and Sharding for MySQL" data-related="syedbalkhi:Founder of WPBeginner" data-count="horizontal">Tweet</a>
		<br>
		<!-- <g:plusone size="medium" href="/mysql-fabric/mysql-fabric-adding-high-availability-and-scaling-to-mysql"></g:plusone> -->
		<div class="g-plusone" data-annotation="inline" data-width="300"></div>
		<!-- Place this tag after the last +1 button tag. -->
		<script type="text/javascript">(function() {
    				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    				po.src = 'https://apis.google.com/js/plusone.js';
    				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  			})();</script>
		<br>
		<script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><script type="in/share" data-url="/mysql-fabric/mysql-fabric-adding-high-availability-and-scaling-to-mysql" data-counter="right"></script>
		<br>
		<iframe src="http://www.facebook.com/plugins/like.php?href=%2Fmysql-fabric%2Fmysql-fabric-adding-high-availability-and-scaling-to-mysql&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:60px;">
		</iframe>

<!-- ZXZX -->
				<div class="postinfo">Category: <a href="/category/mysql-fabric" rel="category tag">MySQL Fabric</a> | 
Tags: <a href="/tag/fabric" rel="tag">fabric</a>, <a href="/tag/ha" rel="tag">HA</a>, <a href="/tag/high-availability" rel="tag">High Availability</a>, <a href="/tag/mysql" rel="tag">MySQL</a>, <a href="/tag/mysql-fabric-2" rel="tag">mysql fabric</a>, <a href="/tag/sharding" rel="tag">sharding</a></div>

			</div>			<div id="post-3884" class="post-3884 post type-post status-publish format-standard hentry category-mysql-cluster tag-mcm tag-mysql tag-mysql-cluster tag-mysql-cluster-manager">
				
				<div class="postmeta">	<div class="postmeta_links">
		<a href="/author/andrew" title="Posts by andrew" rel="author">andrew</a> |
		<a href="/mysql-cluster/mysql-cluster-manager-1-3-1-released">April 30, 2014</a>
			</div>
	<div class="postcomments">
		<a href="/mysql-cluster/mysql-cluster-manager-1-3-1-released#respond">No comments</a>	</div>
	<div class="clear"></div>
</div>

				<h2 class="post-title"><a href="/mysql-cluster/mysql-cluster-manager-1-3-1-released" rel="bookmark">MySQL Cluster Manager 1.3.1 released</a></h2>
				
				<div class="entry">
										<p><a href="/wp-content/uploads/2013/06/MySQL_Cluster_Manager2.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2013/06/MySQL_Cluster_Manager2-300x106.png" alt="MySQL Cluster Manager logo" width="300" height="106" class="alignright size-medium wp-image-2846"></a>MySQL Cluster Manager 1.3.1 is now available to <a href="https://support.oracle.com/" title="Download MySQL Cluster Manager" target="_blank">download from My Oracle Support</a> and soon from the <a href="https://edelivery.oracle.com/" title="Oracle Software Delivery Cloud" target="_blank">Oracle Software Delivery Cloud</a>.</p>
<p>Details are available in the the <a title="MySQL Cluster Manager - change history" href="http://dev.mysql.com/doc/relnotes/mysql-cluster-manager/1.3/en/mcm-news-1-3-1.html" target="_blank">MCM 1.3.1 Release Notes</a>¬†.</p>
<p><a title="MySQL Cluster Manager documentation" href="http://dev.mysql.com/doc/relnotes/mysql-cluster-manager/1.3/en/index.html" target="_blank">Documentation is available here</a>.</p>
					<div class="clear"></div>
									</div>
		<br>
		<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
   		<a href="http://twitter.com/share" class="twitter-share-button" data-url="/mysql-cluster/mysql-cluster-manager-1-3-1-released" data-via="wpbeginner" data-text="MySQL Cluster Manager 1.3.1 released" data-related="syedbalkhi:Founder of WPBeginner" data-count="horizontal">Tweet</a>
		<br>
		<!-- <g:plusone size="medium" href="/mysql-cluster/mysql-cluster-manager-1-3-1-released"></g:plusone> -->
		<div class="g-plusone" data-annotation="inline" data-width="300"></div>
		<!-- Place this tag after the last +1 button tag. -->
		<script type="text/javascript">(function() {
    				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    				po.src = 'https://apis.google.com/js/plusone.js';
    				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  			})();</script>
		<br>
		<script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><script type="in/share" data-url="/mysql-cluster/mysql-cluster-manager-1-3-1-released" data-counter="right"></script>
		<br>
		<iframe src="http://www.facebook.com/plugins/like.php?href=%2Fmysql-cluster%2Fmysql-cluster-manager-1-3-1-released&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:60px;">
		</iframe>

<!-- ZXZX -->
				<div class="postinfo">Category: <a href="/category/mysql-cluster" rel="category tag">MySQL Cluster</a> | 
Tags: <a href="/tag/mcm" rel="tag">MCM</a>, <a href="/tag/mysql" rel="tag">MySQL</a>, <a href="/tag/mysql-cluster" rel="tag">MySQL Cluster</a>, <a href="/tag/mysql-cluster-manager" rel="tag">MySQL Cluster Manager</a></div>

			</div>			<div id="post-3882" class="post-3882 post type-post status-publish format-standard hentry category-mysql-cluster tag-mysql tag-mysql-cluster tag-mysql-cluster-7-1">
				
				<div class="postmeta">	<div class="postmeta_links">
		<a href="/author/andrew" title="Posts by andrew" rel="author">andrew</a> |
		<a href="/mysql-cluster/mysql-cluster-7-1-31-released">April 30, 2014</a>
			</div>
	<div class="postcomments">
		<a href="/mysql-cluster/mysql-cluster-7-1-31-released#respond">No comments</a>	</div>
	<div class="clear"></div>
</div>

				<h2 class="post-title"><a href="/mysql-cluster/mysql-cluster-7-1-31-released" rel="bookmark">MySQL Cluster 7.1.31 Released</a></h2>
				
				<div class="entry">
										<p><a href="/wp-content/uploads/2013/11/MySQL_Cluster.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2013/11/MySQL_Cluster-300x125.png" alt="MySQL Cluster Logo" width="300" height="125" class="alignnone size-medium wp-image-2982" srcset="/wp-content/uploads/2013/11/MySQL_Cluster-300x125.png 300w, /wp-content/uploads/2013/11/MySQL_Cluster.png 1004w" sizes="auto, (max-width: 300px) 100vw, 300px"></a>The binary and source versions of MySQL Cluster 7.1.31 have now been made available at <a href="http://www.mysql.com/downloads/cluster/" target="_blank">http://www.mysql.com/downloads/cluster/</a>.</p>
<p>A description of all of the changes (fixes) that have gone into MySQL Cluster 7.1.31 (compared to 7.1.30) is available from the <a href="http://dev.mysql.com/doc/relnotes/mysql-cluster/7.1/en/mysql-cluster-news-5-1-73-ndb-7-1-31.html" target="_blank" title="MySQL Cluster 7.1.31 release notes">7.1.31 Change log</a>.</p>
					<div class="clear"></div>
									</div>
		<br>
		<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
   		<a href="http://twitter.com/share" class="twitter-share-button" data-url="/mysql-cluster/mysql-cluster-7-1-31-released" data-via="wpbeginner" data-text="MySQL Cluster 7.1.31 Released" data-related="syedbalkhi:Founder of WPBeginner" data-count="horizontal">Tweet</a>
		<br>
		<!-- <g:plusone size="medium" href="/mysql-cluster/mysql-cluster-7-1-31-released"></g:plusone> -->
		<div class="g-plusone" data-annotation="inline" data-width="300"></div>
		<!-- Place this tag after the last +1 button tag. -->
		<script type="text/javascript">(function() {
    				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    				po.src = 'https://apis.google.com/js/plusone.js';
    				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  			})();</script>
		<br>
		<script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><script type="in/share" data-url="/mysql-cluster/mysql-cluster-7-1-31-released" data-counter="right"></script>
		<br>
		<iframe src="http://www.facebook.com/plugins/like.php?href=%2Fmysql-cluster%2Fmysql-cluster-7-1-31-released&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:60px;">
		</iframe>

<!-- ZXZX -->
				<div class="postinfo">Category: <a href="/category/mysql-cluster" rel="category tag">MySQL Cluster</a> | 
Tags: <a href="/tag/mysql" rel="tag">MySQL</a>, <a href="/tag/mysql-cluster" rel="tag">MySQL Cluster</a>, <a href="/tag/mysql-cluster-7-1" rel="tag">MySQL Cluster 7.1</a></div>

			</div>			<div id="post-3874" class="post-3874 post type-post status-publish format-standard hentry category-mysql-replication tag-mysql tag-mysql-5-7 tag-mysql-replication">
				
				<div class="postmeta">	<div class="postmeta_links">
		<a href="/author/andrew" title="Posts by andrew" rel="author">andrew</a> |
		<a href="/mysql-replication/mysql-replication-multi-threaded-slave-just-got-a-whole-lot-faster">April 2, 2014</a>
			</div>
	<div class="postcomments">
		<a href="/mysql-replication/mysql-replication-multi-threaded-slave-just-got-a-whole-lot-faster#comments">One comment</a>	</div>
	<div class="clear"></div>
</div>

				<h2 class="post-title"><a href="/mysql-replication/mysql-replication-multi-threaded-slave-just-got-a-whole-lot-faster" rel="bookmark">MySQL Replication &#8211; Multi-Threaded Slave just got a whole lot faster</a></h2>
				
				<div class="entry">
										<p><a href="/wp-content/uploads/2014/03/MySQL_Replication.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2014/03/MySQL_Replication-300x101.png" alt="MySQL Replication Logo" width="300" height="101" class="alignright size-medium wp-image-3803" srcset="/wp-content/uploads/2014/03/MySQL_Replication-300x101.png 300w, /wp-content/uploads/2014/03/MySQL_Replication-1024x347.png 1024w, /wp-content/uploads/2014/03/MySQL_Replication-900x305.png 900w, /wp-content/uploads/2014/03/MySQL_Replication.png 1240w" sizes="auto, (max-width: 300px) 100vw, 300px"></a><br>
A new MySQL <a href="/tag/mysql/page/labs.mysql.com" title="MySQL 5.7 Multi-threaded slave labs load" target="blank">MySQL 5.7 Multi-threaded slave labs load</a> has now been published on <a href="/tag/mysql/page/labs.mysql.com" title="MySQL Labs" target="blank">MySQL Labs</a>. This represents a signifficant step in the process of speeding up the processing of replication events on the slave &#8211; letting it keep up with the master.</p>
<p>The original implementation of MTS made a simple assumption about what events could safely be applied in parallel (with no dependency on the ordering). That assumption was that different schemas had no dependencies on each other and so if you had 5 schemas then one event from each schema could be applied in parallel (this is described in <a href="/mysql-replication/mysql-5-6-ga-replication-enhancements" title="MySQL 5.6 GA ‚Äì Replication Enhancements" target="blank">MySQL 5.6 GA ‚Äì Replication Enhancements</a>). This approach delivered a much higher throughput on the slave but only if you were using multiple schemas &#8211; perfect for many deployments (such as multi-tenant systems) but if you only had a single database then it didn&#8217;t help.</p>
<p>Last year we released a new version which removed that dependency on multiple schemas &#8211; allowing events to be applied to the same schema in parallel. For this implementation the new assumption was that if a set of transactions were part of the same binlog group commit on the master then the locking on the master has already determined that they&#8217;re indepent of each other and so that same set of events can be applied in parallel on the slave.</p>
<p>The latest enhancement is to allow the user to tune how many transactions are likely to be in each of those BGC buckets. This is done at the expense of delaying commits on the master and can be controlled by specifying the longest time that the system should wait (<code>binlog-group-commit-delay</code>) and the maximum number of transactions that should be committed together (<code>binlog-group-commit-count</code>). Initial benchmark results are very possitive &#8211; a 6X throughput (if willing to tolerate a small impact to the latency on the master) or 3X with no impact to the master.</p>
<p><a href="/wp-content/uploads/2014/04/Screen-Shot-2014-04-02-at-10.03.58.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2014/04/Screen-Shot-2014-04-02-at-10.03.58.png" alt="Multi-Threaded slave performance gains" width="1480" height="930" class="aligncenter size-full wp-image-3875" srcset="/wp-content/uploads/2014/04/Screen-Shot-2014-04-02-at-10.03.58.png 1480w, /wp-content/uploads/2014/04/Screen-Shot-2014-04-02-at-10.03.58-300x188.png 300w, /wp-content/uploads/2014/04/Screen-Shot-2014-04-02-at-10.03.58-1024x643.png 1024w, /wp-content/uploads/2014/04/Screen-Shot-2014-04-02-at-10.03.58-900x565.png 900w" sizes="auto, (max-width: 1480px) 100vw, 1480px"></a><br>
This is a feature where the mileage will definitely vary depending on your application and how you tune these two new parameters and so I&#8217;d certainly recommend that you try it out for yourselves. As always we&#8217;re anxious to get your feedback &#8211; for example through comments on this post or on the <a href="http://forums.mysql.com/list.php?26" title="MySQL Replication forum" target="blank">MySQL Replication forum</a>.</p>
					<div class="clear"></div>
									</div>
		<br>
		<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
   		<a href="http://twitter.com/share" class="twitter-share-button" data-url="/mysql-replication/mysql-replication-multi-threaded-slave-just-got-a-whole-lot-faster" data-via="wpbeginner" data-text="MySQL Replication &#8211; Multi-Threaded Slave just got a whole lot faster" data-related="syedbalkhi:Founder of WPBeginner" data-count="horizontal">Tweet</a>
		<br>
		<!-- <g:plusone size="medium" href="/mysql-replication/mysql-replication-multi-threaded-slave-just-got-a-whole-lot-faster"></g:plusone> -->
		<div class="g-plusone" data-annotation="inline" data-width="300"></div>
		<!-- Place this tag after the last +1 button tag. -->
		<script type="text/javascript">(function() {
    				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    				po.src = 'https://apis.google.com/js/plusone.js';
    				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  			})();</script>
		<br>
		<script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><script type="in/share" data-url="/mysql-replication/mysql-replication-multi-threaded-slave-just-got-a-whole-lot-faster" data-counter="right"></script>
		<br>
		<iframe src="http://www.facebook.com/plugins/like.php?href=%2Fmysql-replication%2Fmysql-replication-multi-threaded-slave-just-got-a-whole-lot-faster&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:60px;">
		</iframe>

<!-- ZXZX -->
				<div class="postinfo">Category: <a href="/category/mysql-replication" rel="category tag">MySQL Replication</a> | 
Tags: <a href="/tag/mysql" rel="tag">MySQL</a>, <a href="/tag/mysql-5-7" rel="tag">MySQL 5.7</a>, <a href="/tag/mysql-replication" rel="tag">MySQL Replication</a></div>

			</div>			<div id="post-3872" class="post-3872 post type-post status-publish format-standard hentry category-mysql-cluster tag-ha tag-high-availability tag-mysql tag-mysql-cluster tag-mysql-cluster-7-4 tag-performance">
				
				<div class="postmeta">	<div class="postmeta_links">
		<a href="/author/andrew" title="Posts by andrew" rel="author">andrew</a> |
		<a href="/mysql-cluster/mysql-cluster-7-4-0-labs-released">March 31, 2014</a>
			</div>
	<div class="postcomments">
		<a href="/mysql-cluster/mysql-cluster-7-4-0-labs-released#comments">4 comments</a>	</div>
	<div class="clear"></div>
</div>

				<h2 class="post-title"><a href="/mysql-cluster/mysql-cluster-7-4-0-labs-released" rel="bookmark">MySQL Cluster 7.4.0 Labs Release</a></h2>
				
				<div class="entry">
										<p><a href="/wp-content/uploads/2013/11/MySQL_Cluster.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2013/11/MySQL_Cluster-300x125.png" alt="MySQL Cluster Logo" width="300" height="125" class="alignright size-medium wp-image-2982" srcset="/wp-content/uploads/2013/11/MySQL_Cluster-300x125.png 300w, /wp-content/uploads/2013/11/MySQL_Cluster.png 1004w" sizes="auto, (max-width: 300px) 100vw, 300px"></a>The first version of MySQL Cluster 7.4 has now been released on <a href="http://labs.mysql.com/" title="MySQL Labs" target="blank">MySQL Labs</a>. Note that labs loads are not suitable for production use (in fact they&#8217;re even less mature than Development Milestone Releases); their purpose is to give users a chance to see what&#8217;s in the works, try it for themselves and then provide feedback. Having read that, if you&#8217;d like to try it out then <a href="http://labs.mysql.com/" title="Download MySQL Cluster 7.4 from MySQL Labs" target="blank">Download MySQL Cluster 7.4 from MySQL Labs</a>.</p>
<p>The focus of this first Cluster 7.4 load is performance and data node restart times.</p>
<h2>Performance</h2>
<p><a href="/wp-content/uploads/2014/03/Screen-Shot-2014-03-28-at-16.21.35.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2014/03/Screen-Shot-2014-03-28-at-16.21.35-300x203.png" alt="MySQL Cluster 7.4 Sysbench Read-Only" width="300" height="203" class="alignright size-medium wp-image-3869" srcset="/wp-content/uploads/2014/03/Screen-Shot-2014-03-28-at-16.21.35-300x203.png 300w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-28-at-16.21.35-1024x695.png 1024w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-28-at-16.21.35-900x611.png 900w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-28-at-16.21.35.png 1228w" sizes="auto, (max-width: 300px) 100vw, 300px"></a>MySQL Cluster was designed from the outset to be a distributed, in-memory database and has been deployed that way for many, many years (it&#8217;s interesting to see that the idea of in-memory databases has now really come into vogue with excitement around new arrivals on the scene such as Hekaton). Not surprisingly when people are considering MySQL Cluster, performance and scalability are key features (High Availability is another) and so performance improvements are always a key focus of every release and MySQL CLuster 7.4 is no exception.</p>
<p><a href="/wp-content/uploads/2014/03/Screen-Shot-2014-03-28-at-16.21.24.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2014/03/Screen-Shot-2014-03-28-at-16.21.24-300x199.png" alt="MySQL Cluster 7.4 Sysbench Read/Write" width="300" height="199" class="alignright size-medium wp-image-3868" srcset="/wp-content/uploads/2014/03/Screen-Shot-2014-03-28-at-16.21.24-300x199.png 300w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-28-at-16.21.24-1024x681.png 1024w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-28-at-16.21.24-900x599.png 900w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-28-at-16.21.24.png 1220w" sizes="auto, (max-width: 300px) 100vw, 300px"></a>The graphs show what&#8217;s already been acheived with Read Only Sysbench showing a 47% increase in throughput and a 38% improvement for the Read/Write benchmark. Even better improvements are seen when configuring the data nodes to use even more threads. For those not familiar with Sysbench, you should realise that each of the transactions involves quite a lot of work: 10 Primary Key lookups, 5 different types of scans where we fetch 100 records (normal select through ordered index followed by oder by, group by and so forth).</p>
<h2>Restart Times</h2>
<p>While less glamorous than performance, the time taken for a data node to restart can make a huge difference to how easy it is to manage your cluster. As the size and activity of the database increases, the restart time for a single data node will go up, if you then multiply that time by the number of data nodes you have, maintenance activities can start to take longer than you&#8217;d like.</p>
<p>This first MySQL Cluster 7.4 labs makes some signifficant improvements to the restart times &#8211; mostly by allowing more of the work to be done in parallel.</p>
					<div class="clear"></div>
									</div>
		<br>
		<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
   		<a href="http://twitter.com/share" class="twitter-share-button" data-url="/mysql-cluster/mysql-cluster-7-4-0-labs-released" data-via="wpbeginner" data-text="MySQL Cluster 7.4.0 Labs Release" data-related="syedbalkhi:Founder of WPBeginner" data-count="horizontal">Tweet</a>
		<br>
		<!-- <g:plusone size="medium" href="/mysql-cluster/mysql-cluster-7-4-0-labs-released"></g:plusone> -->
		<div class="g-plusone" data-annotation="inline" data-width="300"></div>
		<!-- Place this tag after the last +1 button tag. -->
		<script type="text/javascript">(function() {
    				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    				po.src = 'https://apis.google.com/js/plusone.js';
    				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  			})();</script>
		<br>
		<script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><script type="in/share" data-url="/mysql-cluster/mysql-cluster-7-4-0-labs-released" data-counter="right"></script>
		<br>
		<iframe src="http://www.facebook.com/plugins/like.php?href=%2Fmysql-cluster%2Fmysql-cluster-7-4-0-labs-released&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:60px;">
		</iframe>

<!-- ZXZX -->
				<div class="postinfo">Category: <a href="/category/mysql-cluster" rel="category tag">MySQL Cluster</a> | 
Tags: <a href="/tag/ha" rel="tag">HA</a>, <a href="/tag/high-availability" rel="tag">High Availability</a>, <a href="/tag/mysql" rel="tag">MySQL</a>, <a href="/tag/mysql-cluster" rel="tag">MySQL Cluster</a>, <a href="/tag/mysql-cluster-7-4" rel="tag">MySQL Cluster 7.4</a>, <a href="/tag/performance" rel="tag">Performance</a></div>

			</div>			<div id="post-3864" class="post-3864 post type-post status-publish format-standard hentry category-mysql-replication tag-ha tag-high-availability tag-mysql tag-mysql-replication">
				
				<div class="postmeta">	<div class="postmeta_links">
		<a href="/author/andrew" title="Posts by andrew" rel="author">andrew</a> |
		<a href="/mysql-replication/advanced-mysql-replication-architectures-and-latest-developments-on-demand-webinar-qa">March 27, 2014</a>
			</div>
	<div class="postcomments">
		<a href="/mysql-replication/advanced-mysql-replication-architectures-and-latest-developments-on-demand-webinar-qa#respond">No comments</a>	</div>
	<div class="clear"></div>
</div>

				<h2 class="post-title"><a href="/mysql-replication/advanced-mysql-replication-architectures-and-latest-developments-on-demand-webinar-qa" rel="bookmark">Advanced MySQL Replication Architectures and Latest Developments &#8211; On-Demand webinar + Q&#038;A</a></h2>
				
				<div class="entry">
										<p><a href="/wp-content/uploads/2014/03/MySQL_Replication.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2014/03/MySQL_Replication-300x101.png" alt="MySQL Replication Logo" width="300" height="101" class="alignright size-medium wp-image-3803" srcset="/wp-content/uploads/2014/03/MySQL_Replication-300x101.png 300w, /wp-content/uploads/2014/03/MySQL_Replication-1024x347.png 1024w, /wp-content/uploads/2014/03/MySQL_Replication-900x305.png 900w, /wp-content/uploads/2014/03/MySQL_Replication.png 1240w" sizes="auto, (max-width: 300px) 100vw, 300px"></a><br>
We recently hosted a live webinar covering advanced MySQL Replication topics as well as the latest developments. <a href="http://www.mysql.com/news-and-events/web-seminars/advanced-mysql-replication-architectures-and-latest-developments/" title="Advanced MySQL Replication Architectures and Latest Developments - on-demand webinar" target="blank">The webinar charts and replay are now available here</a>. Below, you&#8217;ll find the questions raised by the audience together with the responses given.</p>
<p>More details on what was covered&#8230;</p>
<p>The biggest Web sites in the world rely on MySQL Replication to scale-out and provide High Availability for their data. Extend your knowledge of how MySQL Replication works and what you can achieve with it; join us for this technical webinar to explore some of the more advanced replication architectures as well as some of the latest product developments:</p>
<ul>
<li>Replication topologies, including master-slave, circular and multi-master</li>
<li>Load balancing and query splitting</li>
<li>Data aggregation with multi-source replication</li>
<li>Global Transaction IDs and auto-failover with recovery</li>
<li>Getting the best replication throughput</li>
<li>Heterogeneous replication with the Binlog API</li>
</ul>
<h2>Questions &#038; Answers</h2>
<ul>
<li><strong>Is the <code>server_uuid</code> constant in the lifetime of a MySQL server?</strong>: Yes, <code>server_uuid</code> it&#8217;s persisted in a file in the <code>data_dir</code>.</li>
<li><strong>How are the servers syncronized after a failure?</strong>: When slave connects to master it will inform master which GTIDs it already has, (whether just received or actually or applied), and the master will send what is missing.</li>
<li><strong>Are all the features being described available now in the latest community MySQL version?</strong>: Everything that is described is available to the community. Some features are currently in Development Milestone or labs releases but that is made clear in the charts.</li>
<li><strong>What is the maximum number of Slaves per Master and are there restrictions to the distance between Master and Slave?</strong>: There is no maximum number of slaves per master, that value depends on hardware and workload. There is an overhead on the master for each of the slaves (though this is reducing); you always have the option of replicating to another one or MySQL Servers and then use them as replication masters to fan out to many more slaves (those servers can even use the Black Hole storage engine so that they don&#8217;t even store the data. No distance limits, but with longer distances the network latency will increase. If using the default asynchronous replication, this latency has not effect other than possibly the slave(s) running slightly further behind but if using semi-synchronous replication then the transactions will take longer to commit.</li>
<li><strong>Is there a maximum number of worker threads that can be configured, or is it just dependient on your server hardware?</strong>: The maximum number of worker thread is 1024, but the real limitation is hardware.</li>
<li><strong>Is there a form of automatic client rerouting as a result of Switch/Failover?</strong>: Yes &#8211; MySQL Fabric which is also covered in this session.</li>
<li><strong>what&#8217;s the resolution of the timestamp?</strong>: Replication timestamp resolution is microseconds.</li>
<li><strong>Are all of these replication features available in both Synchronous and Asynchronous modes?</strong>: There is no synchronous mode, but they all work with both asynchronous and  semi-synchronous replication.</li>
<li><strong>Why is semi-sync replication only available as plugin? It makes it harder to setup with the present restrictions.</strong>: By implementing features as plugins, we can evolve the software faster by implementing them in new modules rather than in the large, complex MySQL Server code base. It also means that we can iterate more frequently as it doesn&#8217;t need to be tied to a MySQL Server release.</li>
<li><strong>Does semi-synchronous replication wait for all slaves or just a single one?</strong>: You can specify  how many slaves need to respond with the <clode>rpl_semi_sync_master_wait_slave_count</clode> option.</li>
<li><strong>In case of one master one slave, where slave can overtake master role in case of crash. Won&#8217;t it introduce split-brain scenario ? Does mysql have rollback settings in case of master crash?</strong>: Monitoring tools should ensure that the master has crashed crashed, or if it suspects that it became irresponsible then it should kill the master before performing the failover. Alternatively, take a look at MySQL Fabric.</li>
<li><strong>For now I have impression that if I want clients to automatically load balance read &#038; writes between masters/slaves then I should do this using mysql proxy. Is this still the best practice?</strong>: What language are you using &#8211; this functionality is built into some connectors (for exampe for PHP and Java)? Alternatively you could look at MySQL Fabric or hardware or software load ballancers.	</li>
<li><strong>How are autoincrement columns handled in MySQL Fabric when you have mulitiple HA Groups?</strong>: The first thing to point out is that an auto-increment column cannot be used as the sharding key. You can use <code>auto_increment_increment</code> and <code>auto_increment_offset</code> to make sure that you don&#8217;t repeat values on different shards (e.g. if you have 2 shards then odd values coule be on one and even on the other.</li>
<li><strong>Is MySQL Fabric queried for every transaction or query (and so becomes a single-point-of-falire)?</strong>: No, the connectors hold a cache of the routing data and so will use that rather than constantly querying the MySQL Fabric process.</li>
<li><strong>Does the Replication include DDL changes, not just DML?</strong>: Yes it does.</li>
<li><strong>How do I scale out write operation in MySQL 5.6</strong>: That&#8217;s where MySQL Fabric comes in, when we reach the write saturation point on master.</li>
<li><strong>Is NDB storage engine is good option for write operation scale out?</strong>: It can be a great solution but it will depend on how your data is structured and accessed. Take a look at the<a href="http://www.mysql.com/why-mysql/white-papers/mysql-cluster-evaluation-guide/" title="MySQL Cluster Evaluation Guide - Designing, Evaluating and Benchmarking MySQL Cluster" target="blank">MySQL Cluster Evaluation Guide &#8211; Designing, Evaluating and Benchmarking MySQL Cluster</a> as this will help you figure out if MySQL Cluster (NDB) is going to be the right option for your application</li>
<li><strong>But fabric still in beta version right?</strong>: Correct &#8211; it isn&#8217;t ready for production yet (at the time of writing this is true but be sure to check if you&#8217;re reading this laster!).</li>
<li><strong>Are the benchmarks of <code>sync_binlog</code> done with SSD or HDD machines?</strong>: SSD &#8211; see <a href="http://mysqlmusings.blogspot.fr/2012/06/binary-log-group-commit-in-mysql-56.html" title="Binary Log Group Commit in MySQL 5.6" target="blank">this blog post</a>. <strong>Should we expect the same results with HDDs?</strong>: Yes, but with different orders of magnitude. Note that all benchmarks were made with SSDs, so we are comparing equal hardware on 5.5 and 5.6.</li>
</ul>
					<div class="clear"></div>
									</div>
		<br>
		<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
   		<a href="http://twitter.com/share" class="twitter-share-button" data-url="/mysql-replication/advanced-mysql-replication-architectures-and-latest-developments-on-demand-webinar-qa" data-via="wpbeginner" data-text="Advanced MySQL Replication Architectures and Latest Developments &#8211; On-Demand webinar + Q&#038;A" data-related="syedbalkhi:Founder of WPBeginner" data-count="horizontal">Tweet</a>
		<br>
		<!-- <g:plusone size="medium" href="/mysql-replication/advanced-mysql-replication-architectures-and-latest-developments-on-demand-webinar-qa"></g:plusone> -->
		<div class="g-plusone" data-annotation="inline" data-width="300"></div>
		<!-- Place this tag after the last +1 button tag. -->
		<script type="text/javascript">(function() {
    				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    				po.src = 'https://apis.google.com/js/plusone.js';
    				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  			})();</script>
		<br>
		<script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><script type="in/share" data-url="/mysql-replication/advanced-mysql-replication-architectures-and-latest-developments-on-demand-webinar-qa" data-counter="right"></script>
		<br>
		<iframe src="http://www.facebook.com/plugins/like.php?href=%2Fmysql-replication%2Fadvanced-mysql-replication-architectures-and-latest-developments-on-demand-webinar-qa&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:60px;">
		</iframe>

<!-- ZXZX -->
				<div class="postinfo">Category: <a href="/category/mysql-replication" rel="category tag">MySQL Replication</a> | 
Tags: <a href="/tag/ha" rel="tag">HA</a>, <a href="/tag/high-availability" rel="tag">High Availability</a>, <a href="/tag/mysql" rel="tag">MySQL</a>, <a href="/tag/mysql-replication" rel="tag">MySQL Replication</a></div>

			</div>			<div id="post-3821" class="post-3821 post type-post status-publish format-standard hentry category-mysql-fabric tag-ha tag-mysql tag-mysql-fabric-2 tag-scale tag-sharding">
				
				<div class="postmeta">	<div class="postmeta_links">
		<a href="/author/andrew" title="Posts by andrew" rel="author">andrew</a> |
		<a href="/mysql-fabric/mysql-fabric-add-scaling-to-mysql">March 24, 2014</a>
			</div>
	<div class="postcomments">
		<a href="/mysql-fabric/mysql-fabric-add-scaling-to-mysql#comments">2 comments</a>	</div>
	<div class="clear"></div>
</div>

				<h2 class="post-title"><a href="/mysql-fabric/mysql-fabric-add-scaling-to-mysql" rel="bookmark">MySQL Fabric &#8211; adding Scaling to MySQL</a></h2>
				
				<div class="entry">
										<p><a href="/wp-content/uploads/2014/03/fabric3.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3800" alt="MySQL Fabric - High Availability and Scalability for MySQL" src="/wp-content/uploads/2014/03/fabric3.png" width="725" height="352" srcset="/wp-content/uploads/2014/03/fabric3.png 725w, /wp-content/uploads/2014/03/fabric3-300x145.png 300w" sizes="auto, (max-width: 725px) 100vw, 725px"></a></p>
<p>MySQL Fabric is a new framework that adds High Availability (HA) and/or scaling-out for MySQL. This is the second in a series of posts on the new MySQL Fabric framework; the first article (<a title="MySQL Fabric ‚Äì adding High Availability to MySQL" href="/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql">MySQL Fabric ‚Äì adding High Availability to MySQL</a>) explained how MySQL Fabric can deliver HA and then stepped through all of the steps to configure and use it.</p>
<p>This post focuses on using MySQL Fabric to scale out both reads and writes across multiple MySQL Servers. It starts with an introduction to scaling out (by partitioning/sharding data) and how MySQL Fabric achieves it before going on to work through a full example of configuring sharding across a farm of MySQL Servers together with the code that the application developer needs to write in order to exploit it. Note that at the time of writing, MySQL Fabric is not yet GA but is available as a public alpha.</p>
<h3><a class="anchor" href="#scaling-out---sharding" name="scaling-out---sharding"></a>Scaling Out &#8211; Sharding</h3>
<p>When nearing the capacity or write performance limit of a single MySQL Server (or <a title="MySQL Fabric ‚Äì adding High Availability to MySQL" href="/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql">HA group</a>), MySQL Fabric can be used to scale-out the database servers by partitioning the data across multiple MySQL Server &#8220;groups&#8221;. Note that a group could contain a single MySQL Server or it could be a HA group.</p>
<p><a href="/wp-content/uploads/2014/03/Screen-Shot-2014-03-19-at-08.55.22.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3825" alt="MySQL Fabric cluster" src="/wp-content/uploads/2014/03/Screen-Shot-2014-03-19-at-08.55.22.png" width="606" height="554" srcset="/wp-content/uploads/2014/03/Screen-Shot-2014-03-19-at-08.55.22.png 606w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-19-at-08.55.22-300x274.png 300w" sizes="auto, (max-width: 606px) 100vw, 606px"></a></p>
<p>The administrator defines how data should be partitioned/sharded between these servers; this is done by creating shard mappings. A shard mapping applies to a set of tables and for each table the administrator specifies which column from those tables should be used as a shard key (the shard key will subsequently be used by MySQL Fabric to calculate which shard a specific row from one of those tables should be part of). Because all of these tables use the same shard key and mapping, the use of the same column value in those tables will result in those rows being in the same shard &#8211; allowing a single transaction to access all of them. For example, if using the subscriber-id column from multiple tables then all of the data for a specific subscriber will be in the same shard. The administrator then defines how that shard key should be used to calculate the shard number:</p>
<ul>
<li><strong>HASH</strong>: A hash function is run on the shard key to generate the shard number. If values held in the column used as the sharding key don&#8217;t tend to have too many repeated values then this should result in an even partitioning of rows across the shards.</li>
<li><strong>RANGE</strong>: The administrator defines an explicit mapping between ranges of values for the sharding key and shards. This gives maximum control to the user of how data is partitioned and which rows should be co-located.</li>
</ul>
<p>When the application needs to access the sharded database, it sets a property for the connection that specifies the sharding key &#8211; the Fabric-aware connector will then apply the correct range or hash mapping and route the transaction to the correct shard.</p>
<p>If further shards/groups are needed then MySQL Fabric can split an existing shard into two and then update the state-store and the caches of routing data held by the connectors. Similarly, a shard can be moved from one HA group to another.</p>
<p>Note that a single transaction or query can only access a single shard and so it is important to select shard keys based on an understanding of the data and the application&#8217;s access patterns. It doesn&#8217;t always make sense to shard all tables as some may be relatively small and having their full contents available in each group can be beneficial given the rule about no cross-shard queries. These global tables are written to a &#8216;global group&#8217; and any additions or changes to data in those tables are automatically replicated to all of the other groups. Schema changes are also made to the global group and replicated to all of the others to ensure consistency.</p>
<p>To get the best mapping, it may also be necessary to modify the schema if there isn&#8217;t already a &#8216;natural choice&#8217; for the sharding keys.</p>
<h2><a class="anchor" href="#worked-example" name="worked-example"></a>Worked Example</h2>
<p>The following steps set up the sharded MySQL configuration shown here before running some (Python) code against &#8211; with queries and transactions routed to the correct MySQL Server.</p>
<h3><a class="anchor" href="#building-the-sharded-mysql-server-farm" name="building-the-sharded-mysql-server-farm"></a>Building the Sharded MySQL Server Farm</h3>
<p><a href="/wp-content/uploads/2014/03/Screen-Shot-2014-03-19-at-12.19.22.png"><img loading="lazy" decoding="async" class="alignright size-medium wp-image-3835" alt="Sharding using MySQL Fabric" src="/wp-content/uploads/2014/03/Screen-Shot-2014-03-19-at-12.19.22-289x300.png" width="289" height="300" srcset="/wp-content/uploads/2014/03/Screen-Shot-2014-03-19-at-12.19.22-289x300.png 289w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-19-at-12.19.22.png 800w" sizes="auto, (max-width: 289px) 100vw, 289px"></a></p>
<p>The machines being used already have MySQL 5.6 installed (though in a custom location) and so the only software pre-requisite is to install the MySQL connector for Python from the &#8220;Development Releases&#8221; tab from the <a title="MySQL Connector/Python download page" href="http://dev.mysql.com/downloads/connector/python/">connector download page</a> and MySQL Fabric (part of MySQL Utilities) from the &#8220;Development Releases&#8221; tab on the <a title="MySQL Utilities - Including MySQL Fabric - download page" href="http://dev.mysql.com/downloads/tools/utilities/">MySQL Utilities download page</a>:</p>
<pre>[root@fab1 mysql ~]# rpm -i mysql-connector-python-1.2.0-1.el6.noarch.rpm
[root@fab1 mysql ~]# rpm -i mysql-utilities-1.4.1-1.el6.noarch.rpm</pre>
<p>MySQL Fabric needs access to a MySQL Database to store state and routing information for the farm of servers; if there isn&#8217;t already a running MySQL Server instance that can be used for this then it&#8217;s simple to set one up:</p>
<pre>[mysql@fab1 ~]$ mkdir myfab
[mysql@fab1 ~]$ cd myfab/
[mysql@fab1 myfab]$ mkdir data  
[mysql@fab1 myfab]$ cat my.cnf
[mysqld]
datadir=/home/mysql/myfab/data
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3306
report-host=fab1
report-port=3306
server-id=1
log-bin=fab-bin.log

[mysql@fab1 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --datadir=/home/mysql/myfab/data/ 

2014-02-12 16:55:45 1298 [Note] Binlog end
2014-02-12 16:55:45 1298 [Note] InnoDB: FTS optimize thread exiting.
2014-02-12 16:55:45 1298 [Note] InnoDB: Starting shutdown...
2014-02-12 16:55:46 1298 [Note] InnoDB: Shutdown completed; log sequence number 1600607
2014-02-12 16:55:46 1298 [Note] /home/mysql/mysql//bin/mysqld: Shutdown complete

[mysql@fab1 ~]$ mysqld --defaults-file=/home/mysql/myfab/my.cnf &amp;</pre>
<p>MySQL Fabric needs to be able to access this state store and so a dedicated user is created (note that the <code>fabric</code> database hasn&#8217;t yet been created &#8211; that will be done soon using the <code>mysqlfabric</code> command):</p>
<pre>[mysql@fab1 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON fabric.* \
    TO fabric@localhost";</pre>
<p>All of the management requests that we make for MySQL Fabric will be issued via the <code>mysqlfabric</code> command. This command is documented in the <a title="MySQL Fabric - documentation for the mysqlfabric command" href="http://dev.mysql.com/doc/mysql-utilities/1.4/en/fabric-util.html">MySQL Fabric User Guide</a> but sub-commands can be viewed from the terminal using the <code>list-commands</code> option:</p>
<pre>[mysql@fab1 /]$ mysqlfabric list-commands
group activate                   Activate a group.
group import_topology            Try to figure out the replication topology 
                                 and import it into the state store.
group deactivate                 Deactivate a group.
group create                     Create a group.
group remove                     Remove a server from a group.
group add                        Add a server into group.
group lookup_servers             Return information on existing server(s) in a 
                                 group.
group check_group_availability   Check if any server within a group has failed 
                                 and report health information.
group destroy                    Remove a group.
group demote                     Demote the current master if there is one.
group promote                    Promote a server into master.
group lookup_groups              Return information on existing group(s).
group description                Update group's description.
manage list-commands             List the possible commands.
manage help                      Give help on a command.
manage teardown                  Teardown Fabric Storage System.
manage stop                      Stop the Fabric server.
manage setup                     Setup Fabric Storage System.
manage ping                      Check whether Fabric server is running or not.
manage start                     Start the Fabric server.
manage logging_level             Set logging level.
server set_weight                Set a server's weight which determines the 
                                 likelihood of a server being chosen by a 
                                 connector to process transactions or by the 
                                 high availability service to replace a failed 
                                 master.
server lookup_uuid               Return server's uuid.
server set_mode                  Set a server's mode which determines whether 
                                 it can process read-only, read-write or both 
                                 transaction types.
server set_status                Set a server's status.
sharding move                    Move the shard represented by the shard_id to 
                                 the destination group.
sharding lookup_servers          Lookup a shard based on the give sharding key.
sharding disable_shard           Disable a shard.
sharding remove_mapping          Remove the shard mapping represented by the 
                                 Shard Mapping object.
sharding list_mappings           Returns all the shard mappings of a 
                                 particular sharding_type.
sharding add_mapping             Add a table to a shard mapping.
sharding add_shard               Add a shard.
sharding list_definitions        Lists all the shard mapping definitions.
sharding enable_shard            Enable a shard.
sharding remove_shard            Remove a Shard.
sharding prune_shard             Given the table name prune the tables 
                                 according to the defined sharding 
                                 specification for the table.
sharding lookup_mapping          Fetch the shard specification mapping for the 
                                 given table
sharding split                   Split the shard represented by the shard_id 
                                 into the destination group.
sharding define                  Define a shard mapping.
event trigger                    Trigger an event.
event wait_for_procedures        Wait until procedures, which are identified 
                                 through their uuid in a list and separated by
                                 comma, finish their execution.
store dump_shard_maps            Return information about all shard mappings 
                                 matching any of the provided patterns.
store dump_shard_index           Return information about the index for all 
                                 mappings matching any of the patterns 
                                 provided.
store dump_servers               Return information about all servers.
store dump_sharding_information  Return all the sharding information about the 
                                 tables passed as patterns.
store dump_shard_tables          Return information about all tables belonging 
                                 to mappings matching any of the provided 
                                 patterns.
store lookup_fabrics             Return a list of Fabric servers.</pre>
<p>MySQL Fabric has its own configuration file (note that it&#8217;s location can vary depending on your platform and how MySQL Utilities were installed). The contents of this configuration file should be reviewed before starting the MySQL Fabric process (in this case, the <code>mysqldump_program</code> and <code>mysqldump_program</code> settings needed to be changed as MySQL was installed in a user&#8217;s directory):</p>
<pre>[root@fab1 mysql]# cat /etc/mysql/fabric.cfg
[DEFAULT]
prefix =
sysconfdir = /etc/mysql
logdir = /var/log

[logging]
url = file:///var/log/fabric.log
level = INFO

[storage]
database = fabric
user = fabric
address = localhost:3306
connection_delay = 1
connection_timeout = 6
password =
connection_attempts = 6

[connector]
ttl = 1

[protocol.xmlrpc]
threads = 5
address = localhost:8080

[executor]
executors = 5

[sharding]
mysqldump_program = /home/mysql/mysql/bin/mysqldump
mysqlclient_program = /home/mysql/mysql/bin/mysql</pre>
<p>The final step before starting the MySQL Fabric process is to create the MySQL Fabric schema within the state store:</p>
<pre>[mysql@fab1 ~]$ mysqlfabric manage setup --param=storage.user=fabric
[INFO] 1392298030.100127 - MainThread - Initializing persister: \
    user (fabric), server (localhost:3306), database (fabric).</pre>
<p>An optional step is then to check for yourself that the schema is indeed there:</p>
<pre>[mysql@fab1 ~]$ mysql --protocol=tcp -u root
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 5
Server version: 5.6.16-log MySQL Community Server (GPL)

Copyright (c) 2000, 2014, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| fabric             |
| mysql              |
| performance_schema |
| test               |
+--------------------+
5 rows in set (0.00 sec)

mysql&gt; use fabric;show tables;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
+-------------------+
| Tables_in_fabric  |
+-------------------+
| checkpoints       |
| group_replication |
| groups            |
| servers           |
| shard_maps        |
| shard_ranges      |
| shard_tables      |
| shards            |
+-------------------+
8 rows in set (0.00 sec)</pre>
<p>The MySQL Fabric process can now be started; in this case the process will run from the terminal from which it&#8217;s started but the <code>--daemonize</code> option can be used to make it run as a daemon.</p>
<pre>[mysql@fab1 ~]$ mysqlfabric manage start
[INFO] 1392298245.888881 - MainThread - Fabric node starting.
[INFO] 1392298245.890465 - MainThread - Initializing persister: user (fabric), server (localhost:3306), database (fabric).
[INFO] 1392298245.890926 - MainThread - Loading Services.
[INFO] 1392298245.898459 - MainThread - Starting Executor.
[INFO] 1392298245.899056 - MainThread - Setting 5 executor(s).
[INFO] 1392298245.900439 - Executor-1 - Started.
[INFO] 1392298245.901856 - Executor-2 - Started.
[INFO] 1392298245.903146 - Executor-0 - Started.
[INFO] 1392298245.905488 - Executor-3 - Started.
[INFO] 1392298245.908283 - MainThread - Executor started.
[INFO] 1392298245.910308 - Executor-4 - Started.
[INFO] 1392298245.936954 - MainThread - Starting failure detector.
[INFO] 1392298245.938200 - XML-RPC-Server - XML-RPC protocol server \
    ('127.0.0.1', 8080) started.
[INFO] 1392298245.938614 - XML-RPC-Server - Setting 5 XML-RPC session(s).
[INFO] 1392298245.940895 - XML-RPC-Session-0 - Started XML-RPC-Session.
[INFO] 1392298245.942644 - XML-RPC-Session-1 - Started XML-RPC-Session.
[INFO] 1392298245.947016 - XML-RPC-Session-2 - Started XML-RPC-Session.
[INFO] 1392298245.949691 - XML-RPC-Session-3 - Started XML-RPC-Session.
[INFO] 1392298245.951678 - XML-RPC-Session-4 - Started XML-RPC-Session.</pre>
<p>If the process had been run as a daemon then it&#8217;s useful to be able to check if it&#8217;s actually running:</p>
<pre>[mysql@fab1 ~]$ mysqlfabric manage ping
Command :
{ success     = True
  return      = True
  activities  =
}</pre>
<p>At this point, MySQL Fabric is up and running but it has no MySQL Servers to manage. As shown in the earlier diagram, three MySQL Servers will run on a single machine. Each of those MySQL Servers will need their own configuration settings to make sure that there are no resource conflicts &#8211; the steps are shown here but without any detailed commentary as this is standard MySQL stuff:</p>
<pre>[mysql@fab2 myfab]$ cat my1a.cnf
[mysqld]
datadir=/home/mysql/myfab/data1a
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab1a.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3306
report-host=fab2
report-port=3306
server-id=11
log-bin=fab1a-bin.log

[mysql@fab2 myfab]$ cat my1b.cnf
[mysqld]
datadir=/home/mysql/myfab/data1b
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab1b.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3307
report-host=fab2
report-port=3307
server-id=12
log-bin=fab1b-bin.log

[mysql@fab2 myfab]$ cat my1c.cnf
[mysqld]
datadir=/home/mysql/myfab/data1c
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab1c.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3308
report-host=fab2
report-port=3308
server-id=13
log-bin=fab1c-bin.log

[mysql@fab2 myfab]$ mkdir data1a
[mysql@fab2 myfab]$ mkdir data1b
[mysql@fab2 myfab]$ mkdir data1c

[mysql@fab2 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my1a.cnf \
    --datadir=/home/mysql/myfab/data1a/
[mysql@fab2 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my1a.cnf \
    --datadir=/home/mysql/myfab/data1b/
[mysql@fab2 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my1a.cnf \
    --datadir=/home/mysql/myfab/data1c/

[mysql@fab2 ~]$ mysqld --defaults-file=/home/mysql/myfab/my1a.cnf &amp;
[mysql@fab2 ~]$ mysqld --defaults-file=/home/mysql/myfab/my1b.cnf &amp;
[mysql@fab2 ~]$ mysqld --defaults-file=/home/mysql/myfab/my1c.cnf &amp;

[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO root@'%'""
[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3307 -u root -e "GRANT ALL ON *.* \
    TO root@'%'""
[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3308 -u root -e "GRANT ALL ON *.* \
    TO root@'%'""</pre>
<p>At this point, the MySQL Fabric process (and its associate state store) is up and running, as are the MySQL Servers that will become part of the Fabric server farm. The next step is to define the groups (and assign a server to each one); the mappings that will be used to map from shard keys to shards and then finally the shards themselves.</p>
<p>The first group that&#8217;s created is the global group <code>group_id-global</code> which is where all changes to the data schema or to the global tables (those tables that are duplicated in every group rather than being sharded) are sent and then replicated to all of the other groups.</p>
<pre>[mysql@fab1 ~]$ mysqlfabric group create group_id-global
Procedure :
{ uuid        = 721888b2-f604-4001-94c9-5911e1a198b3,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}</pre>
<p>After that, the two groups that will contain the sharded table data are created &#8211; <code>group_id-1</code>&amp;<code>group_id-2</code>.</p>
<pre>[mysql@fab1 ~]$ mysqlfabric group create group_id-1
Procedure :
{ uuid        = 02f0a99d-5444-4f5b-b5df-b500de5a2d96,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group create group_id-2
Procedure :
{ uuid        = fb8c3638-7b2b-4106-baac-3531a4606792,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}</pre>
<p>The three groups have now been created but they&#8217;re all empty and so the next step is to assign a single MySQL Server to each one.</p>
<pre>[mysql@fab1 ~]$ mysqlfabric group add group_id-global 192.168.56.102:3306 root ""
Procedure :
{ uuid        = 9d851625-f488-4e9a-b18f-bfb952a18be6,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}

[mysql@fab1 ~]$ mysqlfabric group add group_id-1 192.168.56.102:3307 root ""    
Procedure :
{ uuid        = 1e0230ce-2309-4a11-92a4-4bf9f11061c3,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}

[mysql@fab1 ~]$ mysqlfabric group add group_id-2 192.168.56.102:3308 root ""
Procedure :
{ uuid        = cf5cd7ae-cf47-4c10-b68d-867fbff3c597,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}</pre>
<p>Optionally, the <code>mysqlfabric</code> command can then be used to confirm this configuration.</p>
<pre>[mysql@fab1 ~]$ mysqlfabric group lookup_groups
Command :
{ success     = True
  return      = [['group_id-1'], ['group_id-2'], ['group_id-global']]
  activities  =
}

[mysql@fab1 ~]$ mysqlfabric group lookup_servers group_id-global
Command :
{ success     = True
  return      = [['57dc7afc-957d-11e3-91a8-08002795076a', \
    '192.168.56.102', False, 'SECONDARY']]
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group lookup_servers group_id-1
Command :
{ success     = True
  return      = [['9c08ecd6-94b9-11e3-8cab-08002795076a', \
  '192.168.56.102:3307', False, 'SECONDARY']]
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group lookup_servers group_id-2
Command :
{ success     = True
  return      = [['a4a963a1-94b9-11e3-8cac-08002795076a', \
  '192.168.56.102:3308', False, 'SECONDARY']]
  activities  =
}</pre>
<p>Even though each of these groups contains a single server, it&#8217;s still necessary to promote those servers to be Primaries so that the Fabric-aware connectors will send writes to them.</p>
<pre>[mysql@fab1 ~]$ mysqlfabric group promote group_id-global
Procedure :
{ uuid        = fd29b5f9-97dc-4189-a7df-2d98b230a124,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group promote group_id-1
Procedure :
{ uuid        = a00e1a42-3a07-4539-a86b-1f9ac8284d27,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group promote group_id-2
Procedure :
{ uuid        = 32663313-8b6d-427b-8516-87539d712606,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}

[mysql@fab1 ~]$ mysqlfabric group lookup_servers group_id-1
Command :
{ success     = True
  return      = [['9c08ecd6-94b9-11e3-8cab-08002795076a', \
    '192.168.56.102:3307', True, 'PRIMARY']]
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group lookup_servers group_id-2
Command :
{ success     = True
  return      = [['a4a963a1-94b9-11e3-8cac-08002795076a', \
    '192.168.56.102:3308', True, 'PRIMARY']]
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group lookup_servers group_id-global
Command :
{ success     = True
  return      = [['57dc7afc-957d-11e3-91a8-08002795076a', \
    '192.168.56.102', True, 'PRIMARY']]
  activities  =
}</pre>
<p>Shard mappings are used to map shard keys to shards and they can be based on ranges or on a hash of the shard key &#8211; in this example, a single mapping will be created and it will be based on ranges. When creating the shard mapping, the name of the global group must be supplied &#8211; in this case <code>group_id-global</code>.</p>
<pre>[mysql@fab1 ~]$ mysqlfabric sharding define RANGE group_id-global
Procedure :
{ uuid        = d201b476-6ca2-4fd9-a3b2-619552b5fcd2,
  finished    = True,
  success     = True,
  return      = 1,
  activities  =
}</pre>
<p>From the return code, you can observe that the ID given to the shard mapping is 1 &#8211; that can optionally be confirmed by checking the meta data in the state store:</p>
<pre>[mysql@fab1 ~]$ mysql --protocol=tcp -ufabric -e \
    "SELECT * FROM test.shard_maps"   
+------------------+-----------+-----------------+
| shard_mapping_id | type_name | global_group    |
+------------------+-----------+-----------------+
|                1 | RANGE     | group_id-global |
+------------------+-----------+-----------------+</pre>
<p>The next step is to define the sharding key for each of the tables that we want to be partitioned as part of this mapping. In fact, this example is only sharding one table <code>test.subscribers</code> but the command can be repeated for multiple tables. The name of the column to be used as the sharding key must also be supplied (in this case <code>sub_no</code>) as must the ID for the shard mapping (which we&#8217;ve just confirmed is <code>1</code>).</p>
<pre>[mysql@fab1 myfab]$ mysqlfabric sharding add_mapping 1 test.subscribers sub_no
Procedure :
{ uuid        = 5ae7fe49-2c99-42d2-890a-8ee00c142719,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}</pre>
<p>Again, the state store can be checked to confirm that this has been set up correctly.</p>
<pre>[mysql@fab1 ~]$ mysql --protocol=tcp -ufabric -e \
    "SELECT * FROM test.shard_tables"   
+------------------+------------------+-------------+
| shard_mapping_id | table_name       | column_name |
+------------------+------------------+-------------+
|                1 | test.subscribers | sub_no      |
+------------------+------------------+-------------+</pre>
<p>The next step is to define the shards themselves. In this example, all values of <code>sub_no</code> from <code>1-9999</code> will be mapped to the first shard (which will be associated with <code>group_id-1</code>) and from <code>10000 and up</code> to the second shard (<code>group_id-2</code>). Again the shard mapping ID (1) must also be provided.</p>
<pre>[mysql@fab1 ~]$ mysqlfabric sharding add_shard 1 group_id-1 ENABLED 1
Procedure :
{ uuid        = 21b5c976-31ab-432b-8bf3-f19a84b2ed47,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric sharding add_shard 1 group_id-2 ENABLED 10000
Procedure :
{ uuid        = f837bded-825c-46a5-8edb-fe4557c53417,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}</pre>
<h3><a class="anchor" href="#example-application-code" name="example-application-code"></a>Example Application Code</h3>
<p>Now that the MySQL Fabric farm is up and running we can start running some code against it. There are currently Fabric-aware connectors for PHP, Python and Java &#8211; for this post, Python is used.</p>
<p>Note that while they must make some minor changes to work with the sharded database, they don&#8217;t need to care about what servers are part of the farm, what shards exist or where they&#8217;re located &#8211; this is all handled by MySQL Fabric and the Fabric-aware connectors. What they do need to do is provide the <em>hints</em> needed by the connector to figure out where to send the query or transaction.</p>
<p>The first piece of example code will create the <code>subscribers</code> table within the <code>test</code> database. Most of this is fairly standard and so only the MySQL Fabric-specific pieces will be commented on:</p>
<ul>
<li>The <code>fabric</code> module from <code>mysql.com</code> is included</li>
<li>The application connects to MySQL Fabric rather than any of the MySQL Servers (<code>{"host" : "localhost", "port" : 8080}</code>)</li>
<li>The <code>scope</code> property for the connection is set to <code>fabric.SCOPE_GLOBAL</code> &#8211; in that way the operations are sent to the global group by the connector so that the schema changes will be replicated to all servers in the HA group (the same would be true if writing to a non-sharded (global) table).</li>
</ul>
<pre>[mysql@fab1 myfab]$ cat setup_table_shards.py
import mysql.connector
from mysql.connector import fabric

conn = mysql.connector.connect(
    fabric={"host" : "localhost", "port" : 8080},
    user="root", database="test", password="",
    autocommit=True
    )

conn.set_property(tables=["test.subscribers"], scope=fabric.SCOPE_GLOBAL)
cur = conn.cursor()
cur.execute(
    "CREATE TABLE IF NOT EXISTS subscribers ("
    "   sub_no INT, "
    "   first_name CHAR(40), "
    "   last_name CHAR(40)"
    ")"
    )</pre>
<p>The code can then be executed:</p>
<pre>[mysql@fab1 myfab]$ python setup_table_shards.py</pre>
<p>The next piece of application code adds some records to the <code>test.subscribers</code> table. To ensure that the connector can route the transactions to the correct group, the following properties are set for the connection: <code>scope</code> is set to <code>fabric.SCOPE_LOCAL</code> (i.e. not global); <code>tables</code> is set to <code>"test.subscribers"</code> which allows the connector to select the correct mapping and <code>key</code> is set to the value of the <code>sub_no</code> being used for the row in the current transaction so that the connector can perform a range test on it to find the correct shard. The <code>mode</code> property is also set to <code>fabric.MODE_READWRITE</code> (if [HA groups]:(<a href="/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql">/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql</a> &#8220;MySQL Fabric ‚Äì adding High Availability to MySQL&#8221;) were being used then this would tell the connector to send the transaction to the primary).</p>
<pre>[mysql@fab1 myfab]$ cat add_subs_shards.py
import mysql.connector
from mysql.connector import fabric

def add_subscriber(conn, sub_no, first_name, last_name):
    conn.set_property(tables=["test.subscribers"], key=sub_no, \
        mode=fabric.MODE_READWRITE)
    cur = conn.cursor()
    cur.execute(
        "REPLACE INTO subscribers VALUES (%s, %s, %s)",
        (sub_no, first_name, last_name)
        )

# Address of the Fabric node, rather than the actual MySQL Server.
conn = mysql.connector.connect(
    fabric={"host" : "localhost", "port" : 8080},
    user="root", database="test", password="",
    autocommit=True
    )

conn.set_property(tables=["test.subscribers"], scope=fabric.SCOPE_LOCAL)

add_subscriber(conn, 72, "Billy", "Fish")
add_subscriber(conn, 500, "Billy", "Joel")
add_subscriber(conn, 1500, "Arthur", "Askey")
add_subscriber(conn, 5000, "Billy", "Fish")
add_subscriber(conn, 15000, "Jimmy", "White")
add_subscriber(conn, 17542, "Bobby", "Ball")</pre>
<p>This application code is then run and then the servers from each of the groups queried to confirm that the data has been sharded as expected (based on the 0-9999 and 10000+ range definition).</p>
<pre>[mysql@fab1 myfab]$ python add_subs_shards.py

[mysql@fab1 myfab]$ mysql -h 192.168.56.102 -P3307 -uroot ‚Äìe 'SELECT * \
    FROM test.subscribers'
+--------+------------+-----------+
| sub_no | first_name | last_name |
+--------+------------+-----------+
|     72 | Billy      | Fish      |
|    500 | Billy      | Joel      |
|   1500 | Arthur     | Askey     |
|   5000 | Billy      | Fish      |
+--------+------------+-----------+
[mysql@fab1 myfab]$ mysql -h 192.168.56.102 -P3308 -uroot -e 'SELECT * \
    FROM test.subscribers'
+--------+------------+-----------+
| sub_no | first_name | last_name |
+--------+------------+-----------+
|  15000 | Jimmy      | White     |
|  17542 | Bobby      | Ball      |
+--------+------------+-----------+</pre>
<p>The final piece of application code reads back the rows. Note that in this case the connection&#8217;s <code>mode</code> property is set to <code>fabric.READONLY</code> which tells the connector that if [HA groups]:(<a href="/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql">/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql</a> &#8220;MySQL Fabric ‚Äì adding High Availability to MySQL&#8221;) were being used then the queries could be sent to any of the Secondaries.</p>
<pre>[mysql@fab1 myfab]$ cat read_table_shards.py
import mysql.connector
from mysql.connector import fabric

def find_subscriber(conn, sub_no):
    conn.set_property(tables=["test.subscribers"], key=sub_no, \
        mode=fabric.MODE_READONLY)
    cur = conn.cursor()
    cur.execute(
        "SELECT first_name, last_name FROM subscribers "
        "WHERE sub_no = %s", (sub_no, )
        )
    for row in cur:
        print rows

conn = mysql.connector.connect(
    fabric={"host" : "localhost", "port" : 8080},
    user="root", database="test", password="",
    autocommit=True
    )

find_subscriber(conn, 72)
find_subscriber(conn, 500)
find_subscriber(conn, 1500)
find_subscriber(conn, 5000)
find_subscriber(conn, 15000)
find_subscriber(conn, 17542)</pre>
<pre>[mysql@fab1 myfab]$ python read_table_shards.py
(u'Billy', u'Fish')
(u'Billy', u'Joel')
(u'Arthur', u'Askey')
(u'Billy', u'Fish')
(u'Jimmy', u'White')
(u'Bobby', u'Ball')</pre>
<h2><a class="anchor" href="#mysql-fabric-architecture--extensibility" name="mysql-fabric-architecture--extensibility"></a>MySQL Fabric Architecture &amp; Extensibility</h2>
<p>MySQL Fabric has been architected for extensibility at a number of levels. For example, in the first release the only option for implementing HA is based on MySQL Replication but in future releases we hope to add further options (for example, MySQL Cluster). We also hope to see completely new applications around the managing of farms of MySQL Servers &#8211; both from Oracle and the wider MySQL community.</p>
<p>The following diagram illustrates how new applications and protocols can be added using the pluggable framework.</p>
<p><a href="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03-1024x501.png" alt="MySQL Fabric - Extensible Architecture" width="480" height="234" class="aligncenter size-large wp-image-3818" srcset="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03-1024x501.png 1024w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03-300x146.png 300w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03-900x440.png 900w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03.png 1254w" sizes="auto, (max-width: 480px) 100vw, 480px"></a></p>
<h2><a class="anchor" href="#next-steps" name="next-steps"></a>Next Steps</h2>
<p>We really hope that people try out MySQL Fabric and let us know how you get on; one way is to comment on this post, another is to post to the <a title="MySQL Forums :: Fabric, Sharding, HA, Utilities" href="http://forums.mysql.com/list.php?144">MySQL Fabric forum</a> or if you think you&#8217;ve found a bug then <a title="MySQL bugs database" href="http://bugs.mysql.com/">raise a bug report</a>.</p>
					<div class="clear"></div>
									</div>
		<br>
		<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
   		<a href="http://twitter.com/share" class="twitter-share-button" data-url="/mysql-fabric/mysql-fabric-add-scaling-to-mysql" data-via="wpbeginner" data-text="MySQL Fabric &#8211; adding Scaling to MySQL" data-related="syedbalkhi:Founder of WPBeginner" data-count="horizontal">Tweet</a>
		<br>
		<!-- <g:plusone size="medium" href="/mysql-fabric/mysql-fabric-add-scaling-to-mysql"></g:plusone> -->
		<div class="g-plusone" data-annotation="inline" data-width="300"></div>
		<!-- Place this tag after the last +1 button tag. -->
		<script type="text/javascript">(function() {
    				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    				po.src = 'https://apis.google.com/js/plusone.js';
    				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  			})();</script>
		<br>
		<script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><script type="in/share" data-url="/mysql-fabric/mysql-fabric-add-scaling-to-mysql" data-counter="right"></script>
		<br>
		<iframe src="http://www.facebook.com/plugins/like.php?href=%2Fmysql-fabric%2Fmysql-fabric-add-scaling-to-mysql&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:60px;">
		</iframe>

<!-- ZXZX -->
				<div class="postinfo">Category: <a href="/category/mysql-fabric" rel="category tag">MySQL Fabric</a> | 
Tags: <a href="/tag/ha" rel="tag">HA</a>, <a href="/tag/mysql" rel="tag">MySQL</a>, <a href="/tag/mysql-fabric-2" rel="tag">mysql fabric</a>, <a href="/tag/scale" rel="tag">Scale</a>, <a href="/tag/sharding" rel="tag">sharding</a></div>

			</div>			<div id="post-3807" class="post-3807 post type-post status-publish format-standard hentry category-mysql-fabric tag-ha tag-high-availability tag-mysql tag-mysql-fabric-2">
				
				<div class="postmeta">	<div class="postmeta_links">
		<a href="/author/andrew" title="Posts by andrew" rel="author">andrew</a> |
		<a href="/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql">March 18, 2014</a>
			</div>
	<div class="postcomments">
		<a href="/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql#comments">9 comments</a>	</div>
	<div class="clear"></div>
</div>

				<h2 class="post-title"><a href="/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql" rel="bookmark">MySQL Fabric &#8211; adding High Availability to MySQL</a></h2>
				
				<div class="entry">
										<p><a href="/wp-content/uploads/2014/03/fabric3.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2014/03/fabric3-300x145.png" alt="MySQL Fabric - High Availability and Scalability for MySQL" width="300" height="145" class="alignright size-medium wp-image-3800" srcset="/wp-content/uploads/2014/03/fabric3-300x145.png 300w, /wp-content/uploads/2014/03/fabric3.png 725w" sizes="auto, (max-width: 300px) 100vw, 300px"></a></p>
<p>MySQL Fabric is a new framework that adds High Availability (HA) and/or scaling-out for MySQL. MySQL Fabric achieves scale-out by managing the sharding of table data between multiple MySQL Servers and then having Fabric-aware connectors route queries and transactions to the correct locations &#8211; scaling-out will be the subject of a future post and the rest of this article is focused on using MySQL Fabric for HA. It starts with an introduction to HA and how MySQL Fabric delivers it before going on to work through a full example of configuring a HA farm of MySQL Servers together with the code that the application developer needs to write in order to exploit it. Note that at the time of writing, MySQL Fabric is not yet GA but is available as a public alpha.</p>
<h2>
<a name="high-availability---introduction" class="anchor" href="#high-availability---introduction"><span class="octicon octicon-link"></span></a>High Availability &#8211; Introduction</h2>
<p>High Availability (HA) refers to the ability for a system to provide continuous service &#8211; a system is available while that service can be utilized. The level of availability is often expressed in terms of the &#8220;number of nines&#8221; &#8211; for example, a HA level of 99.999% means that the service can be used for 99.999% of the time, in other words, on average, the service is only unavailable for 5.25 minutes per year (and that includes all scheduled as well as unscheduled down-time).</p>
<p><a href="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-13.53.05.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-13.53.05-300x217.png" alt="Layers in architecture where High Availability is needed" width="300" height="217" class="alignright size-medium wp-image-3815" srcset="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-13.53.05-300x217.png 300w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-13.53.05.png 734w" sizes="auto, (max-width: 300px) 100vw, 300px"></a></p>
<p>The figure shows the different layers in the system that need to be available for service to be provided. </p>
<p>At the bottom is the data that the service relies on. Obviously, if that data is lost then the service cannot function correctly and so it&#8217;s important to make sure that there is at least one extra copy of that data. This data can be duplicated at the storage layer itself but with MySQL, it&#8217;s most commonly replicated by the layer above &#8211; the MySQL Server using MySQL Replication. The MySQL Server provides access to the data &#8211; there is no point in the data being there if you can&#8217;t get at it! It&#8217;s a common misconception that having redundancy at these two levels is enough to have a HA system but you also need to look at the system from the top-down.</p>
<p>To have a HA service, there needs to be redundancy at the application layer; in itself this is very straight-forward, just load balance all of the service requests over a pool of application servers which are all running the same application logic. If the service were something as simple as a random number generator then this would be fine but most useful applications need to access data and as soon as you move beyond a single database server (for example because it needs to be HA) then a way is needed to connect the application server to the correct data source. In a HA system, the routing isn&#8217;t a static function, if one database server should fail (or be taken down for maintenance) the application should be directed instead to an alternate database. Some HA systems implement this routing function by introducing a proxy process between the application and the database servers; others use a virtual IP address which can be migrated to the correct server. When using MySQL Fabric, this routing function is implemented within the Fabric-aware MySQL connector library that&#8217;s used by the application server processes.</p>
<p>MySQL Fabric delivers HA by adding a management and monitoring layer on top of MySQL Replication together with a set of Fabric-aware MySQL Connectors that route writes (and consistent reads) to the current master.</p>
<p>MySQL Fabric has the concept of a HA group which is a pool of two or more MySQL Servers; at any point in time, one of those servers is the Primary (MySQL Replication master) and the others are Secondaries (MySQL Replication slaves). The role of a HA group is to ensure that access to the data held within that group is always available.</p>
<p><a href="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.34.25.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.34.25-300x285.png" alt="Example MySQL Fabric HA Group" width="300" height="285" class="alignright size-medium wp-image-3817" srcset="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.34.25-300x285.png 300w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.34.25.png 435w" sizes="auto, (max-width: 300px) 100vw, 300px"></a></p>
<p>While MySQL Replication allows the data to be made safe by duplicating it, for a HA solution two extra components are needed and MySQL Fabric provides these:</p>
<ul>
<li>
<strong>Failure detection and promotion</strong> &#8211; the MySQL Fabric process monitors the Primary within the HA group and should that server fail then it selects one of the Secondaries and promotes it to be the Primary (with all of the other slaves in the HA group then receiving updates from the new master). Note that the connectors can inform MySQL Fabric when they observe a problem with the Primary and the MySQL Fabric process uses that information as part of its decision making process surrounding the state of the servers in the farm.</li>
<li>
<strong>Routing of database requests</strong> &#8211; When MySQL Fabric promotes the new Primary, it updates the state store and notifies the connectors so that they can refresh their caches with the updated routing information. In this way, the application does not need to be aware that the topology has changed and that writes need to be sent to a different destination.</li>
</ul>
<h2>
<a name="worked-example" class="anchor" href="#worked-example"><span class="octicon octicon-link"></span></a>Worked Example</h2>
<p>The following steps set up the HA MySQL configuration shown here before running some (Python) code against it and then finally the killing the Primary (replication Master) and observing that one of the slaves is automatically promoted.</p>
<p>Note that this configuration isn&#8217;t really HA as all of the MySQL Servers in the HA Group are actually running on the same machine; this configuration has been chosen for this post to illustrate that you can experiment with MySQL Fabric using a small number of machines (in fact, the MySQL Fabric process and its state store (another MySQL Server) could have been run on that same machine). Later posts will use more machines to demonstrate more realistic deployment topologies.</p>
<h3>
<a name="building-the-ha-mysql-server-farm" class="anchor" href="#building-the-ha-mysql-server-farm"><span class="octicon octicon-link"></span></a>Building the HA MySQL Server Farm</h3>
<p>The machines being used already have MySQL 5.6 installed (though in a custom location) and so the only software pre-requisite is to install the MySQL connector for Python from the &#8220;Development Releases&#8221; tab from the <a href="http://dev.mysql.com/downloads/connector/python/" title="MySQL Connector/Python download page">connector download page</a> and MySQL Fabric (part of MySQL Utilities) from the &#8220;Development Releases&#8221; tab on the <a href="http://dev.mysql.com/downloads/tools/utilities/" title="MySQL Utilties - Including MySQL Fabric - download page">MySQL Utilties download page</a>:</p>
<pre>
[root@fab1 mysql ~]# rpm -i mysql-connector-python-1.2.0-1.el6.noarch.rpm
[root@fab1 mysql ~]# rpm -i mysql-utilities-1.4.1-1.el6.noarch.rpm
</pre>
<p>MySQL Fabric needs access to a MySQL Database to store state and routing information for the farm of servers; if there isn&#8217;t already a running MySQL Server instance that can be used for this then it&#8217;s simple to set one up:</p>
<pre>
[mysql@fab1 ~]$ mkdir myfab
[mysql@fab1 ~]$ cd myfab/
[mysql@fab1 myfab]$ mkdir data  
[mysql@fab1 myfab]$ cat my.cnf
[mysqld]
datadir=/home/mysql/myfab/data
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3306
report-host=fab1
report-port=3306
server-id=1
log-bin=fab-bin.log

[mysql@fab1 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --datadir=/home/mysql/myfab/data/ 

2014-02-12 16:55:45 1298 [Note] Binlog end
2014-02-12 16:55:45 1298 [Note] InnoDB: FTS optimize thread exiting.
2014-02-12 16:55:45 1298 [Note] InnoDB: Starting shutdown...
2014-02-12 16:55:46 1298 [Note] InnoDB: Shutdown completed; log sequence number 1600607
2014-02-12 16:55:46 1298 [Note] /home/mysql/mysql//bin/mysqld: Shutdown complete

[mysql@fab1 ~]$ mysqld --defaults-file=/home/mysql/myfab/my.cnf &amp;
</pre>
<p>MySQL Fabric needs to be able to access this state store and so a dedicated user is created (note that the <code>fabric</code> database hasn&#8217;t yet been created &#8211; that will be done soon using the <code>mysqlfabric</code> command):</p>
<pre>
[mysql@fab1 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON fabric.* \
    TO fabric@localhost";
</pre>
<p>All of the management requests that we make for MySQL Fabric will be issued via the <code>mysqlfabric</code> command. This command is documented in the <a href="http://dev.mysql.com/doc/mysql-utilities/1.4/en/fabric-util.html" title="MySQL Fabric - documentation for the mysqlfabric command">MySQL Fabric User Guide</a> but sub-commands can be viewed from the terminal using the <code>list-commands</code> option:</p>
<pre>
[mysql@fab1 /]$ mysqlfabric list-commands
group activate                   Activate a group.
group import_topology            Try to figure out the replication topology 
                                 and import it into the state store.
group deactivate                 Deactivate a group.
group create                     Create a group.
group remove                     Remove a server from a group.
group add                        Add a server into group.
group lookup_servers             Return information on existing server(s) in a 
                                 group.
group check_group_availability   Check if any server within a group has failed 
                                 and report health information.
group destroy                    Remove a group.
group demote                     Demote the current master if there is one.
group promote                    Promote a server into master.
group lookup_groups              Return information on existing group(s).
group description                Update group's description.
manage list-commands             List the possible commands.
manage help                      Give help on a command.
manage teardown                  Teardown Fabric Storage System.
manage stop                      Stop the Fabric server.
manage setup                     Setup Fabric Storage System.
manage ping                      Check whether Fabric server is running or not.
manage start                     Start the Fabric server.
manage logging_level             Set logging level.
server set_weight                Set a server's weight which determines the 
                                 likelihood of a server being chosen by a 
                                 connector to process transactions or by the 
                                 high availability service to replace a failed 
                                 master.
server lookup_uuid               Return server's uuid.
server set_mode                  Set a server's mode which determines whether 
                                 it can process read-only, read-write or both 
                                 transaction types.
server set_status                Set a server's status.
sharding move                    Move the shard represented by the shard_id to 
                                 the destination group.
sharding lookup_servers          Lookup a shard based on the give sharding key.
sharding disable_shard           Disable a shard.
sharding remove_mapping          Remove the shard mapping represented by the 
                                 Shard Mapping object.
sharding list_mappings           Returns all the shard mappings of a 
                                 particular sharding_type.
sharding add_mapping             Add a table to a shard mapping.
sharding add_shard               Add a shard.
sharding list_definitions        Lists all the shard mapping definitions.
sharding enable_shard            Enable a shard.
sharding remove_shard            Remove a Shard.
sharding prune_shard             Given the table name prune the tables 
                                 according to the defined sharding 
                                 specification for the table.
sharding lookup_mapping          Fetch the shard specification mapping for the 
                                 given table
sharding split                   Split the shard represented by the shard_id 
                                 into the destination group.
sharding define                  Define a shard mapping.
event trigger                    Trigger an event.
event wait_for_procedures        Wait until procedures, which are identified 
                                 through their uuid in a list and separated by
                                 comma, finish their execution.
store dump_shard_maps            Return information about all shard mappings 
                                 matching any of the provided patterns.
store dump_shard_index           Return information about the index for all 
                                 mappings matching any of the patterns 
                                 provided.
store dump_servers               Return information about all servers.
store dump_sharding_information  Return all the sharding information about the 
                                 tables passed as patterns.
store dump_shard_tables          Return information about all tables belonging 
                                 to mappings matching any of the provided 
                                 patterns.
store lookup_fabrics             Return a list of Fabric servers.
</pre>
<p>MySQL Fabric has its own configuration file (note that it&#8217;s location can vary depending on your platform and how MySQL Utilities were installed). The contents of this configuration file should be reviewed before starting the MySQL Fabric process (in this case, the <code>mysqldump_program</code> and <code>mysqldump_program</code> settings needed to be changed as MySQL was installed in a user&#8217;s directory):</p>
<pre>
[root@fab1 mysql]# cat /etc/mysql/fabric.cfg
[DEFAULT]
prefix =
sysconfdir = /etc/mysql
logdir = /var/log

[logging]
url = file:///var/log/fabric.log
level = INFO

[storage]
database = fabric
user = fabric
address = localhost:3306
connection_delay = 1
connection_timeout = 6
password =
connection_attempts = 6

[connector]
ttl = 1

[protocol.xmlrpc]
threads = 5
address = localhost:8080

[executor]
executors = 5

[sharding]
mysqldump_program = /home/mysql/mysql/bin/mysqldump
mysqlclient_program = /home/mysql/mysql/bin/mysql
</pre>
<p>The final step before starting the MySQL Fabric process is to create the MySQL Fabric schema within the state store:</p>
<pre>
[mysql@fab1 ~]$ mysqlfabric manage setup --param=storage.user=fabric
[INFO] 1392298030.100127 - MainThread - Initializing persister: \
    user (fabric), server (localhost:3306), database (fabric).
</pre>
<p>An optional step is then to check for yourself that the schema is indeed there:</p>
<pre>
[mysql@fab1 ~]$ mysql --protocol=tcp -u root
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 5
Server version: 5.6.16-log MySQL Community Server (GPL)

Copyright (c) 2000, 2014, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| fabric             |
| mysql              |
| performance_schema |
| test               |
+--------------------+
5 rows in set (0.00 sec)

mysql&gt; use fabric;show tables;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
+-------------------+
| Tables_in_fabric  |
+-------------------+
| checkpoints       |
| group_replication |
| groups            |
| servers           |
| shard_maps        |
| shard_ranges      |
| shard_tables      |
| shards            |
+-------------------+
8 rows in set (0.00 sec)
</pre>
<p>The MySQL Fabric process can now be started; in this case the process will run from the terminal from which it&#8217;s started but the <code>--daemonize</code> option can be used to make it run as a daemon.</p>
<pre>
[mysql@fab1 ~]$ mysqlfabric manage start
[INFO] 1392298245.888881 - MainThread - Fabric node starting.
[INFO] 1392298245.890465 - MainThread - Initializing persister: user (fabric), server (localhost:3306), database (fabric).
[INFO] 1392298245.890926 - MainThread - Loading Services.
[INFO] 1392298245.898459 - MainThread - Starting Executor.
[INFO] 1392298245.899056 - MainThread - Setting 5 executor(s).
[INFO] 1392298245.900439 - Executor-1 - Started.
[INFO] 1392298245.901856 - Executor-2 - Started.
[INFO] 1392298245.903146 - Executor-0 - Started.
[INFO] 1392298245.905488 - Executor-3 - Started.
[INFO] 1392298245.908283 - MainThread - Executor started.
[INFO] 1392298245.910308 - Executor-4 - Started.
[INFO] 1392298245.936954 - MainThread - Starting failure detector.
[INFO] 1392298245.938200 - XML-RPC-Server - XML-RPC protocol server \
    ('127.0.0.1', 8080) started.
[INFO] 1392298245.938614 - XML-RPC-Server - Setting 5 XML-RPC session(s).
[INFO] 1392298245.940895 - XML-RPC-Session-0 - Started XML-RPC-Session.
[INFO] 1392298245.942644 - XML-RPC-Session-1 - Started XML-RPC-Session.
[INFO] 1392298245.947016 - XML-RPC-Session-2 - Started XML-RPC-Session.
[INFO] 1392298245.949691 - XML-RPC-Session-3 - Started XML-RPC-Session.
[INFO] 1392298245.951678 - XML-RPC-Session-4 - Started XML-RPC-Session.
</pre>
<p>If the process had been run as a daemon then it&#8217;s useful to be able to check if it&#8217;s actually running:</p>
<pre>
[mysql@fab1 ~]$ mysqlfabric manage ping
Command :
{ success     = True
  return      = True
  activities  =
}
</pre>
<p>At this point, MySQL Fabric is up and running but it has no MySQL Servers to manage. As shown in the earlier diagram, three MySQL Servers will run on a single machine. Each of those MySQL Servers will need their own configuration settings to make sure that there are no resource conflicts &#8211; the steps are shown here but without any detailed commentary as this is standard MySQL stuff:</p>
<pre>
[mysql@fab2 myfab]$ cat my1a.cnf
[mysqld]
datadir=/home/mysql/myfab/data1a
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab1a.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3306
report-host=fab2
report-port=3306
server-id=11
log-bin=fab1a-bin.log

[mysql@fab2 myfab]$ cat my1b.cnf
[mysqld]
datadir=/home/mysql/myfab/data1b
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab1b.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3307
report-host=fab2
report-port=3307
server-id=12
log-bin=fab1b-bin.log

[mysql@fab2 myfab]$ cat my1c.cnf
[mysqld]
datadir=/home/mysql/myfab/data1c
basedir=/home/mysql/mysql
socket=/home/mysql/myfab/mysqlfab1c.socket
binlog-format=ROW
log-slave-updates=true
gtid-mode=on
enforce-gtid-consistency=true
master-info-repository=TABLE
relay-log-info-repository=TABLE
sync-master-info=1
port=3308
report-host=fab2
report-port=3308
server-id=13
log-bin=fab1c-bin.log

[mysql@fab2 myfab]$ mkdir data1a
[mysql@fab2 myfab]$ mkdir data1b
[mysql@fab2 myfab]$ mkdir data1c

[mysql@fab2 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my1a.cnf \
    --datadir=/home/mysql/myfab/data1a/
[mysql@fab2 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my1a.cnf \
    --datadir=/home/mysql/myfab/data1b/
[mysql@fab2 mysql]$ scripts/mysql_install_db --basedir=/home/mysql/mysql/ \
    --defaults-file=/home/mysql/myfab/my1a.cnf \
    --datadir=/home/mysql/myfab/data1c/

[mysql@fab2 ~]$ mysqld --defaults-file=/home/mysql/myfab/my1a.cnf &amp;
[mysql@fab2 ~]$ mysqld --defaults-file=/home/mysql/myfab/my1b.cnf &amp;
[mysql@fab2 ~]$ mysqld --defaults-file=/home/mysql/myfab/my1c.cnf &amp;

[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3306 -u root -e "GRANT ALL ON *.* \
    TO root@'%'""
[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3307 -u root -e "GRANT ALL ON *.* \
    TO root@'%'""
[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3308 -u root -e "GRANT ALL ON *.* \
    TO root@'%'""
</pre>
<p>Now that the MySQL Servers are configured and up and running it&#8217;s possible to create the new HA Group (<code>my_group</code> and add the three new MySQL Server instances to it):</p>
<pre>
[mysql@fab1 ~]$ mysqlfabric group create my_group
Procedure :
{ uuid        = 3dadcedf-a402-420d-8496-03cb5c17c1b3,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}

[mysql@fab1 ~]$ mysqlfabric group add my_group 192.168.56.102:3306 root ''
Procedure :
{ uuid        = 2d996228-2a05-490a-9f32-10bea383d72d,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group add my_group 192.168.56.102:3307 root ''
Procedure :
{ uuid        = 00bacfe8-ffc0-4c3c-bf06-d9f991ff2ba2,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
[mysql@fab1 ~]$ mysqlfabric group add my_group 192.168.56.102:3308 root ''
Procedure :
{ uuid        = 08b7bc0f-0224-4241-8efb-7d73fc50ad09,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
</pre>
<p>The <code>mysqlfabric</code> command can then be used to confirm that the HA group now contains the three servers <em>but</em> that they&#8217;re all still tagged as being Secondaries (in other words there is no MySQL Replication master):</p>
<pre>
[mysql@fab1 ~]$ mysqlfabric group lookup_servers my_group
Command :
{ success     = True
  return      = [['926546e1-94b9-11e3-8cab-08002795076a', \
    '192.168.56.102:3306', False, 'SECONDARY'], \
    ['9c08ecd6-94b9-11e3-8cab-08002795076a', \
        '192.168.56.102:3307', \
        False, 'SECONDARY'],\
    ['a4a963a1-94b9-11e3-8cac-08002795076a', \
        '192.168.56.102:3308', \
        False, 'SECONDARY']]
  activities  =
}

[mysql@fab1 ~]$ mysqlfabric group check_group_availability my_group
Command :
{ success     = True
  return      = {'926546e1-94b9-11e3-8cab-08002795076a': 
        {'is_master': False, 'status': 'SECONDARY', 'is_alive': True, \
        'threads': {'is_configured': False}},\
    'a4a963a1-94b9-11e3-8cac-08002795076a': \
        {'is_master': False, 'status': 'SECONDARY', \
        'is_alive': True, 'threads': {'is_configured': False}},\
    '9c08ecd6-94b9-11e3-8cab-08002795076a': \
        {'is_master': False, 'status': 'SECONDARY', \
        'is_alive': True, 'threads': {'is_configured': False}}}
  activities  =
}
</pre>
<p><code>mysqlfabric group promote</code> is used to promote one of the servers within the <code>my_group</code> HA group to be the Primary/master:</p>
<pre>
[mysql@fab1 ~]$ mysqlfabric group promote my_group
Procedure :
{ uuid        = 8c1d888e-8120-4be3-8ff6-1e9a810179fd,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
</pre>
<p>Note that it would have been possible to include the <code>uuid</code> of the specific MySQL Server that should be promoted but as none was specified, the best way to know which was selected is to query the state information:</p>
<pre>
[mysql@fab1 ~]$ mysqlfabric group lookup_servers my_group
Command :
{ success     = True
  return      = [['926546e1-94b9-11e3-8cab-08002795076a', \
        '192.168.56.102:3306', True, 'PRIMARY'],\
    ['9c08ecd6-94b9-11e3-8cab-08002795076a', '192.168.56.102:3307', \
        False, 'SECONDARY'],\
    ['a4a963a1-94b9-11e3-8cac-08002795076a', '192.168.56.102:3308', \
        False, 'SECONDARY']]
  activities  =
}
</pre>
<p>As an extra step, we can confirm that one of the other servers is indeed acting as a replication slave to the master:</p>
<pre>
[mysql@fab1 ~]$ mysql -h 192.168.56.102 -P3307 -u root -e "SHOW SLAVE STATUS\G"
*************************** 1. row ***************************
               Slave_IO_State: Waiting for master to send event
                  Master_Host: 192.168.56.102
                  Master_User: root
                  Master_Port: 3306
                Connect_Retry: 60
              Master_Log_File: fab1a-bin.000003
          Read_Master_Log_Pos: 314
               Relay_Log_File: fab2-relay-bin.000002
                Relay_Log_Pos: 524
        Relay_Master_Log_File: fab1a-bin.000003
             Slave_IO_Running: Yes
            Slave_SQL_Running: Yes
              Replicate_Do_DB:
          Replicate_Ignore_DB:
           Replicate_Do_Table:
       Replicate_Ignore_Table:
      Replicate_Wild_Do_Table:
  Replicate_Wild_Ignore_Table:
                   Last_Errno: 0
                   Last_Error:
                 Skip_Counter: 0
          Exec_Master_Log_Pos: 314
              Relay_Log_Space: 727
              Until_Condition: None
               Until_Log_File:
                Until_Log_Pos: 0
           Master_SSL_Allowed: No
           Master_SSL_CA_File:
           Master_SSL_CA_Path:
              Master_SSL_Cert:
            Master_SSL_Cipher:
               Master_SSL_Key:
        Seconds_Behind_Master: 0
Master_SSL_Verify_Server_Cert: No
                Last_IO_Errno: 0
                Last_IO_Error:
               Last_SQL_Errno: 0
               Last_SQL_Error:
  Replicate_Ignore_Server_Ids:
             Master_Server_Id: 11
                  Master_UUID: 926546e1-94b9-11e3-8cab-08002795076a
             Master_Info_File: mysql.slave_master_info
                    SQL_Delay: 0
          SQL_Remaining_Delay: NULL
      Slave_SQL_Running_State: Slave has read all relay log; waiting for the slave I/O thread to update it
           Master_Retry_Count: 86400
                  Master_Bind:
      Last_IO_Error_Timestamp:
     Last_SQL_Error_Timestamp:
               Master_SSL_Crl:
           Master_SSL_Crlpath:
           Retrieved_Gtid_Set: 926546e1-94b9-11e3-8cab-08002795076a:1
            Executed_Gtid_Set: 926546e1-94b9-11e3-8cab-08002795076a:1,
9c08ecd6-94b9-11e3-8cab-08002795076a:1
                Auto_Position: 1
1 row in set (0.01 sec)
</pre>
<p>The final step in configuring the HA system is to have MySQL Fabric start monitoring the servers so that it can promote a new Primary (and send new routing information to the connectors) in the event that the current Primary should fail:</p>
<pre>
[mysql@fab1 ~]$ mysqlfabric group activate my_group
Procedure :
{ uuid        = 2fea76ce-bc6a-4cd3-84ed-fbe3b75128a9,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}
</pre>
<h3>
<a name="example-application-code" class="anchor" href="#example-application-code"><span class="octicon octicon-link"></span></a>Example Application Code</h3>
<p>Now it&#8217;s the turn of the application developer to start using the new HA database server. Note that while they must make some minor changes to work with the HA group, they don&#8217;t need to care about what servers are part of the group or which of them is currently the Primary &#8211; this is all handled transparently by MySQL Fabric and the Fabric-aware connectors.</p>
<p>The first piece of example code will create the <code>subscribers</code> table within the <code>test</code> database and add a single subscriber record. Most of this is fairly standard and so only the MySQL Fabric-specific pieces will be commented on:</p>
<ul>
<li>The <code>fabric</code> module from <code>mysql.com</code> is included</li>
<li>The application connects to MySQL Fabric rather than any of the MySQL Servers (<code>{"host" : "localhost", "port" : 8080}</code>)</li>
<li>The <code>mode</code> property for the connection is set to <code>fabric.MODE_READWRITE</code> &#8211; in that way the operations are sent to the Primary server by the connector so that the changes will be replicated to all servers in the HA group.</li>
</ul>
<pre>
[mysql@fab1 myfab]$ cat setup_table.py
import mysql.connector
from mysql.connector import fabric

def add_subscriber(conn, sub_no, first_name, last_name):
    conn.set_property(group="my_group", mode=fabric.MODE_READWRITE)
    cur = conn.cursor()
    cur.execute(
        "REPLACE INTO subscribers VALUES (%s, %s, %s)",
        (sub_no, first_name, last_name)
        )

conn = mysql.connector.connect(
    fabric={"host" : "localhost", "port" : 8080},
    user="root", database="test", password="",
    autocommit=True
    )

conn.set_property(group="my_group", mode=fabric.MODE_READWRITE)
cur = conn.cursor()
cur.execute(
    "CREATE TABLE IF NOT EXISTS subscribers ("
    "   sub_no INT, "
    "   first_name CHAR(40), "
    "   last_name CHAR(40)"
    ")"
    )

cur.execute(
    "DELETE FROM subscribers"
    )

add_subscriber(conn, 72, "Billy", "Fish")
</pre>
<p>This code can then be run:</p>
<pre>
[mysql@fab1 myfab]$ python setup_table.py
</pre>
<p>To check that everything has worked as expected, one of the slave servers can be checked to confirm that the table and data is there:</p>
<pre>
[mysql@fab2 ~]$ mysql -h 127.0.0.1 -P3308 -u root -e 'SELECT * \
    FROM test.subscribers'
+--------+------------+-----------+
| sub_no | first_name | last_name |
+--------+------------+-----------+
|     72 | Billy      | Fish      |
+--------+------------+-----------+
</pre>
<p>The next piece of code can then be run to read the record back. The main thing to note in this sample is the connection&#8217;s <code>mode</code> property is set to <code>fabric.MODE_READONLY</code> which means that the connector is free to send the query to one of the slaves (optionally, you can configure MySQL Fabric to include the master in the connector&#8217;s round-robin algorithm).</p>
<pre>
[mysql@fab1 myfab]$ cat read_table.py
import mysql.connector
from mysql.connector import fabric

def find_subscriber(conn, sub_no):
    conn.set_property(group="my_group", mode=fabric.MODE_READONLY)
    cur = conn.cursor()
    cur.execute(
        "SELECT first_name, last_name FROM subscribers "
        "WHERE sub_no = %s", (sub_no, )
        )
    for row in cur:
        print row

conn = mysql.connector.connect(
    fabric={"host" : "localhost", "port" : 8080},
    user="root", database="test", password="",
    autocommit=True
    )

find_subscriber(conn, 72)
</pre>
<p>This script can then be executed to retrieve the data:</p>
<pre>
[mysql@fab1 myfab]$ python read_table.py
(u'Billy', u'Fish')
</pre>
<h3>
<a name="testing-automatic-failover" class="anchor" href="#testing-automatic-failover"><span class="octicon octicon-link"></span></a>Testing Automatic Failover</h3>
<p>The final stage is to check that things work as planned when the Primary server stops; in other words:</p>
<ul>
<li>MySQL Fabric will make one of the slaves be the new master</li>
<li>MySQL Fabric will update the state/routing data to reflect the new Primary server</li>
<li>The Fabric-aware connector is informed of the change, updates its cache and routes to the correct Primary</li>
</ul>
<p>Before stopping a MySQL Server, we can confirm which one is currently the Primary before shutting it down:</p>
<pre>
[mysql@fab1 myfab]$ mysqlfabric group lookup_servers my_group
Command :
{ success     = True
  return      = [['926546e1-94b9-11e3-8cab-08002795076a', \
    '192.168.56.102:3306', True, 'PRIMARY'],\
  ['9c08ecd6-94b9-11e3-8cab-08002795076a', '192.168.56.102:3307', \
    False, 'SECONDARY'],\
  ['a4a963a1-94b9-11e3-8cac-08002795076a', '192.168.56.102:3308', \
    False, 'SECONDARY']]
  activities  =
}

[mysql@fab2 ~]$ mysqladmin -h 127.0.0.1 -P3306 -u root shutdown
</pre>
<p>The <code>mysqlfabric</code> command can then be used to confirm the state change (promotion of a new Primary server):</p>
<pre>
[mysql@fab1 myfab]$ mysqlfabric group lookup_servers my_group
Command :
{ success     = True
  return      = [['926546e1-94b9-11e3-8cab-08002795076a', \
        '192.168.56.102:3306', False, 'FAULTY'],\
    ['9c08ecd6-94b9-11e3-8cab-08002795076a', \
        '192.168.56.102:3307', True, 'PRIMARY'],\
    ['a4a963a1-94b9-11e3-8cac-08002795076a', \
        '192.168.56.102:3308', False, 'SECONDARY']]
  activities  =
}
</pre>
<p>The following code reads the data but because it sets the <code>mode</code> property to <code>fabric.MODE_READWRITE</code> the connector will send the query to the Primary (this is how you can ensure that reads are not accessing stale data from a slave):</p>
<pre>
[mysql@fab1 myfab]$ cat read_table2.py
import mysql.connector
from mysql.connector import fabric

def find_subscriber(conn, sub_no):
    conn.set_property(group="my_group", mode=fabric.MODE_READWRITE)
    cur = conn.cursor()
    cur.execute(
        "SELECT first_name, last_name FROM subscribers "
        "WHERE sub_no = %s", (sub_no, )
        )
    for row in cur:
        print row
conn = mysql.connector.connect(
    fabric={"host" : "localhost", "port" : 8080},
    user="root", database="test", password="",
    autocommit=True
    )

find_subscriber(conn, 72)
</pre>
<pre>
[mysql@fab1 myfab]$ python read_table.py
(u'Billy', u'Fish')
</pre>
<p>Typically, the failed MySQL Server would be recovered and then it makes sense to add it back into the HA group:</p>
<pre>
[mysql@fab2 ~]$ mysqld --defaults-file=myfab/my1a.cnf&amp;

[mysql@fab1 myfab]$ mysqlfabric server set_status \
    926546e1-94b9-11e3-8cab-08002795076a SPARE my_group
Procedure :
{ uuid        = 2b6e9a93-6f1f-4ed4-944b-21ddd41df337,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}

[mysql@fab1 myfab]$ mysqlfabric server set_status \
    926546e1-94b9-11e3-8cab-08002795076a SECONDARY my_group
Procedure :
{ uuid        = 2e7aa916-f099-42f0-b79b-f0d25cadb3f3,
  finished    = True,
  success     = True,
  return      = True,
  activities  =
}

[mysql@fab1 myfab]$ mysqlfabric group check_group_availability my_group
Command :
{ success     = True
  return      = {'926546e1-94b9-11e3-8cab-08002795076a': {'is_master': False,\
    'status': 'SECONDARY', 'is_alive': True, 'threads': {}},\
  'a4a963a1-94b9-11e3-8cac-08002795076a': {'is_master': False, \
    'status': 'SECONDARY', 'is_alive': True, 'threads': {}},\
  '9c08ecd6-94b9-11e3-8cab-08002795076a': {'is_master': True, \
    'status': 'PRIMARY', 'is_alive': True, 'threads': {}}}
  activities  =
}
</pre>
<h2>
<a name="mysql-fabric-architecture--extensibility" class="anchor" href="#mysql-fabric-architecture--extensibility"><span class="octicon octicon-link"></span></a>MySQL Fabric Architecture &amp; Extensibility</h2>
<p>MySQL Fabric has been architected for extensibility at a number of levels. For example, in the first release the only option for implementing HA is based on MySQL Replication but in future releases we hope to add further options (for example, MySQL Cluster). We also hope to see completely new applications around the managing of farms of MySQL Servers &#8211; both from Oracle and the wider MySQL community.</p>
<p>The following diagram illustrates how new applications and protocols can be added using the pluggable framework.</p>
<p><a href="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03-1024x501.png" alt="MySQL Fabric - Extensible Architecture" width="480" height="234" class="aligncenter size-large wp-image-3818" srcset="/wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03-1024x501.png 1024w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03-300x146.png 300w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03-900x440.png 900w, /wp-content/uploads/2014/03/Screen-Shot-2014-03-18-at-15.37.03.png 1254w" sizes="auto, (max-width: 480px) 100vw, 480px"></a></p>
<h2>
<a name="next-steps" class="anchor" href="#next-steps"><span class="octicon octicon-link"></span></a>Next Steps</h2>
<p>We really hope that people try out MySQL Fabric and let us know how you get on; one way is to comment on this post, another is to post to the <a href="http://forums.mysql.com/list.php?144" title="MySQL Forums :: Fabric, Sharding, HA, Utilities">MySQL Fabric forum</a> or if you think you&#8217;ve found a bug then <a href="http://bugs.mysql.com/" title="MySQL bugs database">raise a bug report</a>.</p>
					<div class="clear"></div>
									</div>
		<br>
		<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
   		<a href="http://twitter.com/share" class="twitter-share-button" data-url="/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql" data-via="wpbeginner" data-text="MySQL Fabric &#8211; adding High Availability to MySQL" data-related="syedbalkhi:Founder of WPBeginner" data-count="horizontal">Tweet</a>
		<br>
		<!-- <g:plusone size="medium" href="/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql"></g:plusone> -->
		<div class="g-plusone" data-annotation="inline" data-width="300"></div>
		<!-- Place this tag after the last +1 button tag. -->
		<script type="text/javascript">(function() {
    				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    				po.src = 'https://apis.google.com/js/plusone.js';
    				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  			})();</script>
		<br>
		<script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><script type="in/share" data-url="/mysql-fabric/mysql-fabric-adding-high-availability-to-mysql" data-counter="right"></script>
		<br>
		<iframe src="http://www.facebook.com/plugins/like.php?href=%2Fmysql-fabric%2Fmysql-fabric-adding-high-availability-to-mysql&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:60px;">
		</iframe>

<!-- ZXZX -->
				<div class="postinfo">Category: <a href="/category/mysql-fabric" rel="category tag">MySQL Fabric</a> | 
Tags: <a href="/tag/ha" rel="tag">HA</a>, <a href="/tag/high-availability" rel="tag">High Availability</a>, <a href="/tag/mysql" rel="tag">MySQL</a>, <a href="/tag/mysql-fabric-2" rel="tag">mysql fabric</a></div>

			</div>			<div id="post-3805" class="post-3805 post type-post status-publish format-standard hentry category-mysql-replication tag-ha tag-high-availability tag-mysql tag-mysql-replication tag-replication">
				
				<div class="postmeta">	<div class="postmeta_links">
		<a href="/author/andrew" title="Posts by andrew" rel="author">andrew</a> |
		<a href="/mysql-replication/advanced-mysql-replication-architectures-and-latest-developments-free-webinar-2">March 18, 2014</a>
			</div>
	<div class="postcomments">
		<a href="/mysql-replication/advanced-mysql-replication-architectures-and-latest-developments-free-webinar-2#respond">No comments</a>	</div>
	<div class="clear"></div>
</div>

				<h2 class="post-title"><a href="/mysql-replication/advanced-mysql-replication-architectures-and-latest-developments-free-webinar-2" rel="bookmark">Advanced MySQL Replication Architectures and Latest Developments &#8211; free webinar</a></h2>
				
				<div class="entry">
										<p><a href="/wp-content/uploads/2014/03/MySQL_Replication.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2014/03/MySQL_Replication-300x101.png" alt="MySQL Replication Logo" width="300" height="101" class="alignright size-medium wp-image-3803" srcset="/wp-content/uploads/2014/03/MySQL_Replication-300x101.png 300w, /wp-content/uploads/2014/03/MySQL_Replication-1024x347.png 1024w, /wp-content/uploads/2014/03/MySQL_Replication-900x305.png 900w, /wp-content/uploads/2014/03/MySQL_Replication.png 1240w" sizes="auto, (max-width: 300px) 100vw, 300px"></a><br>
This Thursday (20th March 2014) we&#8217;ll be hosted a free webinar covering advanced MySQL Replication topics as well as the latest developments. As always, the webinar is free but you need to <a href="http://www.mysql.com/news-and-events/web-seminars/advanced-mysql-replication-architectures-and-latest-developments/" title="Advanced MySQL Replication Architectures and Latest Developments - free webinar" target="_blank">register here</a> &#8211; even if you can&#8217;t join live, you&#8217;ll then be sent a link to the replay.</p>
<p>More details on what to expect&#8230;</p>
<p>The biggest Web sites in the world rely on MySQL Replication to scale-out and provide High Availability for their data. Extend your knowledge of how MySQL Replication works and what you can achieve with it; join us for this technical webinar to explore some of the more advanced replication architectures as well as some of the latest product developments:</p>
<ul>
<li>Replication topologies, including master-slave, circular and multi-master</li>
<li>Load balancing and query splitting</li>
<li>Data aggregation with multi-source replication</li>
<li>Global Transaction IDs and auto-failover with recovery</li>
<li>Getting the best replication throughput</li>
<li>Heterogeneous replication with the Binlog API</li>
</ul>
<p>WHO:</p>
<ul>
<li>Andrew Morgan, Principal MySQL Product Manager</li>
<li>Lars Thalmann, Director, MySQL Replication, Backup and Connectors</li>
</ul>
<p>WHEN:</p>
<ul>
<li>Thu, Mar 20: 09:00 Pacific time (America)</li>
<li>Thu, Mar 20: 10:00 Mountain time (America)</li>
<li>Thu, Mar 20: 11:00 Central time (America)</li>
<li>Thu, Mar 20: 12:00 Eastern time (America)</li>
<li>Thu, Mar 20: 13:00 S√£o Paulo time</li>
<li>Thu, Mar 20: 16:00 UTC</li>
<li>Thu, Mar 20: 16:00 Western European time</li>
<li>Thu, Mar 20: 17:00 Central European time</li>
<li>Thu, Mar 20: 18:00 Eastern European time</li>
<li>Thu, Mar 20: 21:30 India, Sri Lanka</li>
<li>Fri, Mar 21: 00:00 Singapore/Malaysia/Philippines time</li>
<li>Fri, Mar 21: 00:00 China time</li>
<li>Fri, Mar 21: 01:00 Êó•Êú¨</li>
<li>Fri, Mar 21: 03:00 NSW, ACT, Victoria, Tasmania (Australia)</li>
</ul>
					<div class="clear"></div>
									</div>
		<br>
		<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
   		<a href="http://twitter.com/share" class="twitter-share-button" data-url="/mysql-replication/advanced-mysql-replication-architectures-and-latest-developments-free-webinar-2" data-via="wpbeginner" data-text="Advanced MySQL Replication Architectures and Latest Developments &#8211; free webinar" data-related="syedbalkhi:Founder of WPBeginner" data-count="horizontal">Tweet</a>
		<br>
		<!-- <g:plusone size="medium" href="/mysql-replication/advanced-mysql-replication-architectures-and-latest-developments-free-webinar-2"></g:plusone> -->
		<div class="g-plusone" data-annotation="inline" data-width="300"></div>
		<!-- Place this tag after the last +1 button tag. -->
		<script type="text/javascript">(function() {
    				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    				po.src = 'https://apis.google.com/js/plusone.js';
    				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  			})();</script>
		<br>
		<script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><script type="in/share" data-url="/mysql-replication/advanced-mysql-replication-architectures-and-latest-developments-free-webinar-2" data-counter="right"></script>
		<br>
		<iframe src="http://www.facebook.com/plugins/like.php?href=%2Fmysql-replication%2Fadvanced-mysql-replication-architectures-and-latest-developments-free-webinar-2&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:60px;">
		</iframe>

<!-- ZXZX -->
				<div class="postinfo">Category: <a href="/category/mysql-replication" rel="category tag">MySQL Replication</a> | 
Tags: <a href="/tag/ha" rel="tag">HA</a>, <a href="/tag/high-availability" rel="tag">High Availability</a>, <a href="/tag/mysql" rel="tag">MySQL</a>, <a href="/tag/mysql-replication" rel="tag">MySQL Replication</a>, <a href="/tag/replication" rel="tag">Replication</a></div>

			</div>			<div id="post-3539" class="post-3539 post type-post status-publish format-standard hentry category-mysql-cluster tag-management tag-mcm tag-mysql tag-mysql-cluster-manager">
				
				<div class="postmeta">	<div class="postmeta_links">
		<a href="/author/andrew" title="Posts by andrew" rel="author">andrew</a> |
		<a href="/mysql-cluster/mysql-cluster-management-webinar-replay-available">February 10, 2014</a>
			</div>
	<div class="postcomments">
		<a href="/mysql-cluster/mysql-cluster-management-webinar-replay-available#respond">No comments</a>	</div>
	<div class="clear"></div>
</div>

				<h2 class="post-title"><a href="/mysql-cluster/mysql-cluster-management-webinar-replay-available" rel="bookmark">MySQL cluster management &#8211; webinar replay available</a></h2>
				
				<div class="entry">
										<p><a href="/wp-content/uploads/2014/01/Migrating-from-MySQL-Cluster-Auto-Installer-to-MCM.png"><img loading="lazy" decoding="async" src="/wp-content/uploads/2014/01/Migrating-from-MySQL-Cluster-Auto-Installer-to-MCM-197x300.png" alt="Migrating from MySQL Cluster Auto-Installer to MCM" width="197" height="300" class="alignright size-medium wp-image-3329" srcset="/wp-content/uploads/2014/01/Migrating-from-MySQL-Cluster-Auto-Installer-to-MCM-197x300.png 197w, /wp-content/uploads/2014/01/Migrating-from-MySQL-Cluster-Auto-Installer-to-MCM.png 317w" sizes="auto, (max-width: 197px) 100vw, 197px"></a><br>
Thomas Nielsen and I recently presented a webinar explaining the latest developments in managing MySQL Cluster. In case you weren&#8217;t able to attend (or wanted to refresh your memory) then the <a href="https://event.on24.com/eventRegistration/EventLobbyServlet?target=registration.jsp&#038;eventid=736173&#038;sessionid=1&#038;key=B9B7A14C3D7C094A249F40C919F2ACE4&#038;sourcepage=register" title="MySQL Cluster Manager webinar replay" target="blank">webinar replay and charts</a> are now available.</p>
<p><strong>As a reminder, this webinar covered what&#8217;s new in MySQL Cluster Manager 1.3 which recently went GA.</strong></p>
<p>By their very nature, clustered environments involve more efforts and resources to administer than standalone systems and this holds true for MySQL Cluster, the database designed for web-scale throughput with carrier-grade availability.</p>
<p>The MySQL Cluster Auto-Installer guides you through defining and running a well configured MySQL Cluster database &#8211; combining auto-discovery of platform resources with built-in best practices in an intuitive web-based GUI.</p>
<p>MySQL Cluster Manager (available as part of the commercial MySQL Cluster Carrier Grade Edition) simplifies the ongoing management of MySQL Cluster by automating common management tasks, delivering higher administration productivity and enhancing cluster agility. Tasks that used to take 46 commands can be reduced to just one! These tasks include configuration, starting &#038; stopping the cluster, upgrades and backup/restore <strong>and new for MCM 1.3, import a running Cluster</strong>.</p>
<p>These webinars are always a good opportunity to get your questions answered; here&#8217;s a catch up of the Q&#038;A from this session:</p>
<ul>
<li><strong>One of the biggest problems I am faced with is that many common applications heavily rely on the InnoDB or MyISAM &#8211; storage engines.So I am concerned about different behaviors of them compared to the NDB.</strong>This is something that we&#8217;ve been working to address &#8211; for example, JOINs in MySQL are now a <strong>lot</strong> faster and MySQL Cluster now supports Foreign Keys.</li>
<li><strong>What about transaction &#8211; Handling, Locking mechanisms, or even changes in supported statements which are related to instance &#8211; managment rather then being part of DDL, DML, or DQL?</strong> Yes, MySQL Cluster (NDB) is slightly different in these respects, mostly due to its real-time heritage and distributed nature.</li>
<li><strong>Is the MySQL &#8211; Cluster auto-installer restricted to specific operating system distributions or versions?</strong> No, the auto-installer works on all <a href="http://www.mysql.com/support/supportedplatforms/cluster.html" title="platforms supported by MySQL Cluster" target="blank">platforms supported by MySQL Cluster</a></li>
<li><strong> I hope there will be a white paper about the differences as this is the major reason why I am not changing to NDB right now after I changed from many &#8211; databases-in-one-instance to a one-database-per-instance approeach.</strong> There are a couple of resources available today: <a href="http://dev.mysql.com/doc/refman/5.6/en/mysql-cluster-ndb-innodb-engines.html" title="Reference Manual comparing InnoDB and MySQL Cluster" target="blank">Reference Manual comparing InnoDB and MySQL Cluster</a> and the <a href="http://www.mysql.com/why-mysql/white-papers/mysql-cluster-evaluation-guide/" title="MySQL Cluster Evaluation Guide" target="blank">MySQL Cluster Evaluation Guide</a></li>
<li><strong>In the creation of the site in MySQL Cluster Manager can hosts be specified using the IPv6 addresses or it&#8217;s IPv4-based only?</strong> At the moment, MCM only supports IPv4 addresses.</li>
<li><strong>Are performance criteria for the restoring of nodes in a cluster available?</strong> I&#8217;m not aware of performance benchmarks for a database restore but they&#8217;re fairly fast as they happen at the data node level (and so for example there&#8217;s no need to go through SQL). You can also <a href="http://dev.mysql.com/doc/refman/5.6/en/mysql-cluster-programs-ndb-restore.html#option_ndb_restore_parallelism" title="configure high degrees of parallelism for the restore of MySQL Cluster databases using the --parallelism option with MySQL Cluster" target="blank">configure high degrees of parallelism for the restore</a> so that many records are restored at once.</li>
</ul>
					<div class="clear"></div>
									</div>
		<br>
		<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
   		<a href="http://twitter.com/share" class="twitter-share-button" data-url="/mysql-cluster/mysql-cluster-management-webinar-replay-available" data-via="wpbeginner" data-text="MySQL cluster management &#8211; webinar replay available" data-related="syedbalkhi:Founder of WPBeginner" data-count="horizontal">Tweet</a>
		<br>
		<!-- <g:plusone size="medium" href="/mysql-cluster/mysql-cluster-management-webinar-replay-available"></g:plusone> -->
		<div class="g-plusone" data-annotation="inline" data-width="300"></div>
		<!-- Place this tag after the last +1 button tag. -->
		<script type="text/javascript">(function() {
    				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    				po.src = 'https://apis.google.com/js/plusone.js';
    				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  			})();</script>
		<br>
		<script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><script type="in/share" data-url="/mysql-cluster/mysql-cluster-management-webinar-replay-available" data-counter="right"></script>
		<br>
		<iframe src="http://www.facebook.com/plugins/like.php?href=%2Fmysql-cluster%2Fmysql-cluster-management-webinar-replay-available&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:60px;">
		</iframe>

<!-- ZXZX -->
				<div class="postinfo">Category: <a href="/category/mysql-cluster" rel="category tag">MySQL Cluster</a> | 
Tags: <a href="/tag/management" rel="tag">management</a>, <a href="/tag/mcm" rel="tag">MCM</a>, <a href="/tag/mysql" rel="tag">MySQL</a>, <a href="/tag/mysql-cluster-manager" rel="tag">MySQL Cluster Manager</a></div>

			</div>      
							<div class="more_posts">
					<span class="post_links"><a href="/tag/mysql/page/5">&laquo; Older Entries</a> &nbsp; <a href="/tag/mysql/page/3">Recent Entries &raquo;</a></span>
				</div>
						

					
	</div>
		
		
<div id="sidebar">
	<ul>

<li id="search-2" class="widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s">
					<input type="submit" id="searchsubmit" value="Search">
				</div>
			</form></li>

		<li id="recent-posts-2" class="widget widget_recent_entries">
		<h2 class="widgettitle">Recent Posts</h2>

		<ul>
											<li>
					<a href="/mongodb/building-a-collaborative-ios-minesweeper-game-with-realm">Building a collaborative iOS Minesweeper game with Realm</a>
									</li>
											<li>
					<a href="/mongodb/using-realm-flexible-sync-in-your-app-an-ios-tutorial">Using Realm Flexible Sync in Your App‚Äîan iOS Tutorial</a>
									</li>
											<li>
					<a href="/mongodb/realm-swift-type-projections">Realm-Swift Type Projections</a>
									</li>
											<li>
					<a href="/mongodb/introducing-flexible-sync-preview-the-next-iteration-of-realm-sync">Introducing Flexible Sync (Preview) ‚Äì The Next Iteration of Realm Sync</a>
									</li>
											<li>
					<a href="/mongodb/goodbye-nspredicate-hello-realm-swift-query-api">Goodbye NSPredicate, hello Realm Swift Query API</a>
									</li>
					</ul>

		</li>
<li id="text-2" class="widget widget_text">			<div class="textwidget"><script type="text/javascript"><!--
google_ad_client = "ca-pub-5257306915232759";
/* Clusterdb-home */
google_ad_slot = "1624229680";
google_ad_width = 200;
google_ad_height =600;
//--></script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script></div>
		</li>
<li id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widgettitle">Recent Comments</h2>
<ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href="http://mikael.ronstrom@blogspot.com/" class="url" rel="ugc external nofollow">Mikael Ronstr√∂m</a></span> on <a href="/mysql-cluster/mysql-cluster-running-on-raspberry-pi#comment-787242">MySQL Cluster running on Raspberry Pi</a></li><li class="recentcomments"><span class="comment-author-link">andrew</span> on <a href="/mysql-cluster/setting-up-mysql-asynchronous-replication-for-high-availability#comment-668717">Setting up MySQL Asynchronous Replication for High Availability</a></li><li class="recentcomments"><span class="comment-author-link"><a href="http://www.suksesonline.com/" class="url" rel="ugc external nofollow">Betty</a></span> on <a href="/mysql-cluster/setting-up-mysql-asynchronous-replication-for-high-availability#comment-668713">Setting up MySQL Asynchronous Replication for High Availability</a></li><li class="recentcomments"><span class="comment-author-link">Sai Krishnan</span> on <a href="/mysql-cluster/get-mysql-replication-up-and-running-in-5-minutes#comment-661143">Get MySQL Replication up and running in 5 minutes</a></li><li class="recentcomments"><span class="comment-author-link">Nayan</span> on <a href="/mysql-cluster/get-mysql-replication-up-and-running-in-5-minutes#comment-660628">Get MySQL Replication up and running in 5 minutes</a></li></ul></li>
<li id="categories-2" class="widget widget_categories"><h2 class="widgettitle">Categories</h2>

			<ul>
					<li class="cat-item cat-item-2"><a href="/category/me">Me</a>
</li>
	<li class="cat-item cat-item-146"><a href="/category/mongodb">MongoDB</a>
</li>
	<li class="cat-item cat-item-3"><a href="/category/mysql">MySQL</a>
</li>
	<li class="cat-item cat-item-4"><a href="/category/mysql-cluster">MySQL Cluster</a>
</li>
	<li class="cat-item cat-item-131"><a href="/category/mysql-fabric">MySQL Fabric</a>
</li>
	<li class="cat-item cat-item-5"><a href="/category/mysql-replication">MySQL Replication</a>
</li>
	<li class="cat-item cat-item-214"><a href="/category/mongodb/realm">Realm</a>
</li>
	<li class="cat-item cat-item-1"><a href="/category/uncategorized">Uncategorized</a>
</li>
			</ul>

			</li>
<li id="tag_cloud-2" class="widget widget_tag_cloud"><h2 class="widgettitle">Tags</h2>
<div class="tagcloud"><a href="/tag/7-4" class="tag-cloud-link tag-link-137 tag-link-position-1" style="font-size: 9.0632911392405pt;" aria-label="7.4 (7 items)">7.4</a>
<a href="/tag/apache-kafka" class="tag-cloud-link tag-link-169 tag-link-position-2" style="font-size: 8.620253164557pt;" aria-label="Apache Kafka (6 items)">Apache Kafka</a>
<a href="/tag/cluster" class="tag-cloud-link tag-link-18 tag-link-position-3" style="font-size: 8.620253164557pt;" aria-label="Cluster (6 items)">Cluster</a>
<a href="/tag/ha" class="tag-cloud-link tag-link-41 tag-link-position-4" style="font-size: 15.354430379747pt;" aria-label="HA (40 items)">HA</a>
<a href="/tag/high-availability" class="tag-cloud-link tag-link-43 tag-link-position-5" style="font-size: 15.26582278481pt;" aria-label="High Availability (39 items)">High Availability</a>
<a href="/tag/ios" class="tag-cloud-link tag-link-215 tag-link-position-6" style="font-size: 10.658227848101pt;" aria-label="ios (11 items)">ios</a>
<a href="/tag/java" class="tag-cloud-link tag-link-47 tag-link-position-7" style="font-size: 8.620253164557pt;" aria-label="Java (6 items)">Java</a>
<a href="/tag/javascript" class="tag-cloud-link tag-link-48 tag-link-position-8" style="font-size: 10.303797468354pt;" aria-label="javascript (10 items)">javascript</a>
<a href="/tag/mcm" class="tag-cloud-link tag-link-56 tag-link-position-9" style="font-size: 8pt;" aria-label="MCM (5 items)">MCM</a>
<a href="/tag/mean" class="tag-cloud-link tag-link-186 tag-link-position-10" style="font-size: 8pt;" aria-label="MEAN (5 items)">MEAN</a>
<a href="/tag/memcached" class="tag-cloud-link tag-link-57 tag-link-position-11" style="font-size: 8pt;" aria-label="Memcached (5 items)">Memcached</a>
<a href="/tag/mobile" class="tag-cloud-link tag-link-211 tag-link-position-12" style="font-size: 8pt;" aria-label="mobile (5 items)">mobile</a>
<a href="/tag/mongodb" class="tag-cloud-link tag-link-150 tag-link-position-13" style="font-size: 16.417721518987pt;" aria-label="mongodb (53 items)">mongodb</a>
<a href="/tag/mongodb-3-2" class="tag-cloud-link tag-link-153 tag-link-position-14" style="font-size: 8pt;" aria-label="MongoDB 3.2 (5 items)">MongoDB 3.2</a>
<a href="/tag/mongodb-atlas" class="tag-cloud-link tag-link-163 tag-link-position-15" style="font-size: 9.0632911392405pt;" aria-label="MongoDB Atlas (7 items)">MongoDB Atlas</a>
<a href="/tag/mongodb-mobile" class="tag-cloud-link tag-link-212 tag-link-position-16" style="font-size: 8pt;" aria-label="MongoDB Mobile (5 items)">MongoDB Mobile</a>
<a href="/tag/mongodb-stitch" class="tag-cloud-link tag-link-204 tag-link-position-17" style="font-size: 12.253164556962pt;" aria-label="MongoDB Stitch (17 items)">MongoDB Stitch</a>
<a href="/tag/mysql" class="tag-cloud-link tag-link-147 tag-link-position-18" style="font-size: 22pt;" aria-label="MySQL (229 items)">MySQL</a>
<a href="/tag/mysql-5-6" class="tag-cloud-link tag-link-64 tag-link-position-19" style="font-size: 10.924050632911pt;" aria-label="MySQL 5.6 (12 items)">MySQL 5.6</a>
<a href="/tag/mysql-cluster" class="tag-cloud-link tag-link-148 tag-link-position-20" style="font-size: 21.46835443038pt;" aria-label="MySQL Cluster (198 items)">MySQL Cluster</a>
<a href="/tag/mysql-cluster-70" class="tag-cloud-link tag-link-69 tag-link-position-21" style="font-size: 13.936708860759pt;" aria-label="MySQL Cluster 7.0 (27 items)">MySQL Cluster 7.0</a>
<a href="/tag/mysql-cluster-7-1" class="tag-cloud-link tag-link-70 tag-link-position-22" style="font-size: 15.177215189873pt;" aria-label="MySQL Cluster 7.1 (38 items)">MySQL Cluster 7.1</a>
<a href="/tag/mysql-cluster-7-2" class="tag-cloud-link tag-link-71 tag-link-position-23" style="font-size: 14.556962025316pt;" aria-label="MySQL Cluster 7.2 (32 items)">MySQL Cluster 7.2</a>
<a href="/tag/mysql-cluster-7-3" class="tag-cloud-link tag-link-72 tag-link-position-24" style="font-size: 12.253164556962pt;" aria-label="MySQL Cluster 7.3 (17 items)">MySQL Cluster 7.3</a>
<a href="/tag/mysql-cluster-7-4" class="tag-cloud-link tag-link-134 tag-link-position-25" style="font-size: 11.278481012658pt;" aria-label="MySQL Cluster 7.4 (13 items)">MySQL Cluster 7.4</a>
<a href="/tag/mysql-cluster-cge" class="tag-cloud-link tag-link-73 tag-link-position-26" style="font-size: 17.569620253165pt;" aria-label="MySQL Cluster CGE (72 items)">MySQL Cluster CGE</a>
<a href="/tag/mysql-cluster-manager" class="tag-cloud-link tag-link-74 tag-link-position-27" style="font-size: 12.607594936709pt;" aria-label="MySQL Cluster Manager (19 items)">MySQL Cluster Manager</a>
<a href="/tag/mysql-enterprise-monitor" class="tag-cloud-link tag-link-76 tag-link-position-28" style="font-size: 9.0632911392405pt;" aria-label="MySQL Enterprise Monitor (7 items)">MySQL Enterprise Monitor</a>
<a href="/tag/mysql-fabric-2" class="tag-cloud-link tag-link-132 tag-link-position-29" style="font-size: 9.0632911392405pt;" aria-label="mysql fabric (7 items)">mysql fabric</a>
<a href="/tag/mysql-replication" class="tag-cloud-link tag-link-149 tag-link-position-30" style="font-size: 15.354430379747pt;" aria-label="MySQL Replication (40 items)">MySQL Replication</a>
<a href="/tag/mysql-utilities" class="tag-cloud-link tag-link-78 tag-link-position-31" style="font-size: 8pt;" aria-label="MySQL Utilities (5 items)">MySQL Utilities</a>
<a href="/tag/ndb-api" class="tag-cloud-link tag-link-80 tag-link-position-32" style="font-size: 10.303797468354pt;" aria-label="NDB API (10 items)">NDB API</a>
<a href="/tag/node-js" class="tag-cloud-link tag-link-83 tag-link-position-33" style="font-size: 10.303797468354pt;" aria-label="node.js (10 items)">node.js</a>
<a href="/tag/nosql" class="tag-cloud-link tag-link-84 tag-link-position-34" style="font-size: 12.784810126582pt;" aria-label="NoSQL (20 items)">NoSQL</a>
<a href="/tag/performance" class="tag-cloud-link tag-link-97 tag-link-position-35" style="font-size: 9.9493670886076pt;" aria-label="Performance (9 items)">Performance</a>
<a href="/tag/realm" class="tag-cloud-link tag-link-213 tag-link-position-36" style="font-size: 11.721518987342pt;" aria-label="Realm (15 items)">Realm</a>
<a href="/tag/replication" class="tag-cloud-link tag-link-104 tag-link-position-37" style="font-size: 10.924050632911pt;" aria-label="Replication (12 items)">Replication</a>
<a href="/tag/secondary" class="tag-cloud-link tag-link-138 tag-link-position-38" style="font-size: 11.278481012658pt;" aria-label="secondary (13 items)">secondary</a>
<a href="/tag/serverless" class="tag-cloud-link tag-link-208 tag-link-position-39" style="font-size: 8.620253164557pt;" aria-label="serverless (6 items)">serverless</a>
<a href="/tag/sharding" class="tag-cloud-link tag-link-129 tag-link-position-40" style="font-size: 8pt;" aria-label="sharding (5 items)">sharding</a>
<a href="/tag/swift" class="tag-cloud-link tag-link-216 tag-link-position-41" style="font-size: 10.303797468354pt;" aria-label="Swift (10 items)">Swift</a>
<a href="/tag/swiftui" class="tag-cloud-link tag-link-217 tag-link-position-42" style="font-size: 10.303797468354pt;" aria-label="SwiftUI (10 items)">SwiftUI</a>
<a href="/tag/webcast" class="tag-cloud-link tag-link-124 tag-link-position-43" style="font-size: 8pt;" aria-label="Webcast (5 items)">Webcast</a>
<a href="/tag/webinar" class="tag-cloud-link tag-link-125 tag-link-position-44" style="font-size: 12.430379746835pt;" aria-label="webinar (18 items)">webinar</a>
<a href="/tag/windows" class="tag-cloud-link tag-link-127 tag-link-position-45" style="font-size: 9.0632911392405pt;" aria-label="Windows (7 items)">Windows</a></div>
</li>
<li id="theme_socialmedia-2" class="widget theme_socialmedia">			<div class="widget-social-icons">
				
			<a href="http://twitter.com/andrewmorgan"><img src="/wp-content/themes/zeesynergie/images/icons/twitter.png" alt="twitter"></a><a href="http://www.facebook.com/andrewjamesmorgan"><img src="/wp-content/themes/zeesynergie/images/icons/facebook.png" alt="facebook"></a><a href="https://plus.google.com/u/0/100605473697871424413/posts"><img src="/wp-content/themes/zeesynergie/images/icons/googleplus.png" alt="googleplus"></a><a href="http://www.linkedin.com/profile/view?id=16709956"><img src="/wp-content/themes/zeesynergie/images/icons/linkedin.png" alt="linkedin"></a><a href="http://www.flickr.com/photos/andrewjamesmorgan/"><img src="/wp-content/themes/zeesynergie/images/icons/flickr.png" alt="flickr"></a><a href="http://www.youtube.com/channel/UCodtDakJ4VdeSCzS3P3rIsw"><img src="/wp-content/themes/zeesynergie/images/icons/youtube.png" alt="youtube"></a>			</div>
		</li>
<li id="archives-2" class="widget widget_archive"><h2 class="widgettitle">Archives</h2>

			<ul>
					<li><a href="/2022/03">March 2022</a></li>
	<li><a href="/2022/02">February 2022</a></li>
	<li><a href="/2022/01">January 2022</a></li>
	<li><a href="/2021/12">December 2021</a></li>
	<li><a href="/2021/11">November 2021</a></li>
	<li><a href="/2021/09">September 2021</a></li>
	<li><a href="/2021/08">August 2021</a></li>
	<li><a href="/2021/07">July 2021</a></li>
	<li><a href="/2021/06">June 2021</a></li>
	<li><a href="/2021/05">May 2021</a></li>
	<li><a href="/2021/04">April 2021</a></li>
	<li><a href="/2021/02">February 2021</a></li>
	<li><a href="/2021/01">January 2021</a></li>
	<li><a href="/2020/12">December 2020</a></li>
	<li><a href="/2019/03">March 2019</a></li>
	<li><a href="/2019/01">January 2019</a></li>
	<li><a href="/2018/12">December 2018</a></li>
	<li><a href="/2018/11">November 2018</a></li>
	<li><a href="/2018/10">October 2018</a></li>
	<li><a href="/2018/09">September 2018</a></li>
	<li><a href="/2017/09">September 2017</a></li>
	<li><a href="/2017/03">March 2017</a></li>
	<li><a href="/2017/02">February 2017</a></li>
	<li><a href="/2017/01">January 2017</a></li>
	<li><a href="/2016/12">December 2016</a></li>
	<li><a href="/2016/11">November 2016</a></li>
	<li><a href="/2016/09">September 2016</a></li>
	<li><a href="/2016/01">January 2016</a></li>
	<li><a href="/2015/11">November 2015</a></li>
	<li><a href="/2015/10">October 2015</a></li>
	<li><a href="/2015/09">September 2015</a></li>
	<li><a href="/2015/06">June 2015</a></li>
	<li><a href="/2015/04">April 2015</a></li>
	<li><a href="/2015/03">March 2015</a></li>
	<li><a href="/2015/02">February 2015</a></li>
	<li><a href="/2015/01">January 2015</a></li>
	<li><a href="/2014/12">December 2014</a></li>
	<li><a href="/2014/11">November 2014</a></li>
	<li><a href="/2014/10">October 2014</a></li>
	<li><a href="/2014/09">September 2014</a></li>
	<li><a href="/2014/08">August 2014</a></li>
	<li><a href="/2014/07">July 2014</a></li>
	<li><a href="/2014/06">June 2014</a></li>
	<li><a href="/2014/05">May 2014</a></li>
	<li><a href="/2014/04">April 2014</a></li>
	<li><a href="/2014/03">March 2014</a></li>
	<li><a href="/2014/02">February 2014</a></li>
	<li><a href="/2014/01">January 2014</a></li>
	<li><a href="/2013/12">December 2013</a></li>
	<li><a href="/2013/11">November 2013</a></li>
	<li><a href="/2013/09">September 2013</a></li>
	<li><a href="/2013/08">August 2013</a></li>
	<li><a href="/2013/07">July 2013</a></li>
	<li><a href="/2013/06">June 2013</a></li>
	<li><a href="/2013/05">May 2013</a></li>
	<li><a href="/2013/03">March 2013</a></li>
	<li><a href="/2013/02">February 2013</a></li>
	<li><a href="/2013/01">January 2013</a></li>
	<li><a href="/2012/12">December 2012</a></li>
	<li><a href="/2012/11">November 2012</a></li>
	<li><a href="/2012/09">September 2012</a></li>
	<li><a href="/2012/07">July 2012</a></li>
	<li><a href="/2012/06">June 2012</a></li>
	<li><a href="/2012/05">May 2012</a></li>
	<li><a href="/2012/04">April 2012</a></li>
	<li><a href="/2012/03">March 2012</a></li>
	<li><a href="/2012/02">February 2012</a></li>
	<li><a href="/2012/01">January 2012</a></li>
	<li><a href="/2011/12">December 2011</a></li>
	<li><a href="/2011/11">November 2011</a></li>
	<li><a href="/2011/10">October 2011</a></li>
	<li><a href="/2011/09">September 2011</a></li>
	<li><a href="/2011/07">July 2011</a></li>
	<li><a href="/2011/06">June 2011</a></li>
	<li><a href="/2011/05">May 2011</a></li>
	<li><a href="/2011/04">April 2011</a></li>
	<li><a href="/2011/03">March 2011</a></li>
	<li><a href="/2011/02">February 2011</a></li>
	<li><a href="/2011/01">January 2011</a></li>
	<li><a href="/2010/12">December 2010</a></li>
	<li><a href="/2010/11">November 2010</a></li>
	<li><a href="/2010/10">October 2010</a></li>
	<li><a href="/2010/09">September 2010</a></li>
	<li><a href="/2010/08">August 2010</a></li>
	<li><a href="/2010/07">July 2010</a></li>
	<li><a href="/2010/06">June 2010</a></li>
	<li><a href="/2010/05">May 2010</a></li>
	<li><a href="/2010/04">April 2010</a></li>
	<li><a href="/2010/03">March 2010</a></li>
	<li><a href="/2010/02">February 2010</a></li>
	<li><a href="/2010/01">January 2010</a></li>
	<li><a href="/2009/12">December 2009</a></li>
	<li><a href="/2009/11">November 2009</a></li>
	<li><a href="/2009/10">October 2009</a></li>
	<li><a href="/2009/09">September 2009</a></li>
	<li><a href="/2009/08">August 2009</a></li>
	<li><a href="/2009/07">July 2009</a></li>
	<li><a href="/2009/06">June 2009</a></li>
	<li><a href="/2009/05">May 2009</a></li>
	<li><a href="/2009/04">April 2009</a></li>
			</ul>

			</li>
	
	</ul>
</div>	</div>
	
	</div>
	<div id="footer">
		<div id="foot">
			Supported by <a href="http://www.thievesgarden.co.uk/" title="Maidenhead Accommodation - self catering apartment to rent" target="Thieves Garden">Thieves Garden - Maidenhead self catering apartment</a> and <a href="http://www.oleronvilla.com/" title="Ile d'Oleron Holiday Home to rent" target="Oleron Villa">Oleron Villa holiday home on Ile d'Oleron</a>.			<div class="credit_link">	<a href="http://themezee.com/">Theme by ThemeZee</a>
</div>
			<div class="clear"></div>
		</div>
	</div>
</div>
	<!-- Powered by WPtouch: 4.3.39 --></body>
</html>